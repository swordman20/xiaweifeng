<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.49">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <meta property="og:url" content="https://tommyi.netlify.app/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html"><meta property="og:site_name" content="Hades"><meta property="og:title" content="ç¬¬ 7 ç« ã€€å†…å®¹å…±äº«"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-08-23T15:30:31.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-08-23T15:30:31.000Z"><script>
      (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?c6cfefc03bedbb2803a5cad020e7faaa";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);})();
     </script><link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png"><link rel="manifest" href="/manifest.webmanifest"><meta name="application-name" content="VuePress"><meta name="referrer" content="no-referrer"><meta name="apple-mobile-web-app-title" content="VuePress"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="https://www.vuepress.cn/icons/apple-touch-icon-152x152.png"><link rel="mask-icon" href="/images/icons/safari-pinned-tab.svg" color="#3eaf7c"><meta name="msapplication-TileColor" content="#3eaf7c"><meta name="theme-color" content="#3eaf7c"><title>ç¬¬ 7 ç« ã€€å†…å®¹å…±äº« | Hades</title><meta name="description" content="è¿™æ˜¯ä¸€æœ¬ç¬”è®°ï¼Œç”¨äºè®°å½•ç¼–ç¨‹è¿‡ç¨‹ä¸­çš„çŸ¥è¯†ç‚¹">
    <link rel="modulepreload" href="/assets/app.3222cd28.js"><link rel="modulepreload" href="/assets/ç¬¬07ç« å†…å®¹å…±äº«.html.3a0fcce0.js"><link rel="modulepreload" href="/assets/ç¬¬07ç« å†…å®¹å…±äº«.html.ef3fb778.js"><link rel="prefetch" href="/assets/index.html.3fba8fa2.js"><link rel="prefetch" href="/assets/index.html.4d596f1b.js"><link rel="prefetch" href="/assets/index.html.ac0d3ff8.js"><link rel="prefetch" href="/assets/Macä¸‹mongodbå®‰è£…å’Œé…ç½®.html.19173e70.js"><link rel="prefetch" href="/assets/Macä¸‹å‘½ä»¤è¡Œé…ç½®ç¯å¢ƒå˜é‡.html.c2873a5f.js"><link rel="prefetch" href="/assets/Macå…¨è‡ªåŠ¨å®‰è£…brewä¸€é”®é…ç½®å›½å†…é•œåƒæº.html.8866f2df.js"><link rel="prefetch" href="/assets/Macç»ˆç«¯å‘½ä»¤è®°å½•.html.75e46e91.js"><link rel="prefetch" href="/assets/Nginxæ­å»ºHTTPSï¼Œå¹¶åå‘ä»£ç†åˆ°webé¡µé¢_mkcertç”Ÿæˆæœ¬åœ°SSLè¯ä¹¦.html.f67c5203.js"><link rel="prefetch" href="/assets/PDFè½¬Markdownæ–‡ä»¶.html.dc7ca7bb.js"><link rel="prefetch" href="/assets/index.html.f2e8c2ba.js"><link rel="prefetch" href="/assets/VSCodeä½¿ç”¨è®°å½•.html.3b0db4ce.js"><link rel="prefetch" href="/assets/docsearchå…¨ç«™æœç´¢.html.105a6071.js"><link rel="prefetch" href="/assets/ideaæ’ä»¶åˆ†äº«.html.841f8833.js"><link rel="prefetch" href="/assets/jetbrainså…¨å®¶æ¡¶æ¿€æ´»ç­–ç•¥.html.daa401c8.js"><link rel="prefetch" href="/assets/ä¸­åäººæ°‘å…±å’Œå›½åŠ³åŠ¨åˆåŒæ³•.html.6b4a5117.js"><link rel="prefetch" href="/assets/æµ…è°ˆæ–‡è¨€æ–‡ä¸è‹±è¯­è¯­æ³•çš„ç›¸ä¼¼ç‚¹.html.96535ae8.js"><link rel="prefetch" href="/assets/é¢å‘AIå¼€å‘.html.06a44d4c.js"><link rel="prefetch" href="/assets/é¸¿è’™3å®‰è£…apkæ— é¡»ç™»å½•.html.7ceb3fbf.js"><link rel="prefetch" href="/assets/index.html.f4857994.js"><link rel="prefetch" href="/assets/aboutme.html.03b08c9b.js"><link rel="prefetch" href="/assets/index.html.7d5c183e.js"><link rel="prefetch" href="/assets/index.html.62929ac9.js"><link rel="prefetch" href="/assets/FRPå†…ç½‘ç©¿é€æ­å»º(æ— åŸŸåç‰ˆ).html.6029f667.js"><link rel="prefetch" href="/assets/index.html.5fd246dd.js"><link rel="prefetch" href="/assets/linuxå‰ç«¯é¡¹ç›®éƒ¨ç½².html.0029fa36.js"><link rel="prefetch" href="/assets/linuxç¯å¢ƒå˜é‡é…ç½®é”™è¯¯åå‘½ä»¤æ— æ³•ä½¿ç”¨è§£å†³æ–¹æ¡ˆ.html.e194e944.js"><link rel="prefetch" href="/assets/å†…ç½‘ç©¿é€å·¥å…·æ¯”è¾ƒ.html.a6564717.js"><link rel="prefetch" href="/assets/åœ¨CentOSä¸Šæ­å»ºSambaæœåŠ¡å™¨.html.5dc34a00.js"><link rel="prefetch" href="/assets/ç¬¬01ç« Androidå¼€å‘ç¯å¢ƒæ­å»º.html.4ea72447.js"><link rel="prefetch" href="/assets/ç¬¬02ç« AndroidAppå¼€å‘åŸºç¡€.html.24ac8732.js"><link rel="prefetch" href="/assets/ç¬¬03ç« ç®€å•æ§ä»¶.html.3128fa37.js"><link rel="prefetch" href="/assets/ç¬¬04ç« æ´»åŠ¨Activity.html.9169add5.js"><link rel="prefetch" href="/assets/ç¬¬05ç« ä¸­çº§æ§ä»¶.html.75bd951e.js"><link rel="prefetch" href="/assets/ç¬¬06ç« æ•°æ®å­˜å‚¨.html.c29220e0.js"><link rel="prefetch" href="/assets/ç¬¬08ç« é«˜çº§æ§ä»¶.html.a4ef2f0d.js"><link rel="prefetch" href="/assets/ç¬¬09ç« å¹¿æ’­ç»„ä»¶Broadcast.html.7130bec3.js"><link rel="prefetch" href="/assets/ç¬¬10ç« è‡ªå®šä¹‰æ§ä»¶.html.1c777745.js"><link rel="prefetch" href="/assets/AndroidStudioä»£ç†é—®é¢˜Connect.html.357fa090.js"><link rel="prefetch" href="/assets/AndroidStudioæ‰“åŒ…aarä¸¢å¤±è¿œç¨‹ä¾èµ–é—®é¢˜è§£å†³.html.26db85ab.js"><link rel="prefetch" href="/assets/AndroidStudioç™»å½•googleè´¦å·å¤±è´¥é—®é¢˜.html.60601dbe.js"><link rel="prefetch" href="/assets/Apkåº”ç”¨é‡ç­¾åâ€”ä½¿ç”¨AndroidStudioè‡ªå¸¦å·¥å…·apksigner.html.be412465.js"><link rel="prefetch" href="/assets/ä¸å¸¸ç”¨çš„ADBå‘½ä»¤.html.162faa7e.js"><link rel="prefetch" href="/assets/01MySQLç²¾ç®€ç¬”è®°.html.b6c76536.js"><link rel="prefetch" href="/assets/02JDBC.html.cd83be25.js"><link rel="prefetch" href="/assets/03Maven.html.2826552b.js"><link rel="prefetch" href="/assets/04Mybatis.html.e3b26918.js"><link rel="prefetch" href="/assets/05ç½‘é¡µä¸‰å‰‘å®¢.html.7eb4fd73.js"><link rel="prefetch" href="/assets/06HTTP_Tomcat_Servlet.html.e72ce829.js"><link rel="prefetch" href="/assets/07Request_Response.html.dbb06678.js"><link rel="prefetch" href="/assets/08JSP.html.9fe6edfb.js"><link rel="prefetch" href="/assets/09Cookie_Session.html.a6775789.js"><link rel="prefetch" href="/assets/10Filter_Listener_Ajax.html.ca49deec.js"><link rel="prefetch" href="/assets/11Vue_Element.html.13f1ff54.js"><link rel="prefetch" href="/assets/12ç»¼åˆæ¡ˆä¾‹.html.0e382c65.js"><link rel="prefetch" href="/assets/index.html.145fbfc9.js"><link rel="prefetch" href="/assets/POMæ–‡ä»¶å¸®åŠ©æ–‡æ¡£.html.71fe5a3a.js"><link rel="prefetch" href="/assets/index.html.4c10d115.js"><link rel="prefetch" href="/assets/index.html.8002c9df.js"><link rel="prefetch" href="/assets/index.html.456530ad.js"><link rel="prefetch" href="/assets/index.html.a6dacb19.js"><link rel="prefetch" href="/assets/index.html.155f6415.js"><link rel="prefetch" href="/assets/index.html.ddabe501.js"><link rel="prefetch" href="/assets/index.html.85baad59.js"><link rel="prefetch" href="/assets/index.html.b4cc03cf.js"><link rel="prefetch" href="/assets/index.html.781336e1.js"><link rel="prefetch" href="/assets/index.html.61a0c47f.js"><link rel="prefetch" href="/assets/request.getInputStreamåªèƒ½è¯»å–ä¸€æ¬¡é—®é¢˜.html.b885ecdb.js"><link rel="prefetch" href="/assets/ç¨‹åºåŒ…com.alibaba.fastjsonä¸å­˜åœ¨.html.271dbf39.js"><link rel="prefetch" href="/assets/é”™è¯¯é›†åˆ.html.7aaff025.js"><link rel="prefetch" href="/assets/index.html.bbbe52d8.js"><link rel="prefetch" href="/assets/index.html.a8875e4a.js"><link rel="prefetch" href="/assets/index.html.500a4c6c.js"><link rel="prefetch" href="/assets/index.html.e490b0a7.js"><link rel="prefetch" href="/assets/index.html.7c8a7fda.js"><link rel="prefetch" href="/assets/MySQL-åŸºç¡€ç¯‡.html.72f3c6e1.js"><link rel="prefetch" href="/assets/Nodeå¤šç‰ˆæœ¬ç®¡ç†.html.323287ed.js"><link rel="prefetch" href="/assets/index.html.0e0c40e6.js"><link rel="prefetch" href="/assets/Webè°ƒè¯•å…¥é—¨.html.779c051c.js"><link rel="prefetch" href="/assets/å…³äºESLInké…ç½®é—®é¢˜.html.813173ed.js"><link rel="prefetch" href="/assets/Mavené«˜çº§.html.88e987e2.js"><link rel="prefetch" href="/assets/SpringBoot.html.900a4e3a.js"><link rel="prefetch" href="/assets/RestTemplate.html.e8ab904e.js"><link rel="prefetch" href="/assets/MyBatisPlus.html.f232bc92.js"><link rel="prefetch" href="/assets/Dubboè¯¦è§£.html.99b80cf1.js"><link rel="prefetch" href="/assets/Macä¸‹ZooKeeperå®‰è£…å’Œä½¿ç”¨.html.6c1f13af.js"><link rel="prefetch" href="/assets/Zookeeperé›†ç¾¤æ­å»º.html.52dab835.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬10ç« ï¼‰.html.e13e9f83.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬11ç« ï¼‰.html.f5126906.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬12ç« ï¼‰.html.44d84044.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬13ç« ï¼‰.html.a07d7436.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬1ç« ï¼‰.html.a4da5427.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬2ç« ï¼‰.html.2fefeebf.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬3ç« ï¼‰.html.027ab944.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬4ç« ï¼‰.html.0dbf7d93.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬5ç« ï¼‰.html.fdc355fa.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬6ç« ï¼‰.html.cfd20322.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬7ç« ï¼‰.html.b3623f0b.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬8ç« ï¼‰.html.9d9da6cc.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬9ç« ï¼‰.html.90642054.js"><link rel="prefetch" href="/assets/SpringBootè®²ä¹‰.html.7a7d55bb.js"><link rel="prefetch" href="/assets/Linux-Day01.html.fdebd37c.js"><link rel="prefetch" href="/assets/Linux-Day02.html.7812a3ac.js"><link rel="prefetch" href="/assets/RedisåŸºç¡€.html.601c5b80.js"><link rel="prefetch" href="/assets/Gitè¯¾ç¨‹è®²ä¹‰.html.ebe75592.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–-Day01.html.f58e19c2.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–-Day02.html.4ded6959.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–-Day03.html.c35f1242.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–-Day04.html.3d44fe14.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–-Day05.html.3f4ef4e7.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–-Day06.html.9cd411dc.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–ä¼˜åŒ–-Day01.html.78783912.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–ä¼˜åŒ–-Day02.html.cb2d7616.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–ä¼˜åŒ–-Day03.html.6076c5a3.js"><link rel="prefetch" href="/assets/å¾®æœåŠ¡å¸¸è§é¢è¯•é¢˜.html.a5dcd6ba.js"><link rel="prefetch" href="/assets/é”™è¯¯ç¬”è®°.html.ed3ccb3a.js"><link rel="prefetch" href="/assets/day01-HTMLåŸºç¡€.html.a6ab2338.js"><link rel="prefetch" href="/assets/day02-HTMLè¿›é˜¶.html.6a75b495.js"><link rel="prefetch" href="/assets/day04-CSSè¿›é˜¶.html.691a9b64.js"><link rel="prefetch" href="/assets/day03-CSSåŸºç¡€.html.42169736.js"><link rel="prefetch" href="/assets/day05-ç›’å­æ¨¡å‹.html.4992e05c.js"><link rel="prefetch" href="/assets/day06-Flexå¸ƒå±€.html.c0632a9a.js"><link rel="prefetch" href="/assets/day07-å­¦æˆåœ¨çº¿.html.31966167.js"><link rel="prefetch" href="/assets/day08-CSSé«˜çº§.html.7139befe.js"><link rel="prefetch" href="/assets/day09-å°å…”é²œå„¿.html.a4f48ad2.js"><link rel="prefetch" href="/assets/day10-å°å…”é²œå„¿.html.58643326.js"><link rel="prefetch" href="/assets/Day01-é¡¹ç›®ä»‹ç»åŠåˆå§‹åŒ–-ç™»å½•é¡µé¢.html.1162a8bc.js"><link rel="prefetch" href="/assets/Day02-ç™»å½•æ¨¡å—-ä¸»é¡µé‰´æƒ.html.8dfc8019.js"><link rel="prefetch" href="/assets/Day03-ä¸»é¡µæ¨¡å—-ä¿®æ”¹å¯†ç .html.011cdd7f.js"><link rel="prefetch" href="/assets/Day04-ç»„ç»‡æ¶æ„.html.5275e26a.js"><link rel="prefetch" href="/assets/Day05-ç»„ç»‡æ¶æ„-è§’è‰²ç®¡ç†.html.ced63442.js"><link rel="prefetch" href="/assets/Day06-è§’è‰²ç®¡ç†-å‘˜å·¥ç®¡ç†.html.6caefea8.js"><link rel="prefetch" href="/assets/Day07-å‘˜å·¥ç®¡ç†-ä¸Šä¼ ä¸‹è½½.html.e3f31d8e.js"><link rel="prefetch" href="/assets/Day08-Cosä¸Šä¼ å’Œæƒé™æ•°æ®.html.20830962.js"><link rel="prefetch" href="/assets/Day09-æƒé™åº”ç”¨-é¦–é¡µ.html.da56bbaa.js"><link rel="prefetch" href="/assets/Day10-é¦–é¡µå›¾è¡¨-Nginxä¸Šçº¿.html.d3348164.js"><link rel="prefetch" href="/assets/1.Vue3å…¥é—¨.html.03fe22ad.js"><link rel="prefetch" href="/assets/10.è´­ç‰©è½¦.html.471b3316.js"><link rel="prefetch" href="/assets/11.è®¢å•é¡µ.html.f7fcb785.js"><link rel="prefetch" href="/assets/12.æ”¯ä»˜é¡µ.html.7e26fb78.js"><link rel="prefetch" href="/assets/13.ä¼šå‘˜ä¸­å¿ƒ.html.b90bf2e3.js"><link rel="prefetch" href="/assets/14.æ‹“å±•éƒ¨åˆ†.html.0d32fa78.js"><link rel="prefetch" href="/assets/2.Piniaå…¥é—¨.html.e8abdd29.js"><link rel="prefetch" href="/assets/3.é¡¹ç›®èµ·æ­¥.html.498101f0.js"><link rel="prefetch" href="/assets/4.Layouté¡µ.html.0c374127.js"><link rel="prefetch" href="/assets/5.Homeé¡µ.html.a6e30fe0.js"><link rel="prefetch" href="/assets/6.ä¸€çº§åˆ†ç±»é¡µ.html.f6efdd5c.js"><link rel="prefetch" href="/assets/7.äºŒçº§åˆ†ç±»é¡µ.html.01823995.js"><link rel="prefetch" href="/assets/8.å•†å“è¯¦æƒ….html.5c665585.js"><link rel="prefetch" href="/assets/9.ç™»å½•é¡µ.html.35d98706.js"><link rel="prefetch" href="/assets/day01.html.8ffdb6de.js"><link rel="prefetch" href="/assets/day02.html.43bccf1f.js"><link rel="prefetch" href="/assets/day03.html.191e82ec.js"><link rel="prefetch" href="/assets/index.html.f947a12b.js"><link rel="prefetch" href="/assets/day01.html.de22280d.js"><link rel="prefetch" href="/assets/day02.html.37fef858.js"><link rel="prefetch" href="/assets/day03.html.b3311c03.js"><link rel="prefetch" href="/assets/day04.html.14ed5a97.js"><link rel="prefetch" href="/assets/index.html.ea0c61d2.js"><link rel="prefetch" href="/assets/interview-base.html.b48b64bf.js"><link rel="prefetch" href="/assets/interview-enjoy-plus.html.8071948e.js"><link rel="prefetch" href="/assets/RedisåŸºç¡€ç¯‡.html.a0667b10.js"><link rel="prefetch" href="/assets/Rediså¿«é€Ÿå…¥é—¨.html.d25877b5.js"><link rel="prefetch" href="/assets/Rediså®æˆ˜ç¯‡.html.9a5d06d2.js"><link rel="prefetch" href="/assets/è¯¾å ‚ç¬”è®°.html.6422e94e.js"><link rel="prefetch" href="/assets/RedisåŸç†ç¯‡.html.4f69d42d.js"><link rel="prefetch" href="/assets/è¯¾å ‚ç¬”è®°.html.3b96b75e.js"><link rel="prefetch" href="/assets/Spring-day01.html.e68ec110.js"><link rel="prefetch" href="/assets/Spring-day02.html.59a1d60e.js"><link rel="prefetch" href="/assets/Spring-day03.html.7c161a28.js"><link rel="prefetch" href="/assets/SpringMVC-day01.html.457335ff.js"><link rel="prefetch" href="/assets/SpringMVC-day02.html.031f2edf.js"><link rel="prefetch" href="/assets/SpringBootStart.html.105a81fc.js"><link rel="prefetch" href="/assets/SpringBootæ•´åˆSSMP.html.e9ae476c.js"><link rel="prefetch" href="/assets/SpringBootç»¼åˆæ¡ˆä¾‹.html.0b423631.js"><link rel="prefetch" href="/assets/é”™è¯¯ç¬”è®°.html.62610a4e.js"><link rel="prefetch" href="/assets/SpringBootè®²ä¹‰.html.ab71429a.js"><link rel="prefetch" href="/assets/SpringBootè®²ä¹‰.html.985d261c.js"><link rel="prefetch" href="/assets/Centos8-streamåœ¨çœŸæœºä¸Šå®‰è£…æ’å‘.html.6126641d.js"><link rel="prefetch" href="/assets/Centos9å®‰è£…mysql.html.2e8a0e74.js"><link rel="prefetch" href="/assets/SpringCloud01.html.7e4ce9d2.js"><link rel="prefetch" href="/assets/SpringCloudå®ç”¨ç¯‡02.html.96a09c5c.js"><link rel="prefetch" href="/assets/Dockerå®ç”¨ç¯‡.html.a17cc52f.js"><link rel="prefetch" href="/assets/RabbitMQ.html.bd4e2cf4.js"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼æœç´¢å¼•æ“01.html.4e38b9ff.js"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼æœç´¢å¼•æ“02.html.57698f1d.js"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼æœç´¢å¼•æ“03.html.28ba2809.js"><link rel="prefetch" href="/assets/å¾®æœåŠ¡ä¿æŠ¤.html.62adb493.js"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼äº‹åŠ¡.html.e90c30b9.js"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼ç¼“å­˜.html.01435b66.js"><link rel="prefetch" href="/assets/å¤šçº§ç¼“å­˜.html.4a5cc484.js"><link rel="prefetch" href="/assets/RabbitMQ-é«˜çº§ç¯‡.html.0c480ed8.js"><link rel="prefetch" href="/assets/Mybatisç¬¬ä¸€å¤©.html.a3edd17b.js"><link rel="prefetch" href="/assets/Mybatisç¬¬äºŒå¤©.html.802a2571.js"><link rel="prefetch" href="/assets/ç§»åŠ¨webç¬¬ä¸€å¤©.html.2e8f46f4.js"><link rel="prefetch" href="/assets/ç§»åŠ¨Webç¬¬äºŒå¤©.html.8226f808.js"><link rel="prefetch" href="/assets/ç§»åŠ¨Webç¬¬ä¸‰å¤©.html.11831bcd.js"><link rel="prefetch" href="/assets/ç§»åŠ¨Webç¬¬å››å¤©.html.6547a63e.js"><link rel="prefetch" href="/assets/ç§»åŠ¨Webç¬¬äº”å¤©.html.d74bd617.js"><link rel="prefetch" href="/assets/JavaScriptåŸºç¡€ç¬¬ä¸€å¤©.html.cff4e109.js"><link rel="prefetch" href="/assets/JavaScriptåŸºç¡€ç¬¬ä¸‰å¤©.html.f99eff7e.js"><link rel="prefetch" href="/assets/javascriptåŸºç¡€ç¬¬äºŒå¤©ç¬”è®°.html.aebc5333.js"><link rel="prefetch" href="/assets/JavaScriptåŸºç¡€ç¬¬äº”å¤©.html.e35620d6.js"><link rel="prefetch" href="/assets/JavaScriptåŸºç¡€ç¬¬å››å¤©.html.958a84e6.js"><link rel="prefetch" href="/assets/index.html.ef8647c7.js"><link rel="prefetch" href="/assets/ä¸ªäººå®æˆ˜æ–‡æ¡£.html.1743365c.js"><link rel="prefetch" href="/assets/index.html.c647080e.js"><link rel="prefetch" href="/assets/index.html.04decc95.js"><link rel="prefetch" href="/assets/index.html.dbce89c2.js"><link rel="prefetch" href="/assets/index.html.850a5fdc.js"><link rel="prefetch" href="/assets/index.html.c1ac903f.js"><link rel="prefetch" href="/assets/JavaScriptè¿›é˜¶ç¬¬ä¸€å¤©.html.1df28442.js"><link rel="prefetch" href="/assets/day03.html.c7bd1e6a.js"><link rel="prefetch" href="/assets/day02.html.d4b18232.js"><link rel="prefetch" href="/assets/day04.html.c85f4095.js"><link rel="prefetch" href="/assets/ç¬”è®°.html.f18bcd72.js"><link rel="prefetch" href="/assets/ç¬”è®°.html.cc5e606b.js"><link rel="prefetch" href="/assets/ç¬”è®°.html.9b36d8a2.js"><link rel="prefetch" href="/assets/day01.html.afa0570c.js"><link rel="prefetch" href="/assets/day02.html.cc0ddb05.js"><link rel="prefetch" href="/assets/day03.html.66b1101e.js"><link rel="prefetch" href="/assets/day04.html.d57e8ef7.js"><link rel="prefetch" href="/assets/day05.html.be548191.js"><link rel="prefetch" href="/assets/day06.html.9d2732e7.js"><link rel="prefetch" href="/assets/day07.html.e2014f42.js"><link rel="prefetch" href="/assets/æ™ºæ…§å•†åŸé¡¹ç›®.html.b037ba30.js"><link rel="prefetch" href="/assets/Vue3å…¥é—¨.html.1dddd2c1.js"><link rel="prefetch" href="/assets/Pinia.html.d1f7ef83.js"><link rel="prefetch" href="/assets/å¤§äº‹ä»¶ç®¡ç†ç³»ç»Ÿ.html.a9636e94.js"><link rel="prefetch" href="/assets/01-é¡¹ç›®èµ·æ­¥.html.82651da2.js"><link rel="prefetch" href="/assets/02-é¦–é¡µæ¨¡å—.html.6f46afbf.js"><link rel="prefetch" href="/assets/03-æ¨èæ¨¡å—.html.b6efbf66.js"><link rel="prefetch" href="/assets/04-åˆ†ç±»æ¨¡å—.html.89b1138d.js"><link rel="prefetch" href="/assets/05-è¯¦æƒ…æ¨¡å—.html.e88ab276.js"><link rel="prefetch" href="/assets/06-ç™»å½•æ¨¡å—.html.277d50c6.js"><link rel="prefetch" href="/assets/07-ç”¨æˆ·æ¨¡å—.html.925b2d13.js"><link rel="prefetch" href="/assets/08-åœ°å€æ¨¡å—.html.f75d39b9.js"><link rel="prefetch" href="/assets/09-SKUæ¨¡å—.html.397ec6ac.js"><link rel="prefetch" href="/assets/10-è´­ç‰©è½¦æ¨¡å—.html.813ab58c.js"><link rel="prefetch" href="/assets/11-è®¢å•æ¨¡å—.html.26617e36.js"><link rel="prefetch" href="/assets/12-é¡¹ç›®æ‰“åŒ….html.bcb19f5b.js"><link rel="prefetch" href="/assets/index.html.0ad324c8.js"><link rel="prefetch" href="/assets/å¤šçº§ç¼“å­˜.html.bffd36ce.js"><link rel="prefetch" href="/assets/Redisé«˜çº§-åˆ†å¸ƒå¼ç¼“å­˜.html.3b0165ff.js"><link rel="prefetch" href="/assets/Redisé«˜çº§ç¯‡ä¹‹æœ€ä½³å®è·µ.html.7874bd22.js"><link rel="prefetch" href="/assets/ç¬¬1å¤©.html.2a9a1263.js"><link rel="prefetch" href="/assets/ç¬¬2å¤©.html.f92837a4.js"><link rel="prefetch" href="/assets/ç¬¬3å¤©.html.8346e116.js"><link rel="prefetch" href="/assets/ç¬¬4å¤©.html.64ba4427.js"><link rel="prefetch" href="/assets/ç¬¬5å¤©.html.aa93a841.js"><link rel="prefetch" href="/assets/å°ç¨‹åºè‡ªå®šä¹‰tabBar.html.efad290d.js"><link rel="prefetch" href="/assets/ç¬¬6å¤©.html.44cac1f7.js"><link rel="prefetch" href="/assets/Nacoså®‰è£…æŒ‡å—.html.39daa776.js"><link rel="prefetch" href="/assets/Nacosé›†ç¾¤æ­å»º.html.568d560d.js"><link rel="prefetch" href="/assets/Centos7å®‰è£…Docker.html.b0ad27b4.js"><link rel="prefetch" href="/assets/RabbitMQéƒ¨ç½²æŒ‡å—.html.1ab7fab6.js"><link rel="prefetch" href="/assets/å®‰è£…elasticsearch.html.81544b59.js"><link rel="prefetch" href="/assets/Day01_AJAXå…¥é—¨.html.2b734238.js"><link rel="prefetch" href="/assets/Day02_AJAXç»¼åˆæ¡ˆä¾‹.html.afc30063.js"><link rel="prefetch" href="/assets/Day03_AJAXåŸç†.html.099c6350.js"><link rel="prefetch" href="/assets/Day04_AJAXè¿›é˜¶.html.54ac1199.js"><link rel="prefetch" href="/assets/404.html.65323de0.js"><link rel="prefetch" href="/assets/index.html.d35904fe.js"><link rel="prefetch" href="/assets/index.html.fd023679.js"><link rel="prefetch" href="/assets/index.html.df12bfb4.js"><link rel="prefetch" href="/assets/Macä¸‹mongodbå®‰è£…å’Œé…ç½®.html.301a2aea.js"><link rel="prefetch" href="/assets/Macä¸‹å‘½ä»¤è¡Œé…ç½®ç¯å¢ƒå˜é‡.html.1d4d6e41.js"><link rel="prefetch" href="/assets/Macå…¨è‡ªåŠ¨å®‰è£…brewä¸€é”®é…ç½®å›½å†…é•œåƒæº.html.a1acc4ea.js"><link rel="prefetch" href="/assets/Macç»ˆç«¯å‘½ä»¤è®°å½•.html.48c62f0e.js"><link rel="prefetch" href="/assets/Nginxæ­å»ºHTTPSï¼Œå¹¶åå‘ä»£ç†åˆ°webé¡µé¢_mkcertç”Ÿæˆæœ¬åœ°SSLè¯ä¹¦.html.fe7d31c9.js"><link rel="prefetch" href="/assets/PDFè½¬Markdownæ–‡ä»¶.html.cb87284b.js"><link rel="prefetch" href="/assets/index.html.2514289c.js"><link rel="prefetch" href="/assets/VSCodeä½¿ç”¨è®°å½•.html.5fff25d5.js"><link rel="prefetch" href="/assets/docsearchå…¨ç«™æœç´¢.html.0b5e6df6.js"><link rel="prefetch" href="/assets/ideaæ’ä»¶åˆ†äº«.html.4589edb2.js"><link rel="prefetch" href="/assets/jetbrainså…¨å®¶æ¡¶æ¿€æ´»ç­–ç•¥.html.b628297e.js"><link rel="prefetch" href="/assets/ä¸­åäººæ°‘å…±å’Œå›½åŠ³åŠ¨åˆåŒæ³•.html.0f5bee03.js"><link rel="prefetch" href="/assets/æµ…è°ˆæ–‡è¨€æ–‡ä¸è‹±è¯­è¯­æ³•çš„ç›¸ä¼¼ç‚¹.html.63856966.js"><link rel="prefetch" href="/assets/é¢å‘AIå¼€å‘.html.a61b1470.js"><link rel="prefetch" href="/assets/é¸¿è’™3å®‰è£…apkæ— é¡»ç™»å½•.html.505d6071.js"><link rel="prefetch" href="/assets/index.html.a10f47f9.js"><link rel="prefetch" href="/assets/aboutme.html.262718de.js"><link rel="prefetch" href="/assets/index.html.ae7dbfa2.js"><link rel="prefetch" href="/assets/index.html.852eb6a4.js"><link rel="prefetch" href="/assets/FRPå†…ç½‘ç©¿é€æ­å»º(æ— åŸŸåç‰ˆ).html.4d0cea9f.js"><link rel="prefetch" href="/assets/index.html.7560b640.js"><link rel="prefetch" href="/assets/linuxå‰ç«¯é¡¹ç›®éƒ¨ç½².html.7b00f51c.js"><link rel="prefetch" href="/assets/linuxç¯å¢ƒå˜é‡é…ç½®é”™è¯¯åå‘½ä»¤æ— æ³•ä½¿ç”¨è§£å†³æ–¹æ¡ˆ.html.50e9cdb4.js"><link rel="prefetch" href="/assets/å†…ç½‘ç©¿é€å·¥å…·æ¯”è¾ƒ.html.70accdbf.js"><link rel="prefetch" href="/assets/åœ¨CentOSä¸Šæ­å»ºSambaæœåŠ¡å™¨.html.44d49a23.js"><link rel="prefetch" href="/assets/ç¬¬01ç« Androidå¼€å‘ç¯å¢ƒæ­å»º.html.5ef4b16c.js"><link rel="prefetch" href="/assets/ç¬¬02ç« AndroidAppå¼€å‘åŸºç¡€.html.cb7a53b0.js"><link rel="prefetch" href="/assets/ç¬¬03ç« ç®€å•æ§ä»¶.html.fa6260dc.js"><link rel="prefetch" href="/assets/ç¬¬04ç« æ´»åŠ¨Activity.html.2c162812.js"><link rel="prefetch" href="/assets/ç¬¬05ç« ä¸­çº§æ§ä»¶.html.cc08f24d.js"><link rel="prefetch" href="/assets/ç¬¬06ç« æ•°æ®å­˜å‚¨.html.fc4b6bd1.js"><link rel="prefetch" href="/assets/ç¬¬08ç« é«˜çº§æ§ä»¶.html.b38fd3b5.js"><link rel="prefetch" href="/assets/ç¬¬09ç« å¹¿æ’­ç»„ä»¶Broadcast.html.bfd475b5.js"><link rel="prefetch" href="/assets/ç¬¬10ç« è‡ªå®šä¹‰æ§ä»¶.html.7b8cb776.js"><link rel="prefetch" href="/assets/AndroidStudioä»£ç†é—®é¢˜Connect.html.2e9e37ad.js"><link rel="prefetch" href="/assets/AndroidStudioæ‰“åŒ…aarä¸¢å¤±è¿œç¨‹ä¾èµ–é—®é¢˜è§£å†³.html.f62ce461.js"><link rel="prefetch" href="/assets/AndroidStudioç™»å½•googleè´¦å·å¤±è´¥é—®é¢˜.html.5e5e82c9.js"><link rel="prefetch" href="/assets/Apkåº”ç”¨é‡ç­¾åâ€”ä½¿ç”¨AndroidStudioè‡ªå¸¦å·¥å…·apksigner.html.e3098467.js"><link rel="prefetch" href="/assets/ä¸å¸¸ç”¨çš„ADBå‘½ä»¤.html.f7e286b9.js"><link rel="prefetch" href="/assets/01MySQLç²¾ç®€ç¬”è®°.html.51e97c50.js"><link rel="prefetch" href="/assets/02JDBC.html.143f8699.js"><link rel="prefetch" href="/assets/03Maven.html.041954b1.js"><link rel="prefetch" href="/assets/04Mybatis.html.0c028c47.js"><link rel="prefetch" href="/assets/05ç½‘é¡µä¸‰å‰‘å®¢.html.02a927b7.js"><link rel="prefetch" href="/assets/06HTTP_Tomcat_Servlet.html.b03a5cbe.js"><link rel="prefetch" href="/assets/07Request_Response.html.75b01386.js"><link rel="prefetch" href="/assets/08JSP.html.11699958.js"><link rel="prefetch" href="/assets/09Cookie_Session.html.f33cb93b.js"><link rel="prefetch" href="/assets/10Filter_Listener_Ajax.html.5b19ad2e.js"><link rel="prefetch" href="/assets/11Vue_Element.html.0ed9ded6.js"><link rel="prefetch" href="/assets/12ç»¼åˆæ¡ˆä¾‹.html.e15ac32f.js"><link rel="prefetch" href="/assets/index.html.d12bf505.js"><link rel="prefetch" href="/assets/POMæ–‡ä»¶å¸®åŠ©æ–‡æ¡£.html.68aa0e0d.js"><link rel="prefetch" href="/assets/index.html.fbd520a5.js"><link rel="prefetch" href="/assets/index.html.1b901660.js"><link rel="prefetch" href="/assets/index.html.83290ef7.js"><link rel="prefetch" href="/assets/index.html.a01449a9.js"><link rel="prefetch" href="/assets/index.html.49f29dd8.js"><link rel="prefetch" href="/assets/index.html.0c9d89e6.js"><link rel="prefetch" href="/assets/index.html.771a0849.js"><link rel="prefetch" href="/assets/index.html.931ddf30.js"><link rel="prefetch" href="/assets/index.html.83def820.js"><link rel="prefetch" href="/assets/index.html.19922c66.js"><link rel="prefetch" href="/assets/request.getInputStreamåªèƒ½è¯»å–ä¸€æ¬¡é—®é¢˜.html.c34b4ad6.js"><link rel="prefetch" href="/assets/ç¨‹åºåŒ…com.alibaba.fastjsonä¸å­˜åœ¨.html.53a076a6.js"><link rel="prefetch" href="/assets/é”™è¯¯é›†åˆ.html.b49f0ee0.js"><link rel="prefetch" href="/assets/index.html.4b882c0c.js"><link rel="prefetch" href="/assets/index.html.5d8450dc.js"><link rel="prefetch" href="/assets/index.html.cdc4465a.js"><link rel="prefetch" href="/assets/index.html.166a39ec.js"><link rel="prefetch" href="/assets/index.html.270fb1df.js"><link rel="prefetch" href="/assets/MySQL-åŸºç¡€ç¯‡.html.6c075b7f.js"><link rel="prefetch" href="/assets/Nodeå¤šç‰ˆæœ¬ç®¡ç†.html.8bbd0854.js"><link rel="prefetch" href="/assets/index.html.c3770570.js"><link rel="prefetch" href="/assets/Webè°ƒè¯•å…¥é—¨.html.bd7644a8.js"><link rel="prefetch" href="/assets/å…³äºESLInké…ç½®é—®é¢˜.html.8d585e62.js"><link rel="prefetch" href="/assets/Mavené«˜çº§.html.df063b50.js"><link rel="prefetch" href="/assets/SpringBoot.html.9c026723.js"><link rel="prefetch" href="/assets/RestTemplate.html.81424d94.js"><link rel="prefetch" href="/assets/MyBatisPlus.html.5156fad2.js"><link rel="prefetch" href="/assets/Dubboè¯¦è§£.html.a88aa8e4.js"><link rel="prefetch" href="/assets/Macä¸‹ZooKeeperå®‰è£…å’Œä½¿ç”¨.html.3de130d6.js"><link rel="prefetch" href="/assets/Zookeeperé›†ç¾¤æ­å»º.html.18398d7c.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬10ç« ï¼‰.html.aee4445f.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬11ç« ï¼‰.html.83a05a5d.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬12ç« ï¼‰.html.81ad609c.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬13ç« ï¼‰.html.cda181a7.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬1ç« ï¼‰.html.f5bee726.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬2ç« ï¼‰.html.27034da0.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬3ç« ï¼‰.html.d3a4419d.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬4ç« ï¼‰.html.6ac4d30b.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬5ç« ï¼‰.html.a6b72869.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬6ç« ï¼‰.html.b3c1f012.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬7ç« ï¼‰.html.7ed3e2ec.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬8ç« ï¼‰.html.2e845277.js"><link rel="prefetch" href="/assets/ä¼ æ™ºå¥åº·é¡¹ç›®è®²ä¹‰ï¼ˆç¬¬9ç« ï¼‰.html.d9fda0b5.js"><link rel="prefetch" href="/assets/SpringBootè®²ä¹‰.html.0e58c23a.js"><link rel="prefetch" href="/assets/Linux-Day01.html.f7ed7535.js"><link rel="prefetch" href="/assets/Linux-Day02.html.e0127077.js"><link rel="prefetch" href="/assets/RedisåŸºç¡€.html.a64b37e3.js"><link rel="prefetch" href="/assets/Gitè¯¾ç¨‹è®²ä¹‰.html.7e0f3772.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–-Day01.html.9464a5df.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–-Day02.html.45884790.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–-Day03.html.19be6c08.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–-Day04.html.a55511e6.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–-Day05.html.c8d5d2ec.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–-Day06.html.9dbbe9f4.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–ä¼˜åŒ–-Day01.html.e670be9e.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–ä¼˜åŒ–-Day02.html.36d00a62.js"><link rel="prefetch" href="/assets/ç‘å‰å¤–å–ä¼˜åŒ–-Day03.html.580a113e.js"><link rel="prefetch" href="/assets/å¾®æœåŠ¡å¸¸è§é¢è¯•é¢˜.html.d9885008.js"><link rel="prefetch" href="/assets/é”™è¯¯ç¬”è®°.html.7b8e22bd.js"><link rel="prefetch" href="/assets/day01-HTMLåŸºç¡€.html.11954ea5.js"><link rel="prefetch" href="/assets/day02-HTMLè¿›é˜¶.html.f8ea5d06.js"><link rel="prefetch" href="/assets/day04-CSSè¿›é˜¶.html.959f42d7.js"><link rel="prefetch" href="/assets/day03-CSSåŸºç¡€.html.be06d435.js"><link rel="prefetch" href="/assets/day05-ç›’å­æ¨¡å‹.html.dc398017.js"><link rel="prefetch" href="/assets/day06-Flexå¸ƒå±€.html.28d20a28.js"><link rel="prefetch" href="/assets/day07-å­¦æˆåœ¨çº¿.html.7c72e01f.js"><link rel="prefetch" href="/assets/day08-CSSé«˜çº§.html.21209494.js"><link rel="prefetch" href="/assets/day09-å°å…”é²œå„¿.html.3dbc4f3a.js"><link rel="prefetch" href="/assets/day10-å°å…”é²œå„¿.html.c5cb13d3.js"><link rel="prefetch" href="/assets/Day01-é¡¹ç›®ä»‹ç»åŠåˆå§‹åŒ–-ç™»å½•é¡µé¢.html.746c66d7.js"><link rel="prefetch" href="/assets/Day02-ç™»å½•æ¨¡å—-ä¸»é¡µé‰´æƒ.html.41a10631.js"><link rel="prefetch" href="/assets/Day03-ä¸»é¡µæ¨¡å—-ä¿®æ”¹å¯†ç .html.49ef3b40.js"><link rel="prefetch" href="/assets/Day04-ç»„ç»‡æ¶æ„.html.25f660d2.js"><link rel="prefetch" href="/assets/Day05-ç»„ç»‡æ¶æ„-è§’è‰²ç®¡ç†.html.90602422.js"><link rel="prefetch" href="/assets/Day06-è§’è‰²ç®¡ç†-å‘˜å·¥ç®¡ç†.html.cd0d3627.js"><link rel="prefetch" href="/assets/Day07-å‘˜å·¥ç®¡ç†-ä¸Šä¼ ä¸‹è½½.html.285c77ee.js"><link rel="prefetch" href="/assets/Day08-Cosä¸Šä¼ å’Œæƒé™æ•°æ®.html.9ccdcbbe.js"><link rel="prefetch" href="/assets/Day09-æƒé™åº”ç”¨-é¦–é¡µ.html.e3ebdf3e.js"><link rel="prefetch" href="/assets/Day10-é¦–é¡µå›¾è¡¨-Nginxä¸Šçº¿.html.95ddc52d.js"><link rel="prefetch" href="/assets/1.Vue3å…¥é—¨.html.10bb6d69.js"><link rel="prefetch" href="/assets/10.è´­ç‰©è½¦.html.3c7cfec8.js"><link rel="prefetch" href="/assets/11.è®¢å•é¡µ.html.e997abda.js"><link rel="prefetch" href="/assets/12.æ”¯ä»˜é¡µ.html.985ae92e.js"><link rel="prefetch" href="/assets/13.ä¼šå‘˜ä¸­å¿ƒ.html.fee07265.js"><link rel="prefetch" href="/assets/14.æ‹“å±•éƒ¨åˆ†.html.7d352ea1.js"><link rel="prefetch" href="/assets/2.Piniaå…¥é—¨.html.845f58af.js"><link rel="prefetch" href="/assets/3.é¡¹ç›®èµ·æ­¥.html.e65702ec.js"><link rel="prefetch" href="/assets/4.Layouté¡µ.html.432847ae.js"><link rel="prefetch" href="/assets/5.Homeé¡µ.html.3a774b52.js"><link rel="prefetch" href="/assets/6.ä¸€çº§åˆ†ç±»é¡µ.html.201e02bb.js"><link rel="prefetch" href="/assets/7.äºŒçº§åˆ†ç±»é¡µ.html.0fc2ae43.js"><link rel="prefetch" href="/assets/8.å•†å“è¯¦æƒ….html.9b499ef8.js"><link rel="prefetch" href="/assets/9.ç™»å½•é¡µ.html.60e1ee60.js"><link rel="prefetch" href="/assets/day01.html.bbc0a088.js"><link rel="prefetch" href="/assets/day02.html.72ed2fe6.js"><link rel="prefetch" href="/assets/day03.html.bee6c3fc.js"><link rel="prefetch" href="/assets/index.html.09257f7e.js"><link rel="prefetch" href="/assets/day01.html.ab3747f1.js"><link rel="prefetch" href="/assets/day02.html.89ec1bee.js"><link rel="prefetch" href="/assets/day03.html.d5ec2aa6.js"><link rel="prefetch" href="/assets/day04.html.56433ccb.js"><link rel="prefetch" href="/assets/index.html.e4b84db4.js"><link rel="prefetch" href="/assets/interview-base.html.e9eabf58.js"><link rel="prefetch" href="/assets/interview-enjoy-plus.html.6c9247b8.js"><link rel="prefetch" href="/assets/RedisåŸºç¡€ç¯‡.html.08c34b8a.js"><link rel="prefetch" href="/assets/Rediså¿«é€Ÿå…¥é—¨.html.cf6cb13d.js"><link rel="prefetch" href="/assets/Rediså®æˆ˜ç¯‡.html.f372dc0c.js"><link rel="prefetch" href="/assets/è¯¾å ‚ç¬”è®°.html.62fad0c1.js"><link rel="prefetch" href="/assets/RedisåŸç†ç¯‡.html.2a7ef6e3.js"><link rel="prefetch" href="/assets/è¯¾å ‚ç¬”è®°.html.85eb8328.js"><link rel="prefetch" href="/assets/Spring-day01.html.63e58b9e.js"><link rel="prefetch" href="/assets/Spring-day02.html.376435c2.js"><link rel="prefetch" href="/assets/Spring-day03.html.0e29094b.js"><link rel="prefetch" href="/assets/SpringMVC-day01.html.87e47178.js"><link rel="prefetch" href="/assets/SpringMVC-day02.html.a4b28c77.js"><link rel="prefetch" href="/assets/SpringBootStart.html.de571df2.js"><link rel="prefetch" href="/assets/SpringBootæ•´åˆSSMP.html.43f6b9c4.js"><link rel="prefetch" href="/assets/SpringBootç»¼åˆæ¡ˆä¾‹.html.221fa49f.js"><link rel="prefetch" href="/assets/é”™è¯¯ç¬”è®°.html.e82c55b7.js"><link rel="prefetch" href="/assets/SpringBootè®²ä¹‰.html.578f2ac6.js"><link rel="prefetch" href="/assets/SpringBootè®²ä¹‰.html.61a4873c.js"><link rel="prefetch" href="/assets/Centos8-streamåœ¨çœŸæœºä¸Šå®‰è£…æ’å‘.html.550f1d67.js"><link rel="prefetch" href="/assets/Centos9å®‰è£…mysql.html.80214017.js"><link rel="prefetch" href="/assets/SpringCloud01.html.12bb1f52.js"><link rel="prefetch" href="/assets/SpringCloudå®ç”¨ç¯‡02.html.d45505f0.js"><link rel="prefetch" href="/assets/Dockerå®ç”¨ç¯‡.html.74e1975a.js"><link rel="prefetch" href="/assets/RabbitMQ.html.f11b02a4.js"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼æœç´¢å¼•æ“01.html.71bc535b.js"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼æœç´¢å¼•æ“02.html.952438e2.js"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼æœç´¢å¼•æ“03.html.085884cc.js"><link rel="prefetch" href="/assets/å¾®æœåŠ¡ä¿æŠ¤.html.05b1962c.js"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼äº‹åŠ¡.html.a8f848db.js"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼ç¼“å­˜.html.0d991e8c.js"><link rel="prefetch" href="/assets/å¤šçº§ç¼“å­˜.html.f6efcf35.js"><link rel="prefetch" href="/assets/RabbitMQ-é«˜çº§ç¯‡.html.5475292f.js"><link rel="prefetch" href="/assets/Mybatisç¬¬ä¸€å¤©.html.74106e69.js"><link rel="prefetch" href="/assets/Mybatisç¬¬äºŒå¤©.html.ad5fd614.js"><link rel="prefetch" href="/assets/ç§»åŠ¨webç¬¬ä¸€å¤©.html.212d3d77.js"><link rel="prefetch" href="/assets/ç§»åŠ¨Webç¬¬äºŒå¤©.html.25b71c4a.js"><link rel="prefetch" href="/assets/ç§»åŠ¨Webç¬¬ä¸‰å¤©.html.bc0f9ffd.js"><link rel="prefetch" href="/assets/ç§»åŠ¨Webç¬¬å››å¤©.html.105bec04.js"><link rel="prefetch" href="/assets/ç§»åŠ¨Webç¬¬äº”å¤©.html.d246536f.js"><link rel="prefetch" href="/assets/JavaScriptåŸºç¡€ç¬¬ä¸€å¤©.html.6749bf6f.js"><link rel="prefetch" href="/assets/JavaScriptåŸºç¡€ç¬¬ä¸‰å¤©.html.b9c7d35b.js"><link rel="prefetch" href="/assets/javascriptåŸºç¡€ç¬¬äºŒå¤©ç¬”è®°.html.ef83735d.js"><link rel="prefetch" href="/assets/JavaScriptåŸºç¡€ç¬¬äº”å¤©.html.b791755b.js"><link rel="prefetch" href="/assets/JavaScriptåŸºç¡€ç¬¬å››å¤©.html.4771ab3b.js"><link rel="prefetch" href="/assets/index.html.b83a5020.js"><link rel="prefetch" href="/assets/ä¸ªäººå®æˆ˜æ–‡æ¡£.html.984244e3.js"><link rel="prefetch" href="/assets/index.html.6415facf.js"><link rel="prefetch" href="/assets/index.html.1e434b24.js"><link rel="prefetch" href="/assets/index.html.7dc183ed.js"><link rel="prefetch" href="/assets/index.html.f37a33bc.js"><link rel="prefetch" href="/assets/index.html.7d4ee43b.js"><link rel="prefetch" href="/assets/JavaScriptè¿›é˜¶ç¬¬ä¸€å¤©.html.000f25ff.js"><link rel="prefetch" href="/assets/day03.html.db51cbbc.js"><link rel="prefetch" href="/assets/day02.html.d66fd875.js"><link rel="prefetch" href="/assets/day04.html.b8a7f063.js"><link rel="prefetch" href="/assets/ç¬”è®°.html.818a38a3.js"><link rel="prefetch" href="/assets/ç¬”è®°.html.36b76043.js"><link rel="prefetch" href="/assets/ç¬”è®°.html.26fe9e7f.js"><link rel="prefetch" href="/assets/day01.html.c47cd770.js"><link rel="prefetch" href="/assets/day02.html.397bfdbd.js"><link rel="prefetch" href="/assets/day03.html.93fc55fd.js"><link rel="prefetch" href="/assets/day04.html.070fd4a4.js"><link rel="prefetch" href="/assets/day05.html.bd82f3d8.js"><link rel="prefetch" href="/assets/day06.html.17d00c13.js"><link rel="prefetch" href="/assets/day07.html.e7bbdf6d.js"><link rel="prefetch" href="/assets/æ™ºæ…§å•†åŸé¡¹ç›®.html.af5f40a4.js"><link rel="prefetch" href="/assets/Vue3å…¥é—¨.html.7fcc1386.js"><link rel="prefetch" href="/assets/Pinia.html.1da61f9f.js"><link rel="prefetch" href="/assets/å¤§äº‹ä»¶ç®¡ç†ç³»ç»Ÿ.html.7f4fa6e3.js"><link rel="prefetch" href="/assets/01-é¡¹ç›®èµ·æ­¥.html.e62172f5.js"><link rel="prefetch" href="/assets/02-é¦–é¡µæ¨¡å—.html.69fde283.js"><link rel="prefetch" href="/assets/03-æ¨èæ¨¡å—.html.4426873e.js"><link rel="prefetch" href="/assets/04-åˆ†ç±»æ¨¡å—.html.1cbda2ee.js"><link rel="prefetch" href="/assets/05-è¯¦æƒ…æ¨¡å—.html.0e1c5ef3.js"><link rel="prefetch" href="/assets/06-ç™»å½•æ¨¡å—.html.64931e2c.js"><link rel="prefetch" href="/assets/07-ç”¨æˆ·æ¨¡å—.html.b812d4aa.js"><link rel="prefetch" href="/assets/08-åœ°å€æ¨¡å—.html.9c01d1e1.js"><link rel="prefetch" href="/assets/09-SKUæ¨¡å—.html.84a4889e.js"><link rel="prefetch" href="/assets/10-è´­ç‰©è½¦æ¨¡å—.html.6688a027.js"><link rel="prefetch" href="/assets/11-è®¢å•æ¨¡å—.html.2f3d83d3.js"><link rel="prefetch" href="/assets/12-é¡¹ç›®æ‰“åŒ….html.91368063.js"><link rel="prefetch" href="/assets/index.html.42f6ba28.js"><link rel="prefetch" href="/assets/å¤šçº§ç¼“å­˜.html.29a0512b.js"><link rel="prefetch" href="/assets/Redisé«˜çº§-åˆ†å¸ƒå¼ç¼“å­˜.html.8e9eb1a4.js"><link rel="prefetch" href="/assets/Redisé«˜çº§ç¯‡ä¹‹æœ€ä½³å®è·µ.html.61b375ef.js"><link rel="prefetch" href="/assets/ç¬¬1å¤©.html.24b6cbc8.js"><link rel="prefetch" href="/assets/ç¬¬2å¤©.html.6a1d49a9.js"><link rel="prefetch" href="/assets/ç¬¬3å¤©.html.ef5bdd2c.js"><link rel="prefetch" href="/assets/ç¬¬4å¤©.html.f2dd6af1.js"><link rel="prefetch" href="/assets/ç¬¬5å¤©.html.3bbb5261.js"><link rel="prefetch" href="/assets/å°ç¨‹åºè‡ªå®šä¹‰tabBar.html.5d994ae6.js"><link rel="prefetch" href="/assets/ç¬¬6å¤©.html.97ffacd5.js"><link rel="prefetch" href="/assets/Nacoså®‰è£…æŒ‡å—.html.e9959e6d.js"><link rel="prefetch" href="/assets/Nacosé›†ç¾¤æ­å»º.html.d1d2d3f4.js"><link rel="prefetch" href="/assets/Centos7å®‰è£…Docker.html.499dd207.js"><link rel="prefetch" href="/assets/RabbitMQéƒ¨ç½²æŒ‡å—.html.2c223352.js"><link rel="prefetch" href="/assets/å®‰è£…elasticsearch.html.9de8319c.js"><link rel="prefetch" href="/assets/Day01_AJAXå…¥é—¨.html.d3038205.js"><link rel="prefetch" href="/assets/Day02_AJAXç»¼åˆæ¡ˆä¾‹.html.bc86a8e2.js"><link rel="prefetch" href="/assets/Day03_AJAXåŸç†.html.0f23d8cc.js"><link rel="prefetch" href="/assets/Day04_AJAXè¿›é˜¶.html.70a798a7.js"><link rel="prefetch" href="/assets/404.html.6483ccdc.js"><link rel="prefetch" href="/assets/404.25c65b32.js"><link rel="prefetch" href="/assets/Layout.041a9450.js"><link rel="prefetch" href="/assets/index.0e8935cb.js"><link rel="prefetch" href="/assets/giscus.15440425.js">
    <link rel="stylesheet" href="/assets/style.5869c25b.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/logo.png" alt="Hades"><span class="site-name can-hide">Hades</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/Android/" class="router-link-active" aria-label="Android"><!--[--><!--]--> Android <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Javaåç«¯/" class="" aria-label="Javaåç«¯"><!--[--><!--]--> Javaåç«¯ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Webå‰ç«¯/" class="" aria-label="Webå‰ç«¯"><!--[--><!--]--> Webå‰ç«¯ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/æ•°æ®åº“/" class="" aria-label="æ•°æ®åº“"><!--[--><!--]--> æ•°æ®åº“ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/è¿ç»´æŠ€æœ¯/" class="" aria-label="è¿ç»´æŠ€æœ¯"><!--[--><!--]--> è¿ç»´æŠ€æœ¯ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Tips/" class="" aria-label="Tipsâ¤ï¸â€"><!--[--><!--]--> Tipsâ¤ï¸â€ <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="ä¹¦ç­¾ğŸ”–"><span class="title">ä¹¦ç­¾ğŸ”–</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="ä¹¦ç­¾ğŸ”–"><span class="title">ä¹¦ç­¾ğŸ”–</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>æœç´¢</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.baidu.com" rel="noopener noreferrer" target="_blank" aria-label="ç™¾åº¦ä¸€ä¸‹"><!--[--><!--]--> ç™¾åº¦ä¸€ä¸‹ <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>å¸¸ç”¨</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="http://gitee.com" rel="noopener noreferrer" target="_blank" aria-label="gitee"><!--[--><!--]--> gitee <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="http://bilibili.com" rel="noopener noreferrer" target="_blank" aria-label="å“”å“©å“”å“©"><!--[--><!--]--> å“”å“©å“”å“© <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/start/BuildError/README.md" class="" aria-label="Vuepressæ‰“åŒ…é”™è¯¯"><!--[--><!--]--> Vuepressæ‰“åŒ…é”™è¯¯ <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/Android/" class="router-link-active" aria-label="Android"><!--[--><!--]--> Android <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Javaåç«¯/" class="" aria-label="Javaåç«¯"><!--[--><!--]--> Javaåç«¯ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Webå‰ç«¯/" class="" aria-label="Webå‰ç«¯"><!--[--><!--]--> Webå‰ç«¯ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/æ•°æ®åº“/" class="" aria-label="æ•°æ®åº“"><!--[--><!--]--> æ•°æ®åº“ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/è¿ç»´æŠ€æœ¯/" class="" aria-label="è¿ç»´æŠ€æœ¯"><!--[--><!--]--> è¿ç»´æŠ€æœ¯ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/Tips/" class="" aria-label="Tipsâ¤ï¸â€"><!--[--><!--]--> Tipsâ¤ï¸â€ <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="ä¹¦ç­¾ğŸ”–"><span class="title">ä¹¦ç­¾ğŸ”–</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="ä¹¦ç­¾ğŸ”–"><span class="title">ä¹¦ç­¾ğŸ”–</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>æœç´¢</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="https://www.baidu.com" rel="noopener noreferrer" target="_blank" aria-label="ç™¾åº¦ä¸€ä¸‹"><!--[--><!--]--> ç™¾åº¦ä¸€ä¸‹ <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>å¸¸ç”¨</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="external-link" href="http://gitee.com" rel="noopener noreferrer" target="_blank" aria-label="gitee"><!--[--><!--]--> gitee <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="external-link" href="http://bilibili.com" rel="noopener noreferrer" target="_blank" aria-label="å“”å“©å“”å“©"><!--[--><!--]--> å“”å“©å“”å“© <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/start/BuildError/README.md" class="" aria-label="Vuepressæ‰“åŒ…é”™è¯¯"><!--[--><!--]--> Vuepressæ‰“åŒ…é”™è¯¯ <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">ç¬¬ 7 ç« ã€€å†…å®¹å…±äº« <!----></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-1-åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ•°æ®" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.1ã€€åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ•°æ®"><!--[--><!--]--> 7.1ã€€åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ•°æ® <!--[--><!--]--></a><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-1-1-é€šè¿‡contentproviderå°è£…æ•°æ®" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.1.1ã€€é€šè¿‡ContentProviderå°è£…æ•°æ®"><!--[--><!--]--> 7.1.1ã€€é€šè¿‡ContentProviderå°è£…æ•°æ® <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-1-2-é€šè¿‡contentresolverè®¿é—®æ•°æ®" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.1.2ã€€é€šè¿‡ContentResolverè®¿é—®æ•°æ®"><!--[--><!--]--> 7.1.2ã€€é€šè¿‡ContentResolverè®¿é—®æ•°æ® <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-2-ä½¿ç”¨å†…å®¹ç»„ä»¶è·å–é€šè®¯ä¿¡æ¯" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.2ã€€ä½¿ç”¨å†…å®¹ç»„ä»¶è·å–é€šè®¯ä¿¡æ¯"><!--[--><!--]--> 7.2ã€€ä½¿ç”¨å†…å®¹ç»„ä»¶è·å–é€šè®¯ä¿¡æ¯ <!--[--><!--]--></a><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-2-1-è¿è¡Œæ—¶åŠ¨æ€ç”³è¯·æƒé™" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.2.1ã€€è¿è¡Œæ—¶åŠ¨æ€ç”³è¯·æƒé™"><!--[--><!--]--> 7.2.1ã€€è¿è¡Œæ—¶åŠ¨æ€ç”³è¯·æƒé™ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-2-2-åˆ©ç”¨contentresolverè¯»å†™è”ç³»äºº" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.2.2ã€€åˆ©ç”¨ContentResolverè¯»å†™è”ç³»äºº"><!--[--><!--]--> 7.2.2ã€€åˆ©ç”¨ContentResolverè¯»å†™è”ç³»äºº <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-2-3-åˆ©ç”¨contentobserverç›‘å¬çŸ­ä¿¡" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.2.3ã€€åˆ©ç”¨ContentObserverç›‘å¬çŸ­ä¿¡"><!--[--><!--]--> 7.2.3ã€€åˆ©ç”¨ContentObserverç›‘å¬çŸ­ä¿¡ <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-3-åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ–‡ä»¶" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.3ã€€åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ–‡ä»¶"><!--[--><!--]--> 7.3ã€€åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ–‡ä»¶ <!--[--><!--]--></a><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-3-1-ä½¿ç”¨ç›¸å†Œå›¾ç‰‡å‘é€å½©ä¿¡" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.3.1ã€€ä½¿ç”¨ç›¸å†Œå›¾ç‰‡å‘é€å½©ä¿¡"><!--[--><!--]--> 7.3.1ã€€ä½¿ç”¨ç›¸å†Œå›¾ç‰‡å‘é€å½©ä¿¡ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-3-2-å€ŸåŠ©fileproviderå‘é€å½©ä¿¡" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.3.2ã€€å€ŸåŠ©FileProviderå‘é€å½©ä¿¡"><!--[--><!--]--> 7.3.2ã€€å€ŸåŠ©FileProviderå‘é€å½©ä¿¡ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-3-3-å€ŸåŠ©fileproviderå®‰è£…åº”ç”¨" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.3.3ã€€å€ŸåŠ©FileProviderå®‰è£…åº”ç”¨"><!--[--><!--]--> 7.3.3ã€€å€ŸåŠ©FileProviderå®‰è£…åº”ç”¨ <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-4-å°ç»“" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.4ã€€å°ç»“"><!--[--><!--]--> 7.4ã€€å°ç»“ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Android/AndroidBasic/%E7%AC%AC07%E7%AB%A0%E5%86%85%E5%AE%B9%E5%85%B1%E4%BA%AB.html#_7-5-è¯¾åç»ƒä¹ é¢˜" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.5ã€€è¯¾åç»ƒä¹ é¢˜"><!--[--><!--]--> 7.5ã€€è¯¾åç»ƒä¹ é¢˜ <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="ç¬¬-7-ç« -å†…å®¹å…±äº«" tabindex="-1"><a class="header-anchor" href="#ç¬¬-7-ç« -å†…å®¹å…±äº«" aria-hidden="true">#</a> ç¬¬ 7 ç« ã€€å†…å®¹å…±äº«</h1><p>æœ¬ç« ä»‹ç»Androidä¸åŒåº”ç”¨ä¹‹é—´å…±äº«å†…å®¹çš„å…·ä½“æ–¹å¼ï¼Œä¸»è¦åŒ…æ‹¬ï¼šå¦‚ä½•åˆ©ç”¨å†…å®¹ç»„ä»¶åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ•°æ®ï¼Œå¦‚ä½•ä½¿ç”¨å†…å®¹ç»„ä»¶è·å–ç³»ç»Ÿçš„é€šè®¯ä¿¡æ¯ï¼Œå¦‚ä½•å€ŸåŠ©æ–‡ä»¶æä¾›å™¨åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ–‡ä»¶ç­‰ã€‚</p><h2 id="_7-1-åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_7-1-åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ•°æ®" aria-hidden="true">#</a> 7.1ã€€åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ•°æ®</h2><p>æœ¬èŠ‚ä»‹ç»Android 4å¤§ç»„ä»¶ä¹‹ä¸€ContentProviderçš„åŸºæœ¬æ¦‚å¿µå’Œå¸¸è§ç”¨æ³•ã€‚é¦–å…ˆè¯´æ˜å¦‚ä½•ä½¿ç”¨å†…å®¹æä¾›å™¨å°è£…å†…éƒ¨æ•°æ®çš„å¤–éƒ¨è®¿é—®æ¥å£ï¼Œæ¥ç€é˜è¿°å¦‚ä½•ä½¿ç”¨å†…å®¹è§£æå™¨é€šè¿‡å¤–éƒ¨æ¥å£æ“ä½œå†…éƒ¨æ•°æ®ã€‚</p><h3 id="_7-1-1-é€šè¿‡contentproviderå°è£…æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_7-1-1-é€šè¿‡contentproviderå°è£…æ•°æ®" aria-hidden="true">#</a> 7.1.1ã€€é€šè¿‡ContentProviderå°è£…æ•°æ®</h3><p>Androidå·ç§°æä¾›äº† 4 å¤§ç»„ä»¶ï¼Œåˆ†åˆ«æ˜¯æ´»åŠ¨Activityã€å¹¿æ’­Broadcastã€æœåŠ¡Serviceå’Œå†…å®¹æä¾›å™¨ContentProviderã€‚å…¶ä¸­å†…å®¹æä¾›å™¨æ¶µç›–ä¸å†…éƒ¨æ•°æ®å­˜å–æœ‰å…³çš„ä¸€ç³»åˆ—ç»„ä»¶ï¼Œå®Œæ•´çš„å†…å®¹ç»„ä»¶ç”±å†…å®¹æä¾›å™¨ContentProviderã€å†…å®¹è§£æå™¨ContentResolverã€å†…å®¹è§‚å¯Ÿå™¨ContentObserverä¸‰éƒ¨åˆ†ç»„æˆã€‚</p><p>ContentProviderç»™Appå­˜å–å†…éƒ¨æ•°æ®æä¾›äº†ç»Ÿä¸€çš„å¤–éƒ¨æ¥å£ï¼Œè®©ä¸åŒçš„åº”ç”¨ä¹‹é—´å¾—ä»¥äº’ç›¸å…±äº«æ•°æ®ã€‚åƒä¸Šä¸€ç« æåˆ°çš„SQLiteå¯æ“ä½œåº”ç”¨è‡ªèº«çš„å†…éƒ¨æ•°æ®åº“ï¼›ä¸Šä¼ å’Œä¸‹è½½åŠŸèƒ½å¯æ“ä½œåç«¯æœåŠ¡å™¨çš„æ–‡ä»¶ï¼›è€ŒContentProviderå¯æ“ä½œå½“å‰è®¾å¤‡å…¶ä»–åº”ç”¨çš„å†…éƒ¨æ•°æ®ï¼Œå®ƒæ˜¯ä¸€ç§ä¸­é—´å±‚æ¬¡çš„æ•°æ®å­˜å‚¨å½¢å¼ã€‚åœ¨å®é™…ç¼–ç ä¸­ï¼ŒContentProvideråªæ˜¯æœåŠ¡ç«¯Appå­˜å–æ•°æ®çš„æŠ½è±¡ç±»ï¼Œå¼€å‘è€…éœ€è¦åœ¨å…¶åŸºç¡€ä¸Šå®ç°ä¸€ä¸ªå®Œæ•´çš„å†…å®¹æä¾›å™¨ï¼Œå¹¶é‡å†™ä¸‹åˆ—æ•°æ®åº“ç®¡ç†æ–¹æ³•ã€‚</p><ul><li><p>onCreateï¼šåˆ›å»ºæ•°æ®åº“å¹¶è·å¾—æ•°æ®åº“è¿æ¥ã€‚</p></li><li><p>insÂ·ertï¼šæ’å…¥æ•°æ®ã€‚</p></li><li><p>deleteï¼šåˆ é™¤æ•°æ®ã€‚</p></li><li><p>updateï¼šæ›´æ–°æ•°æ®ã€‚</p></li><li><p>queryï¼šæŸ¥è¯¢æ•°æ®ï¼Œå¹¶è¿”å›ç»“æœé›†çš„æ¸¸æ ‡ã€‚</p></li><li><p>getTypeï¼šè·å–å†…å®¹æä¾›å™¨æ”¯æŒçš„æ•°æ®ç±»å‹ã€‚</p></li></ul><p>è¿™äº›æ–¹æ³•çœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆåƒSQLiteï¼Ÿæ²¡é”™ï¼ŒContentProviderä½œä¸ºä¸­é—´æ¥å£ï¼Œæœ¬èº«å¹¶ä¸ç›´æ¥ä¿å­˜æ•°æ®ï¼Œè€Œæ˜¯é€šè¿‡SQLiteOpenHelperä¸SQLiteDatabaseé—´æ¥æ“ä½œåº•å±‚çš„æ•°æ®åº“ã€‚æ‰€ä»¥è¦æƒ³ä½¿ç”¨ContentProviderï¼Œé¦–å…ˆå¾—å®ç°SQLiteçš„æ•°æ®åº“å¸®åŠ©å™¨ï¼Œç„¶åç”±ContentProviderå°è£…å¯¹å¤–çš„æ¥å£ã€‚ä»¥å°è£…ç”¨æˆ·ä¿¡æ¯ä¸ºä¾‹ï¼Œå…·ä½“æ­¥éª¤ä¸»è¦åˆ†æˆä»¥ä¸‹ 3 æ­¥ã€‚</p><p>1 ï¼ç¼–å†™ç”¨æˆ·ä¿¡æ¯è¡¨çš„æ•°æ®åº“å¸®åŠ©å™¨</p><p>è¿™ä¸ªæ•°æ®åº“å¸®åŠ©å™¨å°±æ˜¯å¸¸è§„çš„SQLiteæ“ä½œä»£ç ï¼Œå®ç°è¿‡ç¨‹å‚è§ä¸Šä¸€ç« çš„â€œ6.2.3ã€€æ•°æ®åº“å¸®åŠ©å™¨</p><p>SQLiteOpenHelperâ€ï¼Œå®Œæ•´ä»£ç å‚è§</p><p>chapter07\src\main\java\com\example\chapter07\database\UserDBHelper.javaã€‚</p><p>2 ï¼ç¼–å†™å†…å®¹æä¾›å™¨çš„åŸºç¡€å­—æ®µç±»</p><p>è¯¥ç±»éœ€è¦å®ç°æ¥å£BaseColumnsï¼ŒåŒæ—¶åŠ å…¥å‡ ä¸ªå¸¸é‡å®šä¹‰ã€‚è¯¦ç»†ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><p>ï¼ˆå®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\provider\UserInfoContent.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserInfoContent</span> <span class="token keyword">implements</span> <span class="token class-name">BaseColumns</span> <span class="token punctuation">{</span>
<span class="token comment">// è¿™é‡Œçš„åç§°å¿…é¡»ä¸AndroidManifest.xmlé‡Œçš„android:authoritiesä¿æŒä¸€è‡´</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">AUTHORITIES</span> <span class="token operator">=</span> <span class="token string">&quot;com.example.chapter07.provider.UserInfoProvider&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// å†…å®¹æä¾›å™¨çš„å¤–éƒ¨è¡¨å</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">TABLE_NAME</span> <span class="token operator">=</span> <span class="token class-name">UserDBHelper</span><span class="token punctuation">.</span><span class="token constant">TABLE_NAME</span><span class="token punctuation">;</span>
<span class="token comment">// è®¿é—®å†…å®¹æä¾›å™¨çš„URI</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Uri</span> <span class="token constant">CONTENT_URI</span> <span class="token operator">=</span> <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;content://&quot;</span> <span class="token operator">+</span> <span class="token constant">AUTHORITIES</span> <span class="token operator">+</span> <span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ä¸‹é¢æ˜¯è¯¥è¡¨çš„å„ä¸ªå­—æ®µåç§°</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">USER_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">;</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">USER_AGE</span> <span class="token operator">=</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">;</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">USER_HEIGHT</span> <span class="token operator">=</span> <span class="token string">&quot;height&quot;</span><span class="token punctuation">;</span> <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">USER_WEIGHT</span> <span class="token operator">=</span> <span class="token string">&quot;weight&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3 ï¼é€šè¿‡å³é”®èœå•åˆ›å»ºå†…å®¹æä¾›å™¨</p><p>å³å‡»Appæ¨¡å—çš„åŒ…åç›®å½•ï¼Œåœ¨å¼¹å‡ºçš„å³é”®èœå•ä¸­ä¾æ¬¡é€‰æ‹©Newâ†’Otherâ†’Content Providerï¼Œæ‰“å¼€å¦‚å›¾7</p><p>1 æ‰€ç¤ºçš„ç»„ä»¶åˆ›å»ºå¯¹è¯æ¡†ã€‚</p><p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111123301.png" alt="image-20220711112347188"></p><p>å›¾7-1ã€€å†…å®¹æä¾›å™¨çš„ç»„ä»¶åˆ›å»ºå¯¹è¯æ¡†</p><p>åœ¨åˆ›å»ºå¯¹è¯æ¡†çš„Class Nameä¸€æ å¡«å†™å†…å®¹æä¾›å™¨çš„åç§°ï¼Œæ¯”å¦‚UserInfoProviderï¼›åœ¨URI Authoritiesä¸€æ å¡«å†™URIçš„æˆæƒä¸²ï¼Œæ¯”å¦‚â€œcom.example.chapter07.provider.UserInfoProviderâ€ï¼›ç„¶åå•å‡»å¯¹è¯æ¡†å³ä¸‹è§’çš„FinishæŒ‰é’®ï¼Œå®Œæˆæä¾›å™¨çš„åˆ›å»ºæ“ä½œã€‚</p><p>ä¸Šè¿°åˆ›å»ºè¿‡ç¨‹ä¼šè‡ªåŠ¨ä¿®æ”¹Appæ¨¡å—çš„ä¸¤å¤„åœ°æ–¹ï¼Œä¸€å¤„æ˜¯å¾€AndroidManifest.xmlæ·»åŠ å†…å®¹æä¾›å™¨çš„æ³¨å†Œé…ç½®ï¼Œé…ç½®ä¿¡æ¯ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- providerçš„authoritieså±æ€§å€¼éœ€è¦ä¸Javaä»£ç çš„AUTHORITIESä¿æŒä¸€è‡´    --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>provider</span>
<span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>.provider.UserInfoProvider<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">android:</span>authorities</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.example.chapter07.provider.UserInfoProvider<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">android:</span>enabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
<span class="token attr-name"><span class="token namespace">android:</span>exported</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦ä¸€å¤„æ˜¯åœ¨åŒ…åç›®å½•ä¸‹ç”Ÿæˆåä¸ºUserInfoProvider.javaçš„ä»£ç æ–‡ä»¶ï¼Œæ‰“å¼€ä¸€çœ‹å‘ç°è¯¥ç±»ç»§æ‰¿äº†ContentProviderï¼Œå¹¶ä¸”æç¤ºé‡å†™onCreateã€insertã€deleteã€queryã€updateã€getTypeç­‰æ–¹æ³•ï¼Œä»¥ä¾¿å¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹æŸ¥ç­‰æ“ä½œã€‚è¿™ä¸ªæä¾›å™¨ä»£ç æ˜¾ç„¶åªæœ‰ä¸€ä¸ªæ¡†æ¶ï¼Œè¿˜éœ€è¡¥å……è¯¦ç»†çš„å®ç°ä»£ç ï¼Œä¸ºæ­¤é‡å†™onCreateæ–¹æ³•ï¼Œåœ¨æ­¤è·å–ç”¨æˆ·ä¿¡æ¯è¡¨çš„æ•°æ®åº“å¸®åŠ©å™¨å®ä¾‹ï¼Œå…¶ä»–insertã€deleteã€queryç­‰æ–¹æ³•ä¹Ÿè¦åŠ å…¥å¯¹åº”çš„æ•°æ®åº“æ“ä½œä»£ç ï¼Œä¿®æ”¹ä¹‹åçš„å†…å®¹æä¾›å™¨ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>ï¼ˆå®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\provider\UserInfoProvider.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserInfoProvider</span> <span class="token keyword">extends</span> <span class="token class-name">ContentProvider</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">UserDBHelper</span> dbHelper<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">UriMatcher</span> <span class="token constant">URI_MATCHER</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UriMatcher</span><span class="token punctuation">(</span><span class="token class-name">UriMatcher</span><span class="token punctuation">.</span><span class="token constant">NO_MATCH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">USERS</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">USER</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¾€UriåŒ¹é…å™¨ä¸­æ·»åŠ æŒ‡å®šçš„æ•°æ®è·¯å¾„</span>
        <span class="token constant">URI_MATCHER</span><span class="token punctuation">.</span><span class="token function">addURI</span><span class="token punctuation">(</span><span class="token class-name">UserInfoContent</span><span class="token punctuation">.</span><span class="token constant">AUTHORITIES</span><span class="token punctuation">,</span> <span class="token string">&quot;/user&quot;</span><span class="token punctuation">,</span> <span class="token constant">USERS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token constant">URI_MATCHER</span><span class="token punctuation">.</span><span class="token function">addURI</span><span class="token punctuation">(</span><span class="token class-name">UserInfoContent</span><span class="token punctuation">.</span><span class="token constant">AUTHORITIES</span><span class="token punctuation">,</span> <span class="token string">&quot;/user/#&quot;</span><span class="token punctuation">,</span> <span class="token constant">USER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">&quot;ning&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;UserInfoProvider onCreate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dbHelper <span class="token operator">=</span> <span class="token class-name">UserDBHelper</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// content://com.dongnaoedu.chapter07_server.provider.UserInfoProvider/user</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Uri</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">Uri</span> uri<span class="token punctuation">,</span> <span class="token class-name">ContentValues</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">&quot;ning&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;UserInfoProvider insert&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">URI_MATCHER</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">USERS</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">SQLiteDatabase</span> db <span class="token operator">=</span> dbHelper<span class="token punctuation">.</span><span class="token function">getWritableDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">long</span> rowId <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">UserDBHelper</span><span class="token punctuation">.</span><span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">/*if (rowId &gt; 0) { // åˆ¤æ–­æ’å…¥æ˜¯å¦æ‰§è¡ŒæˆåŠŸ
                // å¦‚æœæ·»åŠ æˆåŠŸï¼Œå°±åˆ©ç”¨æ–°è®°å½•çš„è¡Œå·ç”Ÿæˆæ–°çš„åœ°å€
                Uri newUri = ContentUris.withAppendedId(UserInfoContent.CONTENT_URI, rowId);
                // é€šçŸ¥ç›‘å¬å™¨ï¼Œæ•°æ®å·²ç»æ”¹å˜
                getContext().getContentResolver().notifyChange(newUri, null);
            }*/</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> uri<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Cursor</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Uri</span> uri<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> projection<span class="token punctuation">,</span> <span class="token class-name">String</span> selection<span class="token punctuation">,</span>
                        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> selectionArgs<span class="token punctuation">,</span> <span class="token class-name">String</span> sortOrder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">&quot;ning&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;UserInfoProvider query&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">URI_MATCHER</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">USERS</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">SQLiteDatabase</span> db <span class="token operator">=</span> dbHelper<span class="token punctuation">.</span><span class="token function">getReadableDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">UserDBHelper</span><span class="token punctuation">.</span><span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span> projection<span class="token punctuation">,</span> selection<span class="token punctuation">,</span> selectionArgs<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Uri</span> uri<span class="token punctuation">,</span> <span class="token class-name">String</span> selection<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> selectionArgs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token constant">URI_MATCHER</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//content://com.dongnaoedu.chapter07_server.provider.UserInfoProvider/user</span>
            <span class="token comment">// åˆ é™¤å¤šè¡Œ</span>
            <span class="token keyword">case</span> <span class="token constant">USERS</span><span class="token operator">:</span>
                <span class="token class-name">SQLiteDatabase</span> db1 <span class="token operator">=</span> dbHelper<span class="token punctuation">.</span><span class="token function">getWritableDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                count <span class="token operator">=</span> db1<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">UserDBHelper</span><span class="token punctuation">.</span><span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span> selection<span class="token punctuation">,</span> selectionArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
                db1<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

            <span class="token comment">//content://com.dongnaoedu.chapter07_server.provider.UserInfoProvider/user/2</span>
            <span class="token comment">//åˆ é™¤å•è¡Œ</span>
            <span class="token keyword">case</span> <span class="token constant">USER</span><span class="token operator">:</span>
                <span class="token class-name">String</span> id <span class="token operator">=</span> uri<span class="token punctuation">.</span><span class="token function">getLastPathSegment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">SQLiteDatabase</span> db2 <span class="token operator">=</span> dbHelper<span class="token punctuation">.</span><span class="token function">getWritableDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                count <span class="token operator">=</span> db2<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">UserDBHelper</span><span class="token punctuation">.</span><span class="token constant">TABLE_NAME</span><span class="token punctuation">,</span> <span class="token string">&quot;_id=?&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                db2<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> count<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getType</span><span class="token punctuation">(</span><span class="token class-name">Uri</span> uri<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// TODO: Implement this to handle requests for the MIME type of the data</span>
        <span class="token comment">// at the given URI.</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">&quot;Not yet implemented&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">Uri</span> uri<span class="token punctuation">,</span> <span class="token class-name">ContentValues</span> values<span class="token punctuation">,</span> <span class="token class-name">String</span> selection<span class="token punctuation">,</span>
                      <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> selectionArgs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">&quot;Not yet implemented&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç»è¿‡ä»¥ä¸Š 3 ä¸ªæ­¥éª¤ä¹‹åï¼Œä¾¿å®Œæˆäº†æœåŠ¡ç«¯Appçš„æ¥å£å°è£…å·¥ä½œï¼Œæ¥ä¸‹æ¥å†ç”±å…¶ä»–Appå»è®¿é—®æœåŠ¡ç«¯Appçš„æ•°æ®ã€‚</p><h3 id="_7-1-2-é€šè¿‡contentresolverè®¿é—®æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_7-1-2-é€šè¿‡contentresolverè®¿é—®æ•°æ®" aria-hidden="true">#</a> 7.1.2ã€€é€šè¿‡ContentResolverè®¿é—®æ•°æ®</h3><p>ä¸Šä¸€å°èŠ‚æåˆ°äº†åˆ©ç”¨ContentProviderå°è£…æœåŠ¡ç«¯Appçš„æ•°æ®ï¼Œå¦‚æœå®¢æˆ·ç«¯Appæƒ³è®¿é—®å¯¹æ–¹çš„å†…éƒ¨æ•°æ®ï¼Œå°±è¦å€ŸåŠ©å†…å®¹è§£æå™¨ContentResolverã€‚å†…å®¹è§£æå™¨æ˜¯å®¢æˆ·ç«¯Appæ“ä½œæœåŠ¡ç«¯æ•°æ®çš„å·¥å…·ï¼Œä¸ä¹‹å¯¹åº”çš„å†…å®¹æä¾›å™¨åˆ™æ˜¯æœåŠ¡ç«¯çš„æ•°æ®æ¥å£ã€‚åœ¨æ´»åŠ¨ä»£ç ä¸­è°ƒç”¨getContentResolveræ–¹æ³•ï¼Œå³å¯è·å–å†…å®¹è§£æå™¨çš„å®ä¾‹ã€‚ContentResolveræä¾›çš„æ–¹æ³•ä¸ContentProviderä¸€ä¸€å¯¹åº”ï¼Œæ¯”å¦‚insertã€deleteã€queryã€updateã€getTypeç­‰ï¼Œç”šè‡³è¿æ–¹æ³•çš„å‚æ•°ç±»å‹éƒ½é›·åŒã€‚ä»¥æ·»åŠ æ“ä½œä¸ºä¾‹ï¼Œé’ˆå¯¹å‰é¢UserInfoProvideræä¾›çš„æ•°æ®æ¥å£ï¼Œä¸‹é¢ç”±å†…å®¹è§£æå™¨è°ƒç”¨insertæ–¹æ³•ï¼Œä½¿ä¹‹å¾€å†…å®¹æä¾›å™¨æ’å…¥ä¸€æ¡ç”¨æˆ·ä¿¡æ¯ï¼Œè®°å½•æ·»åŠ ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>ï¼ˆå®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\ContentWriteActivity.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// æ·»åŠ ä¸€æ¡ç”¨æˆ·è®°å½•</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addUser</span><span class="token punctuation">(</span><span class="token class-name">UserInfo</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token class-name">ContentValues</span> name <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ContentValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  name<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  name<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  name<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;height&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  name<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;weight&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span>weight<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  name<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;married&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	name<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;update_time&quot;</span><span class="token punctuation">,</span> <span class="token class-name">DateUtil</span><span class="token punctuation">.</span><span class="token function">getNowDateTime</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// é€šè¿‡å†…å®¹è§£æå™¨å¾€æŒ‡å®šUriæ·»åŠ ç”¨æˆ·ä¿¡æ¯</span>
<span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">UserInfoContent</span><span class="token punctuation">.</span><span class="token constant">CONTENT_URI</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡³äºåˆ é™¤æ“ä½œå°±æ›´ç®€å•äº†ï¼Œåªè¦ä¸‹é¢ä¸€è¡Œä»£ç å°±åˆ é™¤äº†æ‰€æœ‰è®°å½•ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">UserInfoContent</span><span class="token punctuation">.</span><span class="token constant">CONTENT_URI</span><span class="token punctuation">,</span> <span class="token string">&quot;1=1&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æŸ¥è¯¢æ“ä½œç¨å¾®å¤æ‚ä¸€äº›ï¼Œè°ƒç”¨queryæ–¹æ³•ä¼šè¿”å›æ¸¸æ ‡å¯¹è±¡ï¼Œè¿™ä¸ªæ¸¸æ ‡æ­£æ˜¯SQLiteçš„æ¸¸æ ‡Cursorï¼Œè¯¦ç»†ç”¨æ³•å‚è§ä¸Šä¸€ç« çš„â€œ6.2.3ã€€æ•°æ®åº“å¸®åŠ©å™¨SQLiteOpenHelperâ€ã€‚queryæ–¹æ³•çš„è¾“å…¥å‚æ•°æœ‰å¥½å‡ ä¸ªï¼Œå…·ä½“è¯´æ˜å¦‚ä¸‹ï¼ˆä¾å‚æ•°é¡ºåºæ’åˆ—ï¼‰ã€‚</p><ul><li><p>uriï¼šUriç±»å‹ï¼ŒæŒ‡å®šæœ¬æ¬¡æ“ä½œçš„æ•°æ®è¡¨è·¯å¾„ã€‚</p></li><li><p>projectionï¼šå­—ç¬¦ä¸²æ•°ç»„ç±»å‹ï¼ŒæŒ‡å®šå°†è¦æŸ¥è¯¢çš„å­—æ®µåç§°åˆ—è¡¨ã€‚</p></li><li><p>selectionï¼šå­—ç¬¦ä¸²ç±»å‹ï¼ŒæŒ‡å®šæŸ¥è¯¢æ¡ä»¶ã€‚</p></li><li><p>selectionArgsï¼šå­—ç¬¦ä¸²æ•°ç»„ç±»å‹ï¼ŒæŒ‡å®šæŸ¥è¯¢æ¡ä»¶ä¸­çš„å‚æ•°å–å€¼åˆ—è¡¨ã€‚</p></li><li><p>sortOrderï¼šå­—ç¬¦ä¸²ç±»å‹ï¼ŒæŒ‡å®šæ’åºæ¡ä»¶ã€‚</p></li></ul><p>ä¸‹é¢æ˜¯è°ƒç”¨queryæ–¹æ³•ä»å†…å®¹æä¾›å™¨æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯çš„ä»£ç ä¾‹å­ï¼š</p><p>ï¼ˆå®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\ContentReadActivity.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Cursor</span> cursor <span class="token operator">=</span> <span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">UserInfoContent</span><span class="token punctuation">.</span><span class="token constant">CONTENT_URI</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">moveToNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token class-name">User</span> info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        info<span class="token punctuation">.</span>id <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">UserInfoContent</span><span class="token punctuation">.</span>_ID<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        info<span class="token punctuation">.</span>name <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">UserInfoContent</span><span class="token punctuation">.</span><span class="token constant">USER_NAME</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        info<span class="token punctuation">.</span>age <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">UserInfoContent</span><span class="token punctuation">.</span><span class="token constant">USER_AGE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        info<span class="token punctuation">.</span>height <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">UserInfoContent</span><span class="token punctuation">.</span><span class="token constant">USER_HEIGHT</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        info<span class="token punctuation">.</span>weight <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getFloat</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">UserInfoContent</span><span class="token punctuation">.</span><span class="token constant">USER_WEIGHT</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        info<span class="token punctuation">.</span>married <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">UserInfoContent</span><span class="token punctuation">.</span><span class="token constant">USER_MARRIED</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">&quot;ning&quot;</span><span class="token punctuation">,</span> info<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    cursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥åˆ†åˆ«æ¼”ç¤ºé€šè¿‡å†…å®¹è§£æå™¨æ·»åŠ å’ŒæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„è¿‡ç¨‹ï¼Œå…¶ä¸­è®°å½•æ·»åŠ é¡µé¢ä¸ºContentWriteActivity.javaï¼Œè®°å½•æŸ¥è¯¢é¡µé¢ä¸ºContentReadActivity.javaã€‚è¿è¡Œæµ‹è¯•Appï¼Œå…ˆæ‰“å¼€è®°å½•æ·»åŠ é¡µé¢ï¼Œè¾“å…¥ç”¨æˆ·ä¿¡æ¯åç‚¹å‡»æ·»åŠ æŒ‰é’®ï¼Œç”±å†…å®¹è§£æå™¨æ‰§è¡Œæ’å…¥æ“ä½œï¼Œæ­¤æ—¶æ·»åŠ ç•Œé¢å¦‚å›¾7-2æ‰€ç¤ºã€‚æ¥ç€æ‰“å¼€è®°å½•æŸ¥è¯¢é¡µé¢ï¼Œå†…å®¹è§£æå™¨è‡ªåŠ¨æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œå¹¶å°†æŸ¥åˆ°çš„ç”¨æˆ·ä¿¡æ¯ä¸€ä¸€æ˜¾ç¤ºå‡ºæ¥ï¼Œæ­¤æ—¶æŸ¥è¯¢ç•Œé¢å¦‚å›¾7-3æ‰€ç¤ºã€‚</p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111137878.png" alt="image-20220711113719795" style="zoom:50%;"><p>å›¾7-2ã€€é€šè¿‡å†…å®¹è§£æå™¨æ·»åŠ ç”¨æˆ·ä¿¡æ¯</p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111137370.png" alt="image-20220711113727298" style="zoom:50%;"><p>å›¾7-3ã€€é€šè¿‡å†…å®¹è§£æå™¨æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</p><p>å¯¹æ¯”æ·»åŠ é¡µé¢å’ŒæŸ¥è¯¢é¡µé¢çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¯çŸ¥æˆåŠŸæŸ¥åˆ°äº†æ–°å¢çš„ç”¨æˆ·è®°å½•ã€‚</p><h2 id="_7-2-ä½¿ç”¨å†…å®¹ç»„ä»¶è·å–é€šè®¯ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_7-2-ä½¿ç”¨å†…å®¹ç»„ä»¶è·å–é€šè®¯ä¿¡æ¯" aria-hidden="true">#</a> 7.2ã€€ä½¿ç”¨å†…å®¹ç»„ä»¶è·å–é€šè®¯ä¿¡æ¯</h2><p>æœ¬èŠ‚ä»‹ç»äº†ä½¿ç”¨å†…å®¹ç»„ä»¶è·å–é€šè®¯ä¿¡æ¯çš„æ“ä½œåŠæ³•ï¼ŒåŒ…æ‹¬ï¼šå¦‚ä½•åœ¨Appè¿è¡Œçš„æ—¶å€™åŠ¨æ€ç”³è¯·æƒé™ï¼ˆè®¿é—®é€šè®¯ä¿¡æ¯è¦æ±‚è·å¾—ç›¸åº”æˆæƒï¼‰ï¼Œå¦‚ä½•åˆ©ç”¨å†…å®¹è§£æå™¨è¯»å†™è”ç³»äººä¿¡æ¯ï¼Œå¦‚ä½•åˆ©ç”¨å†…å®¹è§‚å¯Ÿå™¨ç›‘å¬æ”¶åˆ°çš„çŸ­ä¿¡å†…å®¹ç­‰ã€‚</p><h3 id="_7-2-1-è¿è¡Œæ—¶åŠ¨æ€ç”³è¯·æƒé™" tabindex="-1"><a class="header-anchor" href="#_7-2-1-è¿è¡Œæ—¶åŠ¨æ€ç”³è¯·æƒé™" aria-hidden="true">#</a> 7.2.1ã€€è¿è¡Œæ—¶åŠ¨æ€ç”³è¯·æƒé™</h3><p>ä¸Šä¸€ç« çš„â€œ6.3.1ã€€å…¬å…±å­˜å‚¨ç©ºé—´ä¸ç§æœ‰å­˜å‚¨ç©ºé—´â€æåˆ°ï¼ŒAppè‹¥æƒ³è®¿é—®å­˜å‚¨å¡çš„å…¬å…±ç©ºé—´ï¼Œå°±è¦åœ¨AndroidManifest.xmlé‡Œé¢æ·»åŠ ä¸‹è¿°çš„æƒé™é…ç½®ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!-å­˜å‚¨å¡è¯»å†™</span> <span class="token attr-name">--</span><span class="token punctuation">&gt;</span></span> 
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.WRITE_EXTERNAL_STORAGE<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> 
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.READ_EXTERNAL_STORAG<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶è€Œå³ä½¿Appå£°æ˜äº†å®Œæ•´çš„å­˜å‚¨å¡æ“ä½œæƒé™ï¼Œä»Android 7.0å¼€å§‹ï¼Œç³»ç»Ÿä»ç„¶é»˜è®¤ç¦æ­¢è¯¥Appè®¿é—®å…¬å…±ç©ºé—´ï¼Œå¿…é¡»åˆ°è®¾ç½®ç•Œé¢æ‰‹åŠ¨å¼€å¯åº”ç”¨çš„å­˜å‚¨å¡æƒé™æ‰è¡Œã€‚å°½ç®¡æ­¤ä¸¾æ˜¯ä¸ºç”¨æˆ·éšç§ç€æƒ³ï¼Œå¯æ˜¯äººå®¶å’‹çŸ¥é“è¦æ‰‹å·¥å¼€æƒé™å‘¢ï¼Ÿå°±ç®—ç”¨æˆ·çŸ¥é“ï¼Œå»è®¾ç½®ç•Œé¢æ‰¾åˆ°æƒé™å¼€å…³ä¹Ÿé¢‡è´¹å‘¨æŠ˜ã€‚ä¸ºæ­¤Androidæ”¯æŒåœ¨Javaä»£ç ä¸­å¤„ç†æƒé™ï¼Œå¤„ç†è¿‡ç¨‹åˆ†ä¸º 3 ä¸ªæ­¥éª¤ï¼Œè¯¦è¿°å¦‚ä¸‹ï¼š</p><p><strong>1 ï¼æ£€æŸ¥Appæ˜¯å¦å¼€å¯äº†æŒ‡å®šæƒé™</strong></p><p>æƒé™æ£€æŸ¥éœ€è¦è°ƒç”¨ContextCompatçš„checkSelfPermissionæ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ´»åŠ¨å®ä¾‹ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå¾…æ£€æŸ¥çš„æƒé™åç§°ï¼Œä¾‹å¦‚å­˜å‚¨å¡çš„å†™æƒé™åä¸ºManifest.permission.WRITE_EXTERNAL_STORAGEã€‚æ³¨æ„checkSelfPermissionæ–¹æ³•çš„è¿”å›å€¼ï¼Œå½“å®ƒä¸ºPackageManager.PERMISSION_GRANTEDæ—¶è¡¨ç¤ºå·²ç»æˆæƒï¼Œå¦åˆ™å°±æ˜¯æœªè·æˆæƒã€‚</p><p><strong>2 ï¼è¯·æ±‚ç³»ç»Ÿå¼¹çª—ï¼Œä»¥ä¾¿ç”¨æˆ·é€‰æ‹©æ˜¯å¦å¼€å¯æƒé™</strong></p><p>ä¸€æ—¦å‘ç°æŸä¸ªæƒé™å°šæœªå¼€å¯ï¼Œå°±å¾—å¼¹çª—æç¤ºç”¨æˆ·æ‰‹å·¥å¼€å¯ï¼Œè¿™ä¸ªå¼¹çª—ä¸æ˜¯å¼€å‘è€…è‡ªå·±å†™çš„æé†’å¯¹è¯æ¡†ï¼Œè€Œæ˜¯ç³»ç»Ÿä¸“é—¨ç”¨äºæƒé™ç”³è¯·çš„å¯¹è¯æ¡†ã€‚è°ƒç”¨ActivityCompatçš„requestPermissionsæ–¹æ³•ï¼Œå³å¯å‘½ä»¤ç³»ç»Ÿè‡ªåŠ¨å¼¹å‡ºæƒé™ç”³è¯·çª—å£ï¼Œè¯¥æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ´»åŠ¨å®ä¾‹ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºå¾…ç”³è¯·çš„æƒé™åç§°æ•°ç»„ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºæœ¬æ¬¡æ“ä½œçš„è¯·æ±‚ä»£ç ã€‚</p><p><strong>3 ï¼åˆ¤æ–­ç”¨æˆ·çš„æƒé™é€‰æ‹©ç»“æœ</strong></p><p>ç„¶è€Œä¸Šé¢ç¬¬äºŒæ­¥çš„requestPermissionsæ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£æ€ä¹ˆåˆ¤æ–­ç”¨æˆ·åˆ°åº•é€‰äº†å¼€å¯æƒé™è¿˜æ˜¯æ‹’ç»æƒé™å‘¢ï¼Ÿå…¶å®æ´»åŠ¨é¡µé¢æä¾›äº†æƒé™é€‰æ‹©çš„å›è°ƒæ–¹æ³•onRequestPermissionsResultï¼Œå¦‚æœå½“å‰é¡µé¢è¯·æ±‚å¼¹å‡ºæƒé™ç”³è¯·çª—å£ï¼Œé‚£ä¹ˆè¯¥é¡µé¢çš„Javaä»£ç å¿…é¡»<strong>é‡å†™onRequestPermissionsResultæ–¹æ³•</strong>ï¼Œå¹¶åœ¨è¯¥æ–¹æ³•å†…éƒ¨å¤„ç†ç”¨æˆ·çš„æƒé™é€‰æ‹©ç»“æœã€‚å…·ä½“åˆ°ç¼–ç å®ç°ä¸Šï¼Œå‰ä¸¤æ­¥çš„æƒé™æ ¡éªŒå’Œè¯·æ±‚å¼¹çª—å¯ä»¥åˆå¹¶åˆ°ä¸€å—ï¼Œå…ˆè°ƒç”¨checkSelfPermissionæ–¹æ³•æ£€æŸ¥æŸä¸ªæƒé™æ˜¯å¦å·²ç»å¼€å¯ï¼Œå¦‚æœæ²¡æœ‰å¼€å¯å†è°ƒç”¨requestPermissionsæ–¹æ³•è¯·æ±‚ç³»ç»Ÿå¼¹çª—ã€‚åˆå¹¶ä¹‹åçš„æ£€æŸ¥æ–¹æ³•ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼Œæ­¤å¤„ä»£ç æ”¯æŒä¸€æ¬¡æ£€æŸ¥ä¸€ä¸ªæƒé™ï¼Œä¹Ÿæ”¯æŒä¸€æ¬¡æ£€æŸ¥å¤šä¸ªæƒé™ï¼š</p><p>ï¼ˆå®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\util\PermissionUtil.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// æ£€æŸ¥å¤šä¸ªæƒé™ã€‚è¿”å›trueè¡¨ç¤ºå·²å®Œå…¨å¯ç”¨æƒé™ï¼Œè¿”å›falseè¡¨ç¤ºæœªå®Œå…¨å¯ç”¨æƒé™</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">checkPermission</span><span class="token punctuation">(</span><span class="token class-name">Activity</span> act<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> permissions<span class="token punctuation">,</span> <span class="token keyword">int</span> requestCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Android 6.0 ä¹‹åå¼€å§‹é‡‡ç”¨åŠ¨æ€æƒé™ç®¡ç†</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Build</span><span class="token punctuation">.</span><span class="token constant">VERSION</span><span class="token punctuation">.</span><span class="token constant">SDK_INT</span> <span class="token operator">&gt;=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> check <span class="token operator">=</span> <span class="token class-name">PackageManager</span><span class="token punctuation">.</span><span class="token constant">PERMISSION_GRANTED</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> permission <span class="token operator">:</span> permissions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                check <span class="token operator">=</span> <span class="token class-name">ContextCompat</span><span class="token punctuation">.</span><span class="token function">checkSelfPermission</span><span class="token punctuation">(</span>act<span class="token punctuation">,</span> permission<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>check <span class="token operator">!=</span> <span class="token class-name">PackageManager</span><span class="token punctuation">.</span><span class="token constant">PERMISSION_GRANTED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// æœªå¼€å¯è¯¥æƒé™ï¼Œåˆ™è¯·æ±‚ç³»ç»Ÿå¼¹çª—ï¼Œå¥½è®©ç”¨æˆ·é€‰æ‹©æ˜¯å¦ç«‹å³å¼€å¯æƒé™</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>check <span class="token operator">!=</span> <span class="token class-name">PackageManager</span><span class="token punctuation">.</span><span class="token constant">PERMISSION_GRANTED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">ActivityCompat</span><span class="token punctuation">.</span><span class="token function">requestPermissions</span><span class="token punctuation">(</span>act<span class="token punctuation">,</span> permissions<span class="token punctuation">,</span> requestCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„åˆ°ä¸Šé¢ä»£ç æœ‰åˆ¤æ–­å®‰å“ç‰ˆæœ¬å·ï¼Œåªæœ‰ç³»ç»Ÿç‰ˆæœ¬å¤§äºAndroid 6.0ï¼ˆç‰ˆæœ¬ä»£å·ä¸ºMï¼‰ï¼Œæ‰æ‰§è¡Œåç»­çš„æƒé™æ ¡éªŒæ“ä½œã€‚è¿™æ˜¯å› ä¸ºä»Android 6.0å¼€å§‹å¼•å…¥äº†è¿è¡Œæ—¶æƒé™æœºåˆ¶ï¼Œåœ¨Android 6.0ä¹‹å‰ï¼Œåªè¦Appåœ¨AndroidManifest.xmlä¸­æ·»åŠ äº†æƒé™é…ç½®ï¼Œåˆ™ç³»ç»Ÿä¼šè‡ªåŠ¨ç»™Appå¼€å¯ç›¸å…³æƒé™ï¼›ä½†åœ¨Android 6.0ä¹‹åï¼Œå³ä¾¿äº‹å…ˆæ·»åŠ äº†æƒé™é…ç½®ï¼Œç³»ç»Ÿä¹Ÿä¸ä¼šè‡ªåŠ¨å¼€å¯æƒé™ï¼Œè€Œè¦å¼€å‘è€…åœ¨Appè¿è¡Œæ—¶åˆ¤æ–­æƒé™çš„å¼€å…³æƒ…å†µï¼Œå†æ®æ­¤åŠ¨æ€ç”³è¯·æœªè·æˆæƒçš„æƒé™ã€‚ å›åˆ°æ´»åŠ¨é¡µé¢ä»£ç ï¼Œä¸€æ–¹é¢å¢åŠ æƒé™æ ¡éªŒå…¥å£ï¼Œæ¯”å¦‚ç‚¹å‡»æŸä¸ªæŒ‰é’®åè§¦å‘æƒé™æ£€æŸ¥æ“ä½œï¼Œå…¶ä¸­Manifest.permission.WRITE_EXTERNAL_STORAGEè¡¨ç¤ºå­˜å‚¨å¡æƒé™ï¼Œå…¥å£ä»£ç å¦‚ä¸‹ï¼š</p><p>ï¼ˆå®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\MainActivity.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code> <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token constant">PERMISSIONS_CONTACTS</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>
            <span class="token class-name">Manifest</span><span class="token punctuation">.</span>permission<span class="token punctuation">.</span><span class="token constant">READ_CONTACTS</span><span class="token punctuation">,</span>
            <span class="token class-name">Manifest</span><span class="token punctuation">.</span>permission<span class="token punctuation">.</span><span class="token constant">WRITE_CONTACTS</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">REQUEST_CODE_CONTACTS</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">{</span>
  <span class="token class-name">PermissionUtil</span><span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token constant">PERMISSIONS_CONTACTS</span><span class="token punctuation">,</span> <span class="token constant">REQUEST_CODE_CONTACTS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦ä¸€æ–¹é¢è¿˜è¦é‡å†™æ´»åŠ¨çš„onRequestPermissionsResultæ–¹æ³•ï¼Œåœ¨æ–¹æ³•å†…éƒ¨æ ¡éªŒç”¨æˆ·çš„é€‰æ‹©ç»“æœï¼Œè‹¥ç”¨æˆ·åŒæ„æˆæƒï¼Œå°±æ‰§è¡Œåç»­ä¸šåŠ¡ï¼›è‹¥ç”¨æˆ·æ‹’ç»æˆæƒï¼Œåªèƒ½æç¤ºç”¨æˆ·æ— æ³•å¼€å±•åç»­ä¸šåŠ¡äº†ã€‚é‡å†™åçš„æ–¹æ³•ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span><span class="token keyword">int</span> requestCode<span class="token punctuation">,</span> <span class="token annotation punctuation">@NonNull</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> permissions<span class="token punctuation">,</span> <span class="token annotation punctuation">@NonNull</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> grantResults<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onRequestPermissionsResult</span><span class="token punctuation">(</span>requestCode<span class="token punctuation">,</span> permissions<span class="token punctuation">,</span> grantResults<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>requestCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token constant">REQUEST_CODE_CONTACTS</span><span class="token operator">:</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">PermissionUtil</span><span class="token punctuation">.</span><span class="token function">checkGrant</span><span class="token punctuation">(</span>grantResults<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">&quot;ning&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;é€šè®¯å½•æƒé™è·å–æˆåŠŸ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token class-name">ToastUtil</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;è·å–é€šè®¯å½•è¯»å†™æƒé™å¤±è´¥ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">jumpToSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

            <span class="token keyword">case</span> <span class="token constant">REQUEST_CODE_SMS</span><span class="token operator">:</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">PermissionUtil</span><span class="token punctuation">.</span><span class="token function">checkGrant</span><span class="token punctuation">(</span>grantResults<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">&quot;ning&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;æ”¶å‘çŸ­ä¿¡æƒé™è·å–æˆåŠŸ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token class-name">ToastUtil</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;è·å–æ”¶å‘çŸ­ä¿¡æƒé™å¤±è´¥ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//                    jumpToSettings();</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç ä¸ºäº†ç®€åŒ–é€»è¾‘ï¼Œå°†ç»“æœæ ¡éªŒæ“ä½œå°è£…ä¸ºPermissionUtilçš„checkGrantæ–¹æ³•ï¼Œè¯¥æ–¹æ³•éå†æˆæƒç»“æœæ•°ç»„ï¼Œä¾æ¬¡æ£€æŸ¥æ¯ä¸ªæƒé™æ˜¯å¦éƒ½å¾—åˆ°æˆæƒäº†ã€‚è¯¦ç»†çš„æ–¹æ³•ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// æ£€æŸ¥æƒé™ç»“æœæ•°ç»„ï¼Œè¿”å›trueè¡¨ç¤ºéƒ½å·²ç»è·å¾—æˆæƒã€‚è¿”å›falseè¡¨ç¤ºè‡³å°‘æœ‰ä¸€ä¸ªæœªè·å¾—æˆæƒ</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">checkGrant</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> grantResults<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>grantResults <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// éå†æƒé™ç»“æœæ•°ç»„ä¸­çš„æ¯æ¡é€‰æ‹©ç»“æœ</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> grant <span class="token operator">:</span> grantResults<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// æœªè·å¾—æˆæƒ</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>grant <span class="token operator">!=</span> <span class="token class-name">PackageManager</span><span class="token punctuation">.</span><span class="token constant">PERMISSION_GRANTED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»£ç éƒ½æ”¹å¥½åï¼Œè¿è¡Œæµ‹è¯•Appï¼Œç”±äºä¸€å¼€å§‹Appé»˜è®¤æœªå¼€å¯å­˜å‚¨å¡æƒé™ï¼Œå› æ­¤ç‚¹å‡»æŒ‰é’®btn_file_writeè§¦å‘äº†æƒé™æ ¡éªŒæ“ä½œï¼Œå¼¹å‡ºå¦‚å›¾7-4æ‰€ç¤ºçš„å­˜å‚¨å¡æƒé™ç”³è¯·çª—å£ã€‚</p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111153930.png" alt="image-20220711115343844" style="zoom:50%;"><p>ç‚¹å‡»å¼¹çª—ä¸Šçš„â€œå§‹ç»ˆå…è®¸â€ï¼Œè¡¨ç¤ºåŒæ„èµ‹äºˆå­˜å‚¨å¡è¯»å†™æƒé™ï¼Œç„¶åç³»ç»Ÿè‡ªåŠ¨ç»™Appå¼€å¯äº†å­˜å‚¨å¡æƒé™ï¼Œå¹¶æ‰§è¡Œåç»­å¤„ç†é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯è·³åˆ°äº†FileWriteActivityé¡µé¢ï¼Œåœ¨è¯¥é¡µé¢å³å¯è®¿é—®å…¬å…±ç©ºé—´çš„æ–‡ä»¶äº†ã€‚ä½†åœ¨Android 10ç³»ç»Ÿä¸­ï¼Œå³ä½¿æˆæƒé€šè¿‡ï¼ŒAppä»ç„¶æ— æ³•è®¿é—®å…¬å…±ç©ºé—´ï¼Œè¿™æ˜¯å› ä¸ºAndroid 10é»˜è®¤å¼€å¯æ²™ç®±æ¨¡å¼ï¼Œä¸å…è®¸ç›´æ¥ä½¿ç”¨å…¬å…±ç©ºé—´çš„æ–‡ä»¶è·¯å¾„ï¼Œæ­¤æ—¶è¦ä¿®æ”¹AndroidManifest.xmlï¼Œç»™applicationèŠ‚ç‚¹æ·»åŠ å¦‚ä¸‹çš„<strong>requestLegacyExternalStorage</strong>å±æ€§ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code>android:requestLegacyExternalStorage=&quot;true&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä»Android 11å¼€å§‹ï¼Œä¸ºäº†è®©åº”ç”¨å‡çº§æ—¶ä¹Ÿèƒ½æ­£å¸¸è®¿é—®å…¬å…±ç©ºé—´ï¼Œè¿˜å¾—ä¿®æ”¹AndroidManifest.xmlï¼Œç»™applicationèŠ‚ç‚¹æ·»åŠ å¦‚ä¸‹çš„preserveLegacyExternalStorageå±æ€§ï¼Œè¡¨ç¤ºæš‚æ—¶å…³é—­æ²™ç®±æ¨¡å¼ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code>android:preserveLegacyExternalStorage=&quot;true&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>é™¤äº†å­˜å‚¨å¡çš„è¯»å†™æƒé™ï¼Œè¿˜æœ‰éƒ¨åˆ†æƒé™ä¹Ÿè¦æ±‚è¿è¡Œæ—¶åŠ¨æ€ç”³è¯·ï¼Œè¿™äº›æƒé™åç§°çš„å–å€¼è¯´æ˜è§è¡¨7-1ã€‚</p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111156822.png" alt="image-20220711115640739" style="zoom:75%;"><hr><h3 id="_7-2-2-åˆ©ç”¨contentresolverè¯»å†™è”ç³»äºº" tabindex="-1"><a class="header-anchor" href="#_7-2-2-åˆ©ç”¨contentresolverè¯»å†™è”ç³»äºº" aria-hidden="true">#</a> 7.2.2ã€€åˆ©ç”¨ContentResolverè¯»å†™è”ç³»äºº</h3><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæ™®é€šAppå¾ˆå°‘ä¼šå¼€æ”¾æ•°æ®æ¥å£ç»™å…¶ä»–åº”ç”¨è®¿é—®ï¼Œä½œä¸ºæœåŠ¡ç«¯æ¥å£çš„ContentProvideråŸºæœ¬ç”¨ä¸åˆ°ã€‚å†…å®¹ç»„ä»¶èƒ½å¤Ÿæ´¾ä¸Šç”¨åœºçš„æƒ…å†µï¼Œå¾€å¾€æ˜¯Appæƒ³è¦è®¿é—®ç³»ç»Ÿåº”ç”¨çš„é€šè®¯æ•°æ®ï¼Œæ¯”å¦‚æŸ¥çœ‹è”ç³»äººã€çŸ­ä¿¡ã€é€šè¯è®°å½•ï¼Œä»¥åŠå¯¹è¿™äº›é€šè®¯æ•°æ®è¿›è¡Œå¢ã€åˆ ã€æ”¹ã€æŸ¥ã€‚è®¿é—®ç³»ç»Ÿçš„é€šè®¯æ•°æ®ä¹‹å‰ï¼Œå¾—å…ˆåœ¨AndroidManifest.xmlæ·»åŠ ç›¸åº”çš„æƒé™é…ç½®ï¼Œå¸¸è§çš„é€šè®¯æƒé™é…ç½®ä¸»è¦æœ‰ä¸‹é¢å‡ ä¸ªï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- è”ç³»äºº/é€šè®¯å½•ã€‚åŒ…æ‹¬è¯»è”ç³»äººã€å†™è”ç³»äºº   --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.READ_CONTACTS<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.WRITE_CONTACTS<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token comment">&lt;!-- çŸ­ä¿¡ã€‚åŒ…æ‹¬å‘é€çŸ­ä¿¡ã€æ¥æ”¶çŸ­ä¿¡ã€è¯»çŸ­ä¿¡--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.SEND_SMS<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.RECEIVE_SMS<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.READ_SMS<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token comment">&lt;!-- é€šè¯è®°å½•ã€‚åŒ…æ‹¬è¯»é€šè¯è®°å½•ã€å†™é€šè¯è®°å½• --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.READ_CALL_LOG<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.WRITE_CALL_LOG<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“ç„¶ï¼Œä»Android 6.0å¼€å§‹ï¼Œä¸Šè¿°çš„é€šè®¯æƒé™é»˜è®¤æ˜¯å…³é—­çš„ï¼Œå¿…é¡»åœ¨è¿è¡ŒAppçš„æ—¶å€™åŠ¨æ€ç”³è¯·ç›¸å…³æƒé™ï¼Œè¯¦ç»†çš„æƒé™ç”³è¯·è¿‡ç¨‹å‚è§ä¸Šä¸€å°èŠ‚çš„â€œ7.2.1ã€€è¿è¡Œæ—¶åŠ¨æ€ç”³è¯·æƒé™â€ã€‚å°½ç®¡ç³»ç»Ÿå…è®¸Appé€šè¿‡å†…å®¹è§£æå™¨ä¿®æ”¹è”ç³»äººåˆ—è¡¨ï¼Œä½†æ“ä½œè¿‡ç¨‹æ¯”è¾ƒçƒ¦çï¼Œå› ä¸ºä¸€ä¸ªè”ç³»äººå¯èƒ½æœ‰å¤šä¸ªç”µè¯å·ç ï¼Œè¿˜å¯èƒ½æœ‰å¤šä¸ªé‚®ç®±ï¼Œæ‰€ä»¥ç³»ç»Ÿé€šè®¯å½•å°†å…¶è®¾è®¡ä¸º 3 å¼ è¡¨ï¼Œåˆ†åˆ«æ˜¯è”ç³»äººåŸºæœ¬ä¿¡æ¯è¡¨ã€è”ç³»å·ç è¡¨ã€è”ç³»é‚®ç®±è¡¨ï¼Œäºæ˜¯æ¯æ·»åŠ ä¸€ä½è”ç³»äººï¼Œå°±è¦è°ƒç”¨è‡³å°‘ä¸‰æ¬¡insertæ–¹æ³•ã€‚ä¸‹é¢æ˜¯å¾€æ‰‹æœºé€šè®¯å½•æ·»åŠ è”ç³»äººä¿¡æ¯çš„ä»£ç ä¾‹å­ï¼š</p><p>ï¼ˆå®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\ContactAddActivity.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ContactAddActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token keyword">implements</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">EditText</span> et_contact_name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">EditText</span> et_contact_phone<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">EditText</span> et_contact_email<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_contact_add<span class="token punctuation">)</span><span class="token punctuation">;</span>
        et_contact_name <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>et_contact_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        et_contact_phone <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>et_contact_phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
        et_contact_email <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>et_contact_email<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>btn_add_contact<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>btn_read_contact<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>btn_add_contact<span class="token operator">:</span>
                <span class="token comment">// åˆ›å»ºä¸€ä¸ªè”ç³»äººå¯¹è±¡</span>
                <span class="token class-name">Contact</span> contact <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Contact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                contact<span class="token punctuation">.</span>name <span class="token operator">=</span> et_contact_name<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                contact<span class="token punctuation">.</span>phone <span class="token operator">=</span> et_contact_phone<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                contact<span class="token punctuation">.</span>email <span class="token operator">=</span> et_contact_email<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// æ–¹å¼ä¸€ï¼Œä½¿ç”¨ContentResolverå¤šæ¬¡å†™å…¥ï¼Œæ¯æ¬¡ä¸€ä¸ªå­—æ®µ</span>
                <span class="token comment">// addContacts(getContentResolver(), contact);</span>
                <span class="token comment">// æ–¹å¼äºŒï¼Œæ‰¹å¤„ç†æ–¹å¼</span>
                <span class="token comment">// æ¯ä¸€æ¬¡æ“ä½œéƒ½æ˜¯ä¸€ä¸ª ContentProviderOperationï¼Œæ„å»ºä¸€ä¸ªæ“ä½œé›†åˆï¼Œç„¶åä¸€æ¬¡æ€§æ‰§è¡Œ</span>
                <span class="token comment">// å¥½å¤„æ˜¯ï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼Œä¿è¯äº†äº‹åŠ¡çš„ä¸€è‡´æ€§</span>
                <span class="token function">addFullContacts</span><span class="token punctuation">(</span><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> contact<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>

            <span class="token keyword">case</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>btn_read_contact<span class="token operator">:</span>
                <span class="token function">readPhoneContacts</span><span class="token punctuation">(</span><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æŸ¥è¯¢é€šè®¯å½•ä¿¡æ¯</span>
    <span class="token annotation punctuation">@SuppressLint</span><span class="token punctuation">(</span><span class="token string">&quot;Range&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">readPhoneContacts</span><span class="token punctuation">(</span><span class="token class-name">ContentResolver</span> resolver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å…ˆæŸ¥è¯¢ raw_contacts è¡¨ï¼Œåœ¨æ ¹æ® raw_contacts_id å»æŸ¥è¯¢ data è¡¨</span>
        <span class="token class-name">Cursor</span> cursor <span class="token operator">=</span> resolver<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">ContactsContract<span class="token punctuation">.</span>RawContacts</span><span class="token punctuation">.</span><span class="token constant">CONTENT_URI</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">ContactsContract<span class="token punctuation">.</span>RawContacts</span><span class="token punctuation">.</span>_ID<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">moveToNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> rawContactId <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Uri</span> uri <span class="token operator">=</span> <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;content://com.android.contacts/contacts/&quot;</span> <span class="token operator">+</span> rawContactId <span class="token operator">+</span> <span class="token string">&quot;/data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Cursor</span> dataCursor <span class="token operator">=</span> resolver<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">MIMETYPE</span><span class="token punctuation">,</span> <span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA1</span><span class="token punctuation">,</span> <span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA2</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Contact</span> contact <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Contact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>dataCursor<span class="token punctuation">.</span><span class="token function">moveToNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> data1 <span class="token operator">=</span> dataCursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>dataCursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">String</span> mimeType <span class="token operator">=</span> dataCursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>dataCursor<span class="token punctuation">.</span><span class="token function">getColumnIndex</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">MIMETYPE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">switch</span> <span class="token punctuation">(</span>mimeType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">//æ˜¯å§“å</span>
                    <span class="token keyword">case</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>StructuredName</span><span class="token punctuation">.</span><span class="token constant">CONTENT_ITEM_TYPE</span><span class="token operator">:</span>
                        contact<span class="token punctuation">.</span>name <span class="token operator">=</span> data1<span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>

                    <span class="token comment">//é‚®ç®±</span>
                    <span class="token keyword">case</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>Email</span><span class="token punctuation">.</span><span class="token constant">CONTENT_ITEM_TYPE</span><span class="token operator">:</span>
                        contact<span class="token punctuation">.</span>email <span class="token operator">=</span> data1<span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>

                    <span class="token comment">//æ‰‹æœº</span>
                    <span class="token keyword">case</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>Phone</span><span class="token punctuation">.</span><span class="token constant">CONTENT_ITEM_TYPE</span><span class="token operator">:</span>
                        contact<span class="token punctuation">.</span>phone <span class="token operator">=</span> data1<span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            dataCursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// RawContacts è¡¨ä¸­å‡ºç°çš„ _idï¼Œä¸ä¸€å®šåœ¨ Data è¡¨ä¸­éƒ½ä¼šæœ‰å¯¹åº”è®°å½•</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>contact<span class="token punctuation">.</span>name <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">&quot;ning&quot;</span><span class="token punctuation">,</span> contact<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        cursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token comment">// å¾€æ‰‹æœºé€šè®¯å½•ä¸€æ¬¡æ€§æ·»åŠ ä¸€ä¸ªè”ç³»äººä¿¡æ¯ï¼ˆåŒ…æ‹¬ä¸»è®°å½•ã€å§“åã€ç”µè¯å·ç ã€ç”µå­é‚®ç®±ï¼‰</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addFullContacts</span><span class="token punctuation">(</span><span class="token class-name">ContentResolver</span> resolver<span class="token punctuation">,</span> <span class="token class-name">Contact</span> contact<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ›å»ºä¸€ä¸ªæ’å…¥è”ç³»äººä¸»è®°å½•çš„å†…å®¹æ“ä½œå™¨</span>
        <span class="token class-name">ContentProviderOperation</span> op_main <span class="token operator">=</span> <span class="token class-name">ContentProviderOperation</span>
                <span class="token punctuation">.</span><span class="token function">newInsert</span><span class="token punctuation">(</span><span class="token class-name">ContactsContract<span class="token punctuation">.</span>RawContacts</span><span class="token punctuation">.</span><span class="token constant">CONTENT_URI</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withValue</span><span class="token punctuation">(</span><span class="token class-name">ContactsContract<span class="token punctuation">.</span>RawContacts</span><span class="token punctuation">.</span><span class="token constant">ACCOUNT_NAME</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// åˆ›å»ºä¸€ä¸ªæ’å…¥è”ç³»äººå§“åè®°å½•çš„å†…å®¹æ“ä½œå™¨</span>
        <span class="token class-name">ContentProviderOperation</span> op_name <span class="token operator">=</span> <span class="token class-name">ContentProviderOperation</span>
                <span class="token punctuation">.</span><span class="token function">newInsert</span><span class="token punctuation">(</span><span class="token class-name">ContactsContract<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">CONTENT_URI</span><span class="token punctuation">)</span>
                <span class="token comment">// å°†ç¬¬0ä¸ªæ“ä½œçš„idï¼Œå³ raw_contacts çš„ id ä½œä¸º data è¡¨ä¸­çš„ raw_contact_id</span>
                <span class="token punctuation">.</span><span class="token function">withValueBackReference</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">RAW_CONTACT_ID</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withValue</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">MIMETYPE</span><span class="token punctuation">,</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>StructuredName</span><span class="token punctuation">.</span><span class="token constant">CONTENT_ITEM_TYPE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withValue</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA2</span><span class="token punctuation">,</span> contact<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// åˆ›å»ºä¸€ä¸ªæ’å…¥è”ç³»äººç”µè¯å·ç è®°å½•çš„å†…å®¹æ“ä½œå™¨</span>
        <span class="token class-name">ContentProviderOperation</span> op_phone <span class="token operator">=</span> <span class="token class-name">ContentProviderOperation</span>
                <span class="token punctuation">.</span><span class="token function">newInsert</span><span class="token punctuation">(</span><span class="token class-name">ContactsContract<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">CONTENT_URI</span><span class="token punctuation">)</span>
                <span class="token comment">// å°†ç¬¬0ä¸ªæ“ä½œçš„idï¼Œå³ raw_contacts çš„ id ä½œä¸º data è¡¨ä¸­çš„ raw_contact_id</span>
                <span class="token punctuation">.</span><span class="token function">withValueBackReference</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">RAW_CONTACT_ID</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withValue</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">MIMETYPE</span><span class="token punctuation">,</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>Phone</span><span class="token punctuation">.</span><span class="token constant">CONTENT_ITEM_TYPE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withValue</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA1</span><span class="token punctuation">,</span> contact<span class="token punctuation">.</span>phone<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withValue</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA2</span><span class="token punctuation">,</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>Phone</span><span class="token punctuation">.</span><span class="token constant">TYPE_MOBILE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// åˆ›å»ºä¸€ä¸ªæ’å…¥è”ç³»äººç”µå­é‚®ç®±è®°å½•çš„å†…å®¹æ“ä½œå™¨</span>
        <span class="token class-name">ContentProviderOperation</span> op_email <span class="token operator">=</span> <span class="token class-name">ContentProviderOperation</span>
                <span class="token punctuation">.</span><span class="token function">newInsert</span><span class="token punctuation">(</span><span class="token class-name">ContactsContract<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">CONTENT_URI</span><span class="token punctuation">)</span>
                <span class="token comment">// å°†ç¬¬0ä¸ªæ“ä½œçš„idï¼Œå³ raw_contacts çš„ id ä½œä¸º data è¡¨ä¸­çš„ raw_contact_id</span>
                <span class="token punctuation">.</span><span class="token function">withValueBackReference</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">RAW_CONTACT_ID</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withValue</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">MIMETYPE</span><span class="token punctuation">,</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>Email</span><span class="token punctuation">.</span><span class="token constant">CONTENT_ITEM_TYPE</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withValue</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA1</span><span class="token punctuation">,</span> contact<span class="token punctuation">.</span>email<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withValue</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA2</span><span class="token punctuation">,</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>Email</span><span class="token punctuation">.</span><span class="token constant">TYPE_WORK</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å£°æ˜ä¸€ä¸ªå†…å®¹æ“ä½œå™¨çš„åˆ—è¡¨ï¼Œå¹¶å°†ä¸Šé¢å››ä¸ªæ“ä½œå™¨æ·»åŠ åˆ°è¯¥åˆ—è¡¨ä¸­</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ContentProviderOperation</span><span class="token punctuation">&gt;</span></span> operations <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        operations<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>op_main<span class="token punctuation">)</span><span class="token punctuation">;</span>
        operations<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>op_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        operations<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>op_phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
        operations<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>op_email<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ‰¹é‡æäº¤å››ä¸ªæ“ä½œ</span>
            resolver<span class="token punctuation">.</span><span class="token function">applyBatch</span><span class="token punctuation">(</span><span class="token class-name">ContactsContract</span><span class="token punctuation">.</span><span class="token constant">AUTHORITY</span><span class="token punctuation">,</span> operations<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">OperationApplicationException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">RemoteException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å¾€æ‰‹æœºé€šè®¯å½•æ·»åŠ ä¸€ä¸ªè”ç³»äººä¿¡æ¯ï¼ˆåŒ…æ‹¬å§“åã€ç”µè¯å·ç ã€ç”µå­é‚®ç®±ï¼‰</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addContacts</span><span class="token punctuation">(</span><span class="token class-name">ContentResolver</span> resolver<span class="token punctuation">,</span> <span class="token class-name">Contact</span> contact<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ContentValues</span> values <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ContentValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¾€ raw_contacts æ·»åŠ è”ç³»äººè®°å½•ï¼Œå¹¶è·å–æ·»åŠ åçš„è”ç³»äººç¼–å·</span>
        <span class="token class-name">Uri</span> uri <span class="token operator">=</span> resolver<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">ContactsContract<span class="token punctuation">.</span>RawContacts</span><span class="token punctuation">.</span><span class="token constant">CONTENT_URI</span><span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> rawContactId <span class="token operator">=</span> <span class="token class-name">ContentUris</span><span class="token punctuation">.</span><span class="token function">parseId</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">ContentValues</span> name <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ContentValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å…³è”è”ç³»äººç¼–å·</span>
        name<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">RAW_CONTACT_ID</span><span class="token punctuation">,</span> rawContactId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// â€œå§“åâ€çš„æ•°æ®ç±»å‹</span>
        name<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">MIMETYPE</span><span class="token punctuation">,</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>StructuredName</span><span class="token punctuation">.</span><span class="token constant">CONTENT_ITEM_TYPE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è”ç³»äººçš„å§“å</span>
        name<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA2</span><span class="token punctuation">,</span> contact<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¾€æä¾›å™¨æ·»åŠ è”ç³»äººçš„å§“åè®°å½•</span>
        resolver<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">ContactsContract<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">CONTENT_URI</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token class-name">ContentValues</span> phone <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ContentValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å…³è”è”ç³»äººç¼–å·</span>
        phone<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">RAW_CONTACT_ID</span><span class="token punctuation">,</span> rawContactId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// â€œç”µè¯å·ç â€çš„æ•°æ®ç±»å‹</span>
        phone<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">MIMETYPE</span><span class="token punctuation">,</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>Phone</span><span class="token punctuation">.</span><span class="token constant">CONTENT_ITEM_TYPE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è”ç³»äººçš„ç”µè¯å·ç </span>
        phone<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA1</span><span class="token punctuation">,</span> contact<span class="token punctuation">.</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è”ç³»ç±»å‹ã€‚1è¡¨ç¤ºå®¶åº­ï¼Œ2è¡¨ç¤ºå·¥ä½œ</span>
        phone<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA2</span><span class="token punctuation">,</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>Phone</span><span class="token punctuation">.</span><span class="token constant">TYPE_MOBILE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¾€æä¾›å™¨æ·»åŠ è”ç³»äººçš„å§“åè®°å½•</span>
        resolver<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">ContactsContract<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">CONTENT_URI</span><span class="token punctuation">,</span> phone<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token class-name">ContentValues</span> email <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ContentValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å…³è”è”ç³»äººç¼–å·</span>
        email<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">RAW_CONTACT_ID</span><span class="token punctuation">,</span> rawContactId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//  â€œç”µå­é‚®ç®±â€çš„æ•°æ®ç±»å‹</span>
        email<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">MIMETYPE</span><span class="token punctuation">,</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>Email</span><span class="token punctuation">.</span><span class="token constant">CONTENT_ITEM_TYPE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è”ç³»äººçš„ç”µå­é‚®ç®±</span>
        email<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA1</span><span class="token punctuation">,</span> contact<span class="token punctuation">.</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è”ç³»ç±»å‹ã€‚1è¡¨ç¤ºå®¶åº­ï¼Œ2è¡¨ç¤ºå·¥ä½œ</span>
        email<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">Contacts<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">DATA2</span><span class="token punctuation">,</span> <span class="token class-name">CommonDataKinds<span class="token punctuation">.</span>Email</span><span class="token punctuation">.</span><span class="token constant">TYPE_WORK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¾€æä¾›å™¨æ·»åŠ è”ç³»äººçš„å§“åè®°å½•</span>
        resolver<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">ContactsContract<span class="token punctuation">.</span>Data</span><span class="token punctuation">.</span><span class="token constant">CONTENT_URI</span><span class="token punctuation">,</span> email<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒç†ï¼Œè”ç³»äººè¯»å–ä»£ç ä¹Ÿåˆ†æˆ 3 ä¸ªæ­¥éª¤ï¼Œå…ˆæŸ¥å‡ºè”ç³»äººçš„åŸºæœ¬ä¿¡æ¯ï¼Œå†ä¾æ¬¡æŸ¥è¯¢è”ç³»äººå·ç å’Œè”ç³»äººé‚®ç®±ï¼Œè¯¦ç»†ä»£ç å‚è§CommunicationUtil.javaçš„readAllContactsæ–¹æ³•ã€‚æ¥ä¸‹æ¥æ¼”ç¤ºè”ç³»äººä¿¡æ¯çš„è®¿é—®è¿‡ç¨‹ï¼Œåˆ†åˆ«åˆ›å»ºè”ç³»äººçš„æ·»åŠ é¡µé¢å’ŒæŸ¥è¯¢é¡µé¢ï¼Œå…¶ä¸­æ·»åŠ é¡µé¢çš„å®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\ContactAddActivity.javaï¼ŒæŸ¥è¯¢é¡µé¢çš„å®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\ContactReadActivity.javaã€‚é¦–å…ˆåœ¨æ·»åŠ é¡µé¢è¾“å…¥è”ç³»äººä¿¡æ¯ï¼Œç‚¹å‡»æ·»åŠ æŒ‰é’®è°ƒç”¨addContactsæ–¹æ³•å†™å…¥è”ç³»äººæ•°æ®ï¼Œæ­¤æ—¶æ·»åŠ ç•Œé¢å¦‚å›¾7-5æ‰€ç¤ºã€‚ç„¶åæ‰“å¼€è”ç³»äººæŸ¥è¯¢é¡µé¢ï¼ŒAppè‡ªåŠ¨è°ƒç”¨readAllContactsæ–¹æ³•æŸ¥å‡ºæ‰€æœ‰çš„è”ç³»äººï¼Œå¹¶æ˜¾ç¤ºè”ç³»äººåˆ—è¡¨å¦‚å›¾7-6 æ‰€ç¤ºï¼Œå¯è§åˆšæ‰æ·»åŠ çš„è”ç³»äººå·²ç»æˆåŠŸå†™å…¥ç³»ç»Ÿçš„è”ç³»äººåˆ—è¡¨ï¼Œè€Œä¸”ä¹Ÿèƒ½æ­£ç¡®è¯»å–æœ€æ–°çš„è”ç³»äººä¿¡æ¯ã€‚</p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111423055.png" alt="image-20220711142338951" style="zoom:50%;"><p>raw_contacts è¡¨ï¼š</p><p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111423402.png" alt="image-20220711142354297"></p><p>dataè¡¨ï¼š</p><p>è®°å½•äº†ç”¨æˆ·çš„é€šè®¯å½•æ‰€æœ‰æ•°æ®ï¼ŒåŒ…æ‹¬æ‰‹æœºå·ï¼Œæ˜¾ç¤ºåç§°ç­‰ï¼Œä½†æ˜¯é‡Œé¢çš„mimetype_idè¡¨ç¤ºä¸åŒçš„æ•°æ®ç±»å‹ï¼Œè¿™ä¸è¡¨mimetypesè¡¨ä¸­çš„ id ç›¸å¯¹åº”ï¼Œ raw_contact_id ä¸ä¸‹é¢çš„ raw_contacts è¡¨ä¸­çš„ id ç›¸å¯¹åº”ã€‚</p><p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111424878.png" alt="image-20220711142459785"></p><p>mimetypesè¡¨ï¼š</p><p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111425829.png" alt="image-20220711142527729"></p><h3 id="_7-2-3-åˆ©ç”¨contentobserverç›‘å¬çŸ­ä¿¡" tabindex="-1"><a class="header-anchor" href="#_7-2-3-åˆ©ç”¨contentobserverç›‘å¬çŸ­ä¿¡" aria-hidden="true">#</a> 7.2.3ã€€åˆ©ç”¨ContentObserverç›‘å¬çŸ­ä¿¡</h3><p>ContentResolverè·å–æ•°æ®é‡‡ç”¨çš„æ˜¯ä¸»åŠ¨æŸ¥è¯¢æ–¹å¼ï¼Œæœ‰æŸ¥è¯¢å°±æœ‰æ•°æ®ï¼Œæ²¡æŸ¥è¯¢å°±æ²¡æ•°æ®ã€‚ç„¶è€Œæœ‰æ—¶ä¸ä½†è¦è·å–ä»¥å¾€çš„æ•°æ®ï¼Œè¿˜è¦å®æ—¶è·å–æ–°å¢çš„æ•°æ®ï¼Œæœ€å¸¸è§çš„ä¸šåŠ¡åœºæ™¯æ˜¯çŸ­ä¿¡éªŒè¯ç ã€‚ç”µå•†Appç»å¸¸åœ¨ç”¨æˆ·æ³¨å†Œæˆ–ä»˜æ¬¾æ—¶å‘é€éªŒè¯ç çŸ­ä¿¡ï¼Œä¸ºäº†æ›¿ç”¨æˆ·çœäº‹ï¼ŒAppé€šå¸¸ä¼šç›‘æ§æ‰‹æœºåˆšæ”¶åˆ°çš„çŸ­ä¿¡éªŒè¯ç ï¼Œå¹¶è‡ªåŠ¨å¡«å†™éªŒè¯ç è¾“å…¥æ¡†ã€‚è¿™æ—¶å°±ç”¨åˆ°äº†å†…å®¹è§‚å¯Ÿå™¨ContentObserverï¼Œäº‹å…ˆç»™ç›®æ ‡å†…å®¹æ³¨å†Œä¸€ä¸ªè§‚å¯Ÿå™¨ï¼Œç›®æ ‡å†…å®¹çš„æ•°æ®ä¸€æ—¦å‘ç”Ÿå˜åŒ–ï¼Œå°±é©¬ä¸Šè§¦å‘è§‚å¯Ÿå™¨çš„ç›‘å¬äº‹ä»¶ï¼Œä»è€Œæ‰§è¡Œå¼€å‘è€…é¢„å…ˆå®šä¹‰çš„ä»£ç ã€‚å†…å®¹è§‚å¯Ÿå™¨çš„ç”¨æ³•ä¸å†…å®¹æä¾›å™¨ç±»ä¼¼ï¼Œä¹Ÿè¦ä»ContentObserveræ´¾ç”Ÿä¸€ä¸ªæ–°çš„è§‚å¯Ÿå™¨ï¼Œç„¶åé€šè¿‡ContentResolverå¯¹è±¡è°ƒç”¨ç›¸åº”çš„æ–¹æ³•æ³¨å†Œæˆ–æ³¨é”€è§‚å¯Ÿå™¨ã€‚ä¸‹é¢æ˜¯å†…å®¹è§£æå™¨ä¸å†…å®¹è§‚å¯Ÿå™¨ä¹‹é—´çš„äº¤äº’æ–¹æ³•è¯´æ˜ã€‚</p><ul><li><p>registerContentObserverï¼šå†…å®¹è§£æå™¨è¦æ³¨å†Œå†…å®¹è§‚å¯Ÿå™¨ã€‚</p></li><li><p>unregisterContentObserverï¼šå†…å®¹è§£æå™¨è¦æ³¨é”€å†…å®¹è§‚å¯Ÿå™¨ã€‚</p></li><li><p>notifyChangeï¼šé€šçŸ¥å†…å®¹è§‚å¯Ÿå™¨å‘ç”Ÿäº†æ•°æ®å˜åŒ–ï¼Œæ­¤æ—¶ä¼šè§¦å‘è§‚å¯Ÿå™¨çš„onChangeæ–¹æ³•ã€‚</p></li></ul><p>notifyChangeçš„è°ƒç”¨æ—¶æœºå‚è§â€œ7.1.1ã€€é€šè¿‡ContentProviderå°è£…æ•°æ®â€çš„insertä»£ç ã€‚</p><p>ä¸ºäº†è®©è¯»è€…æ›´å¥½ç†è§£ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªå®é™…åº”ç”¨çš„ä¾‹å­ã€‚æ‰‹æœºå·ç çš„æ¯æœˆæµé‡é™é¢ç”±ç§»åŠ¨è¿è¥å•†æŒ‡å®šï¼Œä»¥ä¸­å›½ç§»åŠ¨ä¸ºä¾‹ï¼Œåªè¦å°†æµé‡æ ¡å‡†çŸ­ä¿¡å‘ç»™è¿è¥å•†å®¢æœå·ç ï¼ˆå¦‚å‘é€ 18 åˆ° 10086 ï¼‰ï¼Œè¿è¥å•†å°±ä¼šå›å¤ç”¨æˆ·æœ¬æœˆçš„æµé‡æ•°æ®ï¼ŒåŒ…æ‹¬æœˆæµé‡é¢åº¦ã€å·²ä½¿ç”¨æµé‡ã€æœªä½¿ç”¨æµé‡ç­‰ä¿¡æ¯ã€‚æ‰‹æœºAppåªéœ€ç›‘æ§ 10086 å‘æ¥çš„çŸ­ä¿¡å†…å®¹ï¼Œå³å¯è‡ªåŠ¨è·å–å½“å‰å·ç çš„æµé‡è¯¦æƒ…ã€‚ä¸‹é¢æ˜¯åˆ©ç”¨å†…å®¹è§‚å¯Ÿå™¨å®ç°æµé‡æ ¡å‡†çš„å…³é”®ä»£ç ç‰‡æ®µï¼š</p><p>ï¼ˆå®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\MonitorSmsActivity.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MonitorSmsActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token keyword">implements</span> 
<span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">TAG</span> <span class="token operator">=</span> <span class="token string">&quot;MonitorSmsActivity&quot;</span><span class="token punctuation">;</span>
   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">TextView</span> tv_check_flow<span class="token punctuation">;</span>
   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> mCheckResult<span class="token punctuation">;</span>
   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_monitor_sms<span class="token punctuation">)</span><span class="token punctuation">;</span>
       tv_check_flow <span class="token operator">=</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>tv_check_flow<span class="token punctuation">)</span><span class="token punctuation">;</span>
       tv_check_flow<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>btn_check_flow<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">initSmsObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>btn_check_flow<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token comment">//æŸ¥è¯¢æ•°æ®æµé‡ï¼Œç§»åŠ¨å·ç çš„æŸ¥è¯¢æ–¹å¼ä¸ºå‘é€çŸ­ä¿¡å†…å®¹â€œ18â€ç»™â€œ10086â€</span>
           <span class="token comment">//ç”µä¿¡å’Œè”é€šå·ç çš„çŸ­ä¿¡æŸ¥è¯¢æ–¹å¼è¯·å’¨è¯¢å½“åœ°è¿è¥å•†å®¢æœçƒ­çº¿</span>
           <span class="token comment">//è·³åˆ°ç³»ç»Ÿçš„çŸ­ä¿¡å‘é€é¡µé¢ï¼Œç”±ç”¨æˆ·æ‰‹å·¥å‘çŸ­ä¿¡</span>
           <span class="token comment">//sendSmsManual(&quot;10086&quot;, &quot;18&quot;);</span>
           <span class="token comment">//æ— éœ€ç”¨æˆ·æ“ä½œï¼Œè‡ªåŠ¨å‘é€çŸ­ä¿¡</span>
           <span class="token function">sendSmsAuto</span><span class="token punctuation">(</span><span class="token string">&quot;10086&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;18&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>tv_check_flow<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token class-name">AlertDialog<span class="token punctuation">.</span>Builder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AlertDialog<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           builder<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;æ”¶åˆ°æµé‡æ ¡å‡†çŸ­ä¿¡&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           builder<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span>mCheckResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
           builder<span class="token punctuation">.</span><span class="token function">setPositiveButton</span><span class="token punctuation">(</span><span class="token string">&quot;ç¡®å®š&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           builder<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
   <span class="token comment">// è·³åˆ°ç³»ç»Ÿçš„çŸ­ä¿¡å‘é€é¡µé¢ï¼Œç”±ç”¨æˆ·æ‰‹å·¥ç¼–è¾‘ä¸å‘é€çŸ­ä¿¡</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendSmsManual</span><span class="token punctuation">(</span><span class="token class-name">String</span> phoneNumber<span class="token punctuation">,</span> <span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">ACTION_SENDTO</span><span class="token punctuation">,</span> <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;smsto:&quot;</span> <span class="token operator">+</span> 
phoneNumber<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;sms_body&quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span> 
       <span class="token function">startActivity</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
   <span class="token comment">// çŸ­ä¿¡å‘é€äº‹ä»¶</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token constant">SENT_SMS_ACTION</span> <span class="token operator">=</span> <span class="token string">&quot;com.example.storage.SENT_SMS_ACTION&quot;</span><span class="token punctuation">;</span> 
   <span class="token comment">// çŸ­ä¿¡æ¥æ”¶äº‹ä»¶</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token constant">DELIVERED_SMS_ACTION</span> <span class="token operator">=</span> 
<span class="token string">&quot;com.example.storage.DELIVERED_SMS_ACTION&quot;</span><span class="token punctuation">;</span>
   <span class="token comment">// æ— éœ€ç”¨æˆ·æ“ä½œï¼Œç”±Appè‡ªåŠ¨å‘é€çŸ­ä¿¡</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendSmsAuto</span><span class="token punctuation">(</span><span class="token class-name">String</span> phoneNumber<span class="token punctuation">,</span> <span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">// ä»¥ä¸‹æŒ‡å®šçŸ­ä¿¡å‘é€äº‹ä»¶çš„è¯¦ç»†ä¿¡æ¯</span>
       <span class="token class-name">Intent</span> sentIntent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token constant">SENT_SMS_ACTION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       sentIntent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;phone&quot;</span><span class="token punctuation">,</span> phoneNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
       sentIntent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token class-name">PendingIntent</span> sentPI <span class="token operator">=</span> <span class="token class-name">PendingIntent</span><span class="token punctuation">.</span><span class="token function">getBroadcast</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
               sentIntent<span class="token punctuation">,</span> <span class="token class-name">PendingIntent</span><span class="token punctuation">.</span><span class="token constant">FLAG_UPDATE_CURRENT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// ä»¥ä¸‹æŒ‡å®šçŸ­ä¿¡æ¥æ”¶äº‹ä»¶çš„è¯¦ç»†ä¿¡æ¯</span>
       <span class="token class-name">Intent</span> deliverIntent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token constant">DELIVERED_SMS_ACTION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       deliverIntent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;phone&quot;</span><span class="token punctuation">,</span> phoneNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
       deliverIntent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token class-name">PendingIntent</span> deliverPI <span class="token operator">=</span> <span class="token class-name">PendingIntent</span><span class="token punctuation">.</span><span class="token function">getBroadcast</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
               deliverIntent<span class="token punctuation">,</span> <span class="token class-name">PendingIntent</span><span class="token punctuation">.</span><span class="token constant">FLAG_UPDATE_CURRENT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// è·å–é»˜è®¤çš„çŸ­ä¿¡ç®¡ç†å™¨</span>
       <span class="token class-name">SmsManager</span> smsManager <span class="token operator">=</span> <span class="token class-name">SmsManager</span><span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// å¼€å§‹å‘é€çŸ­ä¿¡å†…å®¹ã€‚è¦ç¡®ä¿æ‰“å¼€å‘é€çŸ­ä¿¡çš„å®Œå…¨æƒé™ï¼Œä¸æ˜¯é‚£ç§è¿˜éœ€ç¤ºçš„ä¸å®Œæ•´æƒé™</span>
       smsManager<span class="token punctuation">.</span><span class="token function">sendTextMessage</span><span class="token punctuation">(</span>phoneNumber<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> message<span class="token punctuation">,</span> sentPI<span class="token punctuation">,</span> 
deliverPI<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
   <span class="token keyword">private</span> <span class="token class-name">Handler</span> mHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Handler</span><span class="token punctuation">(</span><span class="token class-name">Looper</span><span class="token punctuation">.</span><span class="token function">myLooper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å£°æ˜ä¸€ä¸ªå¤„ç†å™¨å¯¹è±¡ </span>
   <span class="token keyword">private</span> <span class="token class-name">SmsGetObserver</span> mObserver<span class="token punctuation">;</span> <span class="token comment">// å£°æ˜ä¸€ä¸ªçŸ­ä¿¡è·å–çš„è§‚å¯Ÿå™¨å¯¹è±¡</span>
     <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Uri</span> mSmsUri<span class="token punctuation">;</span> <span class="token comment">// å£°æ˜ä¸€ä¸ªç³»ç»ŸçŸ­ä¿¡ä¾›å™¨çš„Uriå¯¹è±¡</span>
   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> mSmsColumn<span class="token punctuation">;</span> <span class="token comment">// å£°æ˜ä¸€ä¸ªçŸ­ä¿¡è®°å½•çš„å­—æ®µæ•°ç»„</span>
   <span class="token comment">// åˆå§‹åŒ–çŸ­ä¿¡è§‚å¯Ÿå™¨</span>
   <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">initSmsObserver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">//mSmsUri = Uri.parse(&quot;content://sms/inbox&quot;);</span>
       <span class="token comment">//Android5.0ä¹‹åä¼¼ä¹æ— æ³•å•ç‹¬è§‚å¯ŸæŸä¸ªä¿¡ç®±ï¼Œåªèƒ½ç›‘æ§æ•´ä¸ªçŸ­ä¿¡</span>
       mSmsUri <span class="token operator">=</span> <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;content://sms&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// çŸ­ä¿¡æ•°æ®çš„ä¾›å™¨è·¯å¾„</span>
       mSmsColumn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;body&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;date&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// çŸ­ä¿¡è®°å½•çš„å­—æ®µæ•°ç»„</span>
       <span class="token comment">// åˆ›å»ºä¸€ä¸ªçŸ­ä¿¡è§‚å¯Ÿå™¨å¯¹è±¡</span>
       mObserver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SmsGetObserver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> mHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// ç»™æŒ‡å®šUriæ³¨å†Œå†…å®¹è§‚å¯Ÿå™¨ï¼Œä¸€æ—¦å‘ç”Ÿæ•°æ®å˜åŒ–ï¼Œå°±è§¦å‘è§‚å¯Ÿå™¨çš„onChangeæ–¹æ³•</span>
       <span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">registerContentObserver</span><span class="token punctuation">(</span>mSmsUri<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> mObserver<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
   <span class="token comment">// åœ¨é¡µé¢é”€æ¯æ—¶è§¦å‘</span>
   <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unregisterContentObserver</span><span class="token punctuation">(</span>mObserver<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ³¨é”€å†…å®¹è§‚å¯Ÿå™¨</span>
 <span class="token punctuation">}</span>
   <span class="token comment">// å®šä¹‰ä¸€ä¸ªçŸ­ä¿¡è·å–çš„è§‚å¯Ÿå™¨</span>
   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SmsGetObserver</span> <span class="token keyword">extends</span> <span class="token class-name">ContentObserver</span> <span class="token punctuation">{</span>
       <span class="token keyword">private</span> <span class="token class-name">Context</span> mContext<span class="token punctuation">;</span> <span class="token comment">// å£°æ˜ä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡</span>
       <span class="token keyword">public</span> <span class="token class-name">SmsGetObserver</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">Handler</span> handler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">super</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
           mContext <span class="token operator">=</span> context<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
       <span class="token comment">// è§‚å¯Ÿåˆ°çŸ­ä¿¡çš„å†…å®¹ä¾›å™¨å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘</span>
       <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onChange</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> selfChange<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token class-name">String</span> sender <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> content <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
           <span class="token comment">// æ„å»ºä¸€ä¸ªæŸ¥è¯¢çŸ­ä¿¡çš„æ¡ä»¶è¯­å¥ï¼Œç§»åŠ¨å·ç è¦æŸ¥æ‰¾10086å‘æ¥çš„çŸ­ä¿¡</span>
           <span class="token class-name">String</span> selection <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;address=&#39;10086&#39; and date&gt;%d&quot;</span><span class="token punctuation">,</span>
                   <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æŸ¥æ‰¾æœ€è¿‘ä¸€åˆ†é’Ÿçš„çŸ­ä¿¡</span>
           <span class="token comment">// é€šè¿‡å†…å®¹è§£æå™¨è·å–ç¬¦åˆæ¡ä»¶çš„ç»“æœé›†æ¸¸æ ‡</span>
           <span class="token class-name">Cursor</span> cursor <span class="token operator">=</span> mContext<span class="token punctuation">.</span><span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>
                   mSmsUri<span class="token punctuation">,</span> mSmsColumn<span class="token punctuation">,</span> selection<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot; date desc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token comment">// å¾ªç¯å–å‡ºæ¸¸æ ‡æ‰€æŒ‡å‘çš„æ‰€æœ‰çŸ­ä¿¡è®°å½•</span>
           <span class="token keyword">while</span> <span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">moveToNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               sender <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// çŸ­ä¿¡çš„å‘é€å·ç </span>
               content <span class="token operator">=</span> cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// çŸ­ä¿¡å†…å®¹</span>
               <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">&quot;sender=&quot;</span><span class="token operator">+</span>sender<span class="token operator">+</span><span class="token string">&quot;, content=&quot;</span><span class="token operator">+</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
           cursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å…³é—­æ•°æ®åº“æ¸¸æ ‡</span>
           mCheckResult <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;å‘é€å·ç ï¼š%s\nçŸ­ä¿¡å†…å®¹ï¼š%s&quot;</span><span class="token punctuation">,</span> sender<span class="token punctuation">,</span> 
content<span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token comment">// ä¾æ¬¡è§£ææµé‡æ ¡å‡†çŸ­ä¿¡é‡Œé¢çš„å„é¡¹æµé‡æ•°å€¼ï¼Œå¹¶æ‹¼æ¥æµé‡æ ¡å‡†çš„ç»“æœå­—ç¬¦ä¸²</span>
           <span class="token class-name">String</span> flow <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;æµé‡æ ¡å‡†ç»“æœå¦‚ä¸‹ï¼šæ€»æµé‡ä¸ºï¼š%sï¼›å·²ä½¿ç”¨ï¼š%s&quot;</span> <span class="token operator">+</span>
                           <span class="token string">&quot;ï¼›å‰©ä½™æµé‡ï¼š%s&quot;</span><span class="token punctuation">,</span> <span class="token function">findFlow</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token string">&quot;æ€»æµé‡ä¸º&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                   <span class="token function">findFlow</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token string">&quot;å·²ä½¿ç”¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">findFlow</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token string">&quot;å‰©ä½™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">if</span> <span class="token punctuation">(</span>tv_check_flow <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// ç¦»å¼€è¯¥é¡µé¢åå°±ä¸å†æ˜¾ç¤ºæµé‡ä¿¡æ¯</span>
               tv_check_flow<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>flow<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åœ¨æ–‡æœ¬è§†å›¾æ˜¾ç¤ºæµé‡æ ¡å‡†ç»“æœ</span>
      <span class="token punctuation">}</span>
           <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span>selfChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
   <span class="token comment">// è§£ææµé‡çŸ­ä¿¡é‡Œé¢çš„æµé‡æ•°å€¼</span>
   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">findFlow</span><span class="token punctuation">(</span><span class="token class-name">String</span> sms<span class="token punctuation">,</span> <span class="token class-name">String</span> begin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token class-name">String</span> flow <span class="token operator">=</span> <span class="token function">findString</span><span class="token punctuation">(</span>sms<span class="token punctuation">,</span> begin<span class="token punctuation">,</span> <span class="token string">&quot;GB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token class-name">String</span> temp <span class="token operator">=</span> flow<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;GB&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>temp<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token string">&quot;\\d+&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           flow <span class="token operator">=</span> <span class="token function">findString</span><span class="token punctuation">(</span>sms<span class="token punctuation">,</span> begin<span class="token punctuation">,</span> <span class="token string">&quot;MB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
       <span class="token keyword">return</span> flow<span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
   <span class="token comment">// æˆªå–æŒ‡å®šå¤´å°¾ä¹‹é—´çš„å­—ç¬¦ä¸²</span>
   <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">findString</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">,</span> <span class="token class-name">String</span> begin<span class="token punctuation">,</span> <span class="token class-name">String</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">int</span> begin_pos <span class="token operator">=</span> content<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>begin<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>begin_pos <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">return</span> <span class="token string">&quot;æœªè·å–&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
       <span class="token class-name">String</span> sub_sms <span class="token operator">=</span> content<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>begin_pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">int</span> end_pos <span class="token operator">=</span> sub_sms<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>end_pos <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">return</span> <span class="token string">&quot;æœªè·å–&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
       <span class="token keyword">if</span> <span class="token punctuation">(</span>end<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;ï¼Œ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">return</span> sub_sms<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>begin<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end_pos<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
           <span class="token keyword">return</span> sub_sms<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>begin<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end_pos <span class="token operator">+</span> end<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œæµ‹è¯•Appï¼Œç‚¹å‡»æ ¡å‡†æŒ‰é’®å‘é€æµé‡æ ¡å‡†çŸ­ä¿¡ï¼Œæ¥ç€æ”¶åˆ°å¦‚å›¾7-7æ‰€ç¤ºçš„çŸ­ä¿¡å†…å®¹ã€‚åŒæ—¶Appç›‘å¬åˆšæ”¶åˆ°çš„æµé‡çŸ­ä¿¡ï¼Œä»ä¸­è§£æå¾—åˆ°å½“å‰çš„æµé‡æ•°å€¼ï¼Œå¹¶å±•ç¤ºåœ¨ç•Œé¢ä¸Šå¦‚å›¾7-8æ‰€ç¤ºã€‚å¯è§é€šè¿‡å†…å®¹è§‚å¯Ÿå™¨å®æ—¶è·å–äº†æœ€æ–°çš„çŸ­ä¿¡è®°å½•ã€‚</p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111439306.png" alt="image-20220711143955188" style="zoom:50%;"><p>å›¾7-7ã€€ç”¨æˆ·æ”¶åˆ°çš„çŸ­ä¿¡å†…å®¹</p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111440715.png" alt="image-20220711144013609" style="zoom:50%;"><p>å›¾7-8ã€€å†…å®¹è§‚å¯Ÿå™¨ç›‘å¬çŸ­ä¿¡å¹¶è§£æå‡ºæµé‡ä¿¡æ¯</p><p>è¡¨7-2ã€€å¸¸ç”¨çš„ç³»ç»ŸURIå–å€¼è¯´æ˜</p><p>æ€»ç»“ä¸€ä¸‹ç³»ç»Ÿå¼€æ”¾ç»™æ™®é€šåº”ç”¨è®¿é—®çš„å¸¸ç”¨URIï¼Œè¯¦ç»†çš„URIå–å€¼è¯´æ˜è§è¡¨7-2ã€‚</p><p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111440524.png" alt="image-20220711144036380"></p><h2 id="_7-3-åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#_7-3-åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ–‡ä»¶" aria-hidden="true">#</a> 7.3ã€€åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ–‡ä»¶</h2><p>æœ¬èŠ‚ä»‹ç»äº†Androidåœ¨åº”ç”¨é—´å…±äº«æ–‡ä»¶çš„å‡ ç§æ–¹å¼ï¼ŒåŒ…æ‹¬ï¼šå¦‚ä½•ä½¿ç”¨ç³»ç»Ÿç›¸å†Œå‘é€å¸¦å›¾ç‰‡çš„å½©ä¿¡ï¼Œå¦‚ä½•ä»ç›¸å†Œåª’ä½“åº“è·å–å›¾ç‰‡å¹¶å€ŸåŠ©FileProviderå‘é€å½©ä¿¡ï¼Œå¦‚ä½•åœ¨åª’ä½“åº“ä¸­æŸ¥æ‰¾APKæ–‡ä»¶å¹¶å€ŸåŠ©FileProviderå®‰è£…åº”ç”¨ã€‚</p><h3 id="_7-3-1-ä½¿ç”¨ç›¸å†Œå›¾ç‰‡å‘é€å½©ä¿¡" tabindex="-1"><a class="header-anchor" href="#_7-3-1-ä½¿ç”¨ç›¸å†Œå›¾ç‰‡å‘é€å½©ä¿¡" aria-hidden="true">#</a> 7.3.1ã€€ä½¿ç”¨ç›¸å†Œå›¾ç‰‡å‘é€å½©ä¿¡</h3><p>ä¸åŒåº”ç”¨ä¹‹é—´å¯ä»¥å…±äº«æ•°æ®ï¼Œå½“ç„¶ä¹Ÿèƒ½å…±äº«æ–‡ä»¶ï¼Œæ¯”å¦‚ç³»ç»Ÿç›¸å†Œä¿å­˜ç€ç”¨æˆ·æ‹æ‘„çš„ç…§ç‰‡ï¼Œè¿™äº›ç…§ç‰‡ç†åº”åˆ†äº«ç»™å…¶ä»–Appä½¿ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒçŸ­ä¿¡åªèƒ½å‘é€æ–‡æœ¬ï¼Œè€Œå½©ä¿¡å…è®¸åŒæ—¶å‘é€æ–‡æœ¬å’Œå›¾ç‰‡ï¼Œå½©ä¿¡çš„é™„ä»¶å›¾ç‰‡å°±æ¥è‡ªç³»ç»Ÿç›¸å†Œã€‚ç°åœ¨å‡†å¤‡åˆ°ç³»ç»Ÿç›¸å†ŒæŒ‘é€‰ç…§ç‰‡ï¼Œæµ‹è¯•é¡µé¢çš„Javaä»£ç å…ˆå¢åŠ ä»¥ä¸‹ä¸¤è¡Œä»£ç ï¼Œåˆ†åˆ«å£°æ˜ä¸€ä¸ªè·¯å¾„å¯¹è±¡å’Œé€‰æ‹©ç…§ç‰‡çš„è¯·æ±‚ç ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">Uri</span> mUri<span class="token punctuation">;</span> <span class="token comment">// æ–‡ä»¶çš„è·¯å¾„å¯¹è±¡</span>
<span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token constant">CHOOSE_CODE</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// é€‰æ‹©ç…§ç‰‡çš„è¯·æ±‚ç </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ç€åœ¨é€‰å–æŒ‰é’®çš„ç‚¹å‡»æ–¹æ³•ä¸­åŠ å…¥ä¸‹é¢ä»£ç ï¼Œè¡¨ç¤ºæ‰“å¼€ç³»ç»Ÿç›¸å†Œé€‰æ‹©ç…§ç‰‡ï¼š</p><p>ï¼ˆå®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\SendMmsActivity.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>								<span class="token comment">// è·³è½¬åˆ°ç³»ç»Ÿç›¸å†Œï¼Œé€‰æ‹©å›¾ç‰‡ï¼Œå¹¶è¿”å›</span>
                <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">ACTION_GET_CONTENT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// è®¾ç½®å†…å®¹ç±»å‹ä¸ºå›¾ç‰‡ç±»å‹</span>
                intent<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;image/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// æ‰“å¼€ç³»ç»Ÿç›¸å†Œï¼Œå¹¶ç­‰å¾…å›¾ç‰‡é€‰æ‹©ç»“æœ</span>
                mResultLauncher<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„è·³è½¬ä»£ç æœŸæœ›æ¥æ”¶ç…§ç‰‡é€‰æ‹©ç»“æœï¼Œäºæ˜¯é‡å†™å½“å‰æ´»åŠ¨çš„onActivityResultæ–¹æ³•ï¼Œè°ƒç”¨è¿”å›æ„å›¾çš„getDataæ–¹æ³•è·å¾—é€‰ä¸­ç…§ç‰‡çš„è·¯å¾„å¯¹è±¡ï¼Œé‡å†™åçš„æ–¹æ³•ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// è·³è½¬åˆ°ç³»ç»Ÿç›¸å†Œï¼Œé€‰æ‹©å›¾ç‰‡ï¼Œå¹¶è¿”å›</span>
       <span class="token class-name">ActivityResultLauncher</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Intent</span><span class="token punctuation">&gt;</span></span> mResultLauncher <span class="token operator">=</span> <span class="token function">registerForActivityResult</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ActivityResultContracts<span class="token punctuation">.</span>StartActivityForResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ActivityResultCallback</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ActivityResult</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onActivityResult</span><span class="token punctuation">(</span><span class="token class-name">ActivityResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getResultCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">RESULT_OK</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Intent</span> intent <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// è·å¾—é€‰ä¸­å›¾ç‰‡çš„è·¯å¾„å¯¹è±¡</span>
                    <span class="token comment">// content://com.android.providers.downloads.documents/document/raw%3A%2Fstorage%2Femulated%2F0%2FDownload%2Fting2.jpg</span>
                    picUri <span class="token operator">=</span> intent<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>picUri <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token comment">// ImageView æ˜¾ç¤ºåˆšåˆšé€‰ä¸­çš„å›¾ç‰‡</span>
                        iv_appendix<span class="token punctuation">.</span><span class="token function">setImageURI</span><span class="token punctuation">(</span>picUri<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token string">&quot;ning&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;picUri:&quot;</span> <span class="token operator">+</span> picUri<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸‹æ‹¿åˆ°äº†ç›¸å†Œç…§ç‰‡çš„è·¯å¾„å¯¹è±¡ï¼Œæ—¢èƒ½æŠŠå®ƒæ˜¾ç¤ºåˆ°å›¾åƒè§†å›¾ï¼Œä¹Ÿèƒ½å°†å®ƒä½œä¸ºå›¾ç‰‡é™„ä»¶å‘é€å½©ä¿¡äº†ã€‚ç”±äºæ™®é€šåº”ç”¨æ— æ³•è‡ªè¡Œå‘é€å½©ä¿¡ï¼Œå¿…é¡»æ‰“å¼€ç³»ç»Ÿçš„ä¿¡æ¯åº”ç”¨æ‰è¡Œï¼Œäºæ˜¯ç¼–å†™é¡µé¢è·³è½¬ä»£ç ï¼Œå¾€æ„å›¾å¯¹è±¡å¡å…¥è¯¦ç»†çš„å½©ä¿¡æ•°æ®ï¼ŒåŒ…æ‹¬å½©ä¿¡å‘é€çš„ç›®æ ‡å·ç ã€æ ‡é¢˜ã€å†…å®¹ï¼Œä»¥åŠUriç±»å‹çš„å›¾ç‰‡é™„ä»¶ã€‚è¯¦ç»†çš„è·³è½¬ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// å‘é€å¸¦å›¾ç‰‡çš„å½©ä¿¡</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">sendMms</span><span class="token punctuation">(</span><span class="token class-name">String</span> phone<span class="token punctuation">,</span> <span class="token class-name">String</span> title<span class="token punctuation">,</span> <span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">ACTION_SEND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        intent<span class="token punctuation">.</span><span class="token function">addFlags</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">FLAG_ACTIVITY_NEW_TASK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Intent çš„æ¥å—è€…å°†è¢«å‡†è®¸è¯»å–Intent æºå¸¦çš„URIæ•°æ®</span>
        intent<span class="token punctuation">.</span><span class="token function">addFlags</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">FLAG_GRANT_READ_URI_PERMISSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å½©ä¿¡å‘é€çš„ç›®æ ‡å·ç </span>
        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span> phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å½©ä¿¡çš„æ ‡é¢˜</span>
        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;subject&quot;</span><span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å½©ä¿¡çš„å†…å®¹</span>
        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token string">&quot;sms_body&quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å½©ä¿¡çš„å›¾ç‰‡é™„ä»¶</span>
        intent<span class="token punctuation">.</span><span class="token function">putExtra</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">EXTRA_STREAM</span><span class="token punctuation">,</span> picUri<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å½©ä¿¡çš„é™„ä»¶ä¸ºå›¾ç‰‡</span>
        intent<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;image/*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å› ä¸ºæœªæŒ‡å®šè¦æ‰“å¼€å“ªä¸ªé¡µé¢ï¼Œæ‰€ä»¥ç³»ç»Ÿä¼šåœ¨åº•éƒ¨å¼¹å‡ºé€‰æ‹©çª—å£</span>
        <span class="token function">startActivity</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ToastUtil</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;è¯·åœ¨å¼¹çª—ä¸­é€‰æ‹©çŸ­ä¿¡æˆ–è€…ä¿¡æ¯åº”ç”¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œæµ‹è¯•Appï¼Œåˆšæ‰“å¼€çš„æ´»åŠ¨é¡µé¢å¦‚å›¾7-9æ‰€ç¤ºï¼Œåœ¨å„è¡Œç¼–è¾‘æ¡†ä¸­ä¾æ¬¡å¡«å†™å½©ä¿¡çš„ç›®æ ‡å·ç ã€æ ‡é¢˜ã€å†…å®¹ï¼Œå†åˆ°ç³»ç»Ÿç›¸å†Œé€‰å–ç…§ç‰‡ï¼Œå¡«å¥½çš„ç•Œé¢æ•ˆæœå¦‚å›¾7-10æ‰€ç¤ºã€‚</p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111447351.png" alt="image-20220711144759231" style="zoom:50%;"><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111448309.png" alt="image-20220711144830189" style="zoom:50%;"><p>ä¹‹åç‚¹å‡»å‘é€æŒ‰é’®ï¼Œå±å¹•ä¸‹æ–¹å¼¹å‡ºå¦‚å›¾7-11æ‰€ç¤ºçš„åº”ç”¨é€‰æ‹©çª—å£ã€‚å…ˆç‚¹å‡»ä¿¡æ¯å›¾æ ‡ï¼Œè¡¨ç¤ºå¸Œæœ›è·³åˆ°ä¿¡æ¯åº”ç”¨ï¼Œå†ç‚¹å‡»â€œä»…æ­¤ä¸€æ¬¡â€æŒ‰é’®ï¼Œæ­¤æ—¶æ‰“å¼€ä¿¡æ¯åº”ç”¨ç•Œé¢å¦‚å›¾7-12æ‰€ç¤ºã€‚å¯è§ä¿¡æ¯å‘é€ç•Œé¢å·²ç»è‡ªåŠ¨å¡«å……æ”¶ä»¶äººå·ç ã€ä¿¡æ¯æ ‡é¢˜å’Œå†…å®¹ï¼Œä»¥åŠå›¾ç‰‡é™„ä»¶ï¼Œåªå¾…ç”¨æˆ·è½»ç‚¹å³ä¸‹è§’çš„é£é¸½ä¼ ä¹¦å›¾æ ‡ï¼Œå°±èƒ½å°†å½©ä¿¡å‘å‡ºå»äº†ã€‚</p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111449604.png" alt="image-20220711144939492" style="zoom:50%;"><p>å›¾7-12ã€€ä¿¡æ¯åº”ç”¨çš„å¾…å‘é€å½©ä¿¡</p><h3 id="_7-3-2-å€ŸåŠ©fileproviderå‘é€å½©ä¿¡" tabindex="-1"><a class="header-anchor" href="#_7-3-2-å€ŸåŠ©fileproviderå‘é€å½©ä¿¡" aria-hidden="true">#</a> 7.3.2ã€€å€ŸåŠ©FileProviderå‘é€å½©ä¿¡</h3><p>é€šè¿‡ç³»ç»Ÿç›¸å†Œå›ºç„¶å¯ä»¥è·å¾—ç…§ç‰‡çš„è·¯å¾„å¯¹è±¡ï¼Œå´æ— æ³•çŸ¥æ™“æ›´å¤šçš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚ç…§ç‰‡åç§°ã€æ–‡ä»¶å¤§å°ã€æ–‡ä»¶è·¯å¾„ç­‰ä¿¡æ¯ï¼Œä¹Ÿå°±æ— æ³•è¿›è¡Œä¸ªæ€§åŒ–çš„å®šåˆ¶å¼€å‘ã€‚ä¸ºäº†æŠŠæ›´å¤šçš„æ–‡ä»¶ä¿¡æ¯å¼€æ”¾å‡ºæ¥ï¼ŒAndroidè®¾è®¡äº†ä¸“é—¨çš„åª’ä½“å…±äº«åº“ï¼Œå…è®¸å¼€å‘è€…é€šè¿‡å†…å®¹ç»„ä»¶ä»ä¸­è·å–æ›´è¯¦ç»†çš„åª’ä½“ä¿¡æ¯ã€‚å›¾ç‰‡æ‰€åœ¨çš„ç›¸å†Œåª’ä½“åº“è·¯å¾„ä¸ºMediaStore.Images.Media.EXTERNAL_CONTENT_URIï¼Œé€šè¿‡å†…å®¹è§£æå™¨å³å¯ä»åª’ä½“åº“ä¾æ¬¡éå†å¾—åˆ°å›¾ç‰‡åˆ—è¡¨è¯¦æƒ…ã€‚ä¸ºä¾¿äºä»£ç ç®¡ç†ï¼Œé¦–å…ˆè¦å£°æ˜å¦‚ä¸‹çš„å¯¹è±¡å˜é‡ã€‚ ï¼ˆå®Œæ•´çš„ImageInfoä»£ç è§chapter07\src\main\java\com\example\chapter07\bean\ImageInfo.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImageInfo</span><span class="token punctuation">&gt;</span></span> mImageList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ImageInfo</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å›¾ç‰‡åˆ—è¡¨ </span>
<span class="token keyword">private</span> <span class="token class-name">Uri</span> mImageUri <span class="token operator">=</span> <span class="token class-name">MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>Media</span><span class="token punctuation">.</span><span class="token constant">EXTERNAL_CONTENT_URI</span><span class="token punctuation">;</span> <span class="token comment">// ç›¸å†Œçš„ </span>
<span class="token class-name">Uri</span>
<span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> mImageColumn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span> <span class="token comment">// åª’ä½“åº“çš„å­—æ®µåç§°æ•°ç»„ </span>
   <span class="token class-name">MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>Media</span><span class="token punctuation">.</span>_ID<span class="token punctuation">,</span> <span class="token comment">// ç¼–å·</span>
   <span class="token class-name">MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>Media</span><span class="token punctuation">.</span><span class="token constant">TITLE</span><span class="token punctuation">,</span> <span class="token comment">// æ ‡é¢˜ </span>
   <span class="token class-name">MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>Media</span><span class="token punctuation">.</span><span class="token constant">SIZE</span><span class="token punctuation">,</span> <span class="token comment">// æ–‡ä»¶å¤§å° </span>
   <span class="token class-name">MediaStore<span class="token punctuation">.</span>Images<span class="token punctuation">.</span>Media</span><span class="token punctuation">.</span><span class="token constant">DATA</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// æ–‡ä»¶è·¯å¾„</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åä½¿ç”¨å†…å®¹è§£æå™¨æŸ¥è¯¢åª’ä½“åº“çš„å›¾ç‰‡ä¿¡æ¯ï¼Œç®€å•èµ·è§åªæŒ‘é€‰æ–‡ä»¶å¤§å°æœ€å°çš„å‰ 6 å¼ å›¾ç‰‡ï¼Œå›¾ç‰‡åˆ—è¡¨åŠ è½½ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><p>ï¼ˆå®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\ProviderMmsActivity.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// åŠ è½½å›¾ç‰‡åˆ—è¡¨</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">loadImageList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   mImageList<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¸…ç©ºå›¾ç‰‡åˆ—è¡¨</span>
   <span class="token comment">// æŸ¥è¯¢ç›¸å†Œåª’ä½“åº“ï¼Œå¹¶è¿”å›ç»“æœé›†çš„æ¸¸æ ‡ã€‚â€œ_size ascâ€è¡¨ç¤ºæŒ‰ç…§æ–‡ä»¶å¤§å°å‡åºæ’åˆ—</span>
   <span class="token class-name">Cursor</span> cursor <span class="token operator">=</span> <span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>mImageUri<span class="token punctuation">,</span> mImageColumn<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> 
<span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;_size asc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">// ä¸‹é¢éå†ç»“æœé›†ï¼Œå¹¶é€ä¸ªæ·»åŠ åˆ°å›¾ç‰‡åˆ—è¡¨ã€‚ç®€å•èµ·è§åªæŒ‘é€‰å‰å…­å¼ å›¾ç‰‡</span>
       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">6</span> <span class="token operator">&amp;&amp;</span> cursor<span class="token punctuation">.</span><span class="token function">moveToNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token class-name">ImageInfo</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ImageInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ›å»ºä¸€ä¸ªå›¾ç‰‡ä¿¡æ¯å¯¹è±¡</span>
           image<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®å›¾ç‰‡ç¼–å·</span>
           image<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®å›¾ç‰‡åç§°</span>
           image<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®å›¾ç‰‡çš„æ–‡ä»¶å¤§å°</span>
           image<span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®å›¾ç‰‡çš„æ–‡ä»¶è·¯å¾„</span>
           <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> image<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> image<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> image<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">FileUtil</span><span class="token punctuation">.</span><span class="token function">checkFileUri</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> image<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// æ£€æŸ¥è¯¥è·¯å¾„æ˜¯å¦åˆæ³•</span>
               i<span class="token operator">--</span><span class="token punctuation">;</span>
               <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// è·¯å¾„éæ³•åˆ™å†æ¥ä¸€æ¬¡ </span>
      <span class="token punctuation">}</span>
           mImageList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ·»åŠ è‡³å›¾ç‰‡åˆ—è¡¨ </span>
    <span class="token punctuation">}</span>
       cursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å…³é—­æ•°æ®åº“æ¸¸æ ‡ </span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„åˆ°ä»¥ä¸Šä»£ç è·å¾—äº†å­—ç¬¦ä¸²æ ¼å¼çš„æ–‡ä»¶è·¯å¾„ï¼Œè€Œå½©ä¿¡å‘é€åº”ç”¨å´è¦æ±‚Uriç±»å‹çš„è·¯å¾„å¯¹è±¡ï¼ŒåŸæœ¬å¯ä»¥é€šè¿‡ä»£ç â€œUri.parse(path)â€å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºUriå¯¹è±¡ï¼Œä½†æ˜¯ä»Android 7.0å¼€å§‹ï¼Œç³»ç»Ÿä¸å…è®¸å…¶ä»–åº”ç”¨ç›´æ¥è®¿é—®è€æ ¼å¼çš„è·¯å¾„ï¼Œå¿…é¡»ä½¿ç”¨æ–‡ä»¶æä¾›å™¨FileProvideræ‰èƒ½è·å–åˆæ³•çš„Uriè·¯å¾„ï¼Œç›¸å½“äºAåº”ç”¨ç”³æ˜äº†å…±äº«æŸä¸ªæ–‡ä»¶ï¼Œç„¶åBåº”ç”¨æ–¹å¯è®¿é—®è¯¥æ–‡ä»¶ã€‚ä¸ºæ­¤éœ€è¦é‡å¤´é…ç½®FileProviderï¼Œè¯¦ç»†çš„é…ç½®æ­¥éª¤è¯´æ˜å¦‚ä¸‹ã€‚</p><p>é¦–å…ˆåœ¨resç›®å½•æ–°å»ºxmlæ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨è¯¥æ–‡ä»¶å¤¹ä¸­åˆ›å»ºfile_paths.xmlï¼Œå†å¾€XMLæ–‡ä»¶å¡«å…¥ä»¥ä¸‹å†…å®¹ï¼Œè¡¨ç¤ºå®šä¹‰å‡ ä¸ªå¤–éƒ¨æ–‡ä»¶ç›®å½•ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>paths</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>external-path</span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Android/data/com.example.chapter07/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>files_root<span class="token punctuation">&quot;</span></span> 
<span class="token punctuation">/&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>external-path</span> <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>.<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>external_storage_root<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>paths</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ç€æ‰“å¼€AndroidManifest.xmlï¼Œåœ¨applicationèŠ‚ç‚¹å†…éƒ¨æ·»åŠ ä¸‹é¢çš„provideræ ‡ç­¾ï¼Œè¡¨ç¤ºå£°æ˜å½“å‰åº”ç”¨çš„å†…å®¹æä¾›å™¨ç»„ä»¶ï¼Œæ·»åŠ åçš„æ ‡ç­¾é…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- å…¼å®¹Android7.0ï¼ŒæŠŠè®¿é—®æ–‡ä»¶çš„Uriæ–¹å¼æ”¹ä¸ºFileProvider --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>provider</span>
         <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>androidx.core.content.FileProvider<span class="token punctuation">&quot;</span></span> 
         <span class="token attr-name"><span class="token namespace">android:</span>authorities</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@string/file_provider<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">android:</span>exported</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">android:</span>grantUriPermissions</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta-data</span>
              <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.support.FILE_PROVIDER_PATHS<span class="token punctuation">&quot;</span></span> 
              <span class="token attr-name"><span class="token namespace">android:</span>resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@xml/file_paths<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>provider</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸Šé¢çš„provideræœ‰ä¸¤å¤„åœ°æ–¹å…è®¸ä¿®æ”¹ï¼Œä¸€å¤„æ˜¯authoritieså±æ€§ï¼Œå®ƒè§„å®šäº†æˆæƒå­—ç¬¦ä¸²ï¼Œè¿™æ˜¯æ¯ä¸ªæä¾›å™¨çš„å”¯ä¸€æ ‡è¯†ï¼›å¦ä¸€å¤„æ˜¯å…ƒæ•°æ®çš„resourceå±æ€§ï¼Œå®ƒæŒ‡æ˜äº†æ–‡ä»¶æä¾›å™¨çš„è·¯å¾„èµ„æºï¼Œä¹Ÿå°±æ˜¯åˆšæ‰å®šä¹‰çš„file_paths.xmlã€‚</p><p>å›åˆ°æ´»åŠ¨é¡µé¢çš„æºç ï¼Œåœ¨å‘é€å½©ä¿¡ä¹‹å‰æ·»åŠ ä¸‹è¿°ä»£ç ï¼Œç›®çš„æ˜¯æ ¹æ®å­—ç¬¦ä¸²è·¯å¾„æ„å»ºUriå¯¹è±¡ï¼Œæ³¨æ„é’ˆå¯¹Android 7.0ä»¥ä¸Šçš„å…¼å®¹å¤„ç†ã€‚</p><p>ï¼ˆå®Œæ•´ä»£ç è§ProviderMmsActivity.javaçš„sendMmsæ–¹æ³•ï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Uri</span> uri <span class="token operator">=</span> <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ ¹æ®æŒ‡å®šè·¯å¾„åˆ›å»ºä¸€ä¸ªUriå¯¹è±¡ </span>
<span class="token comment">// å…¼å®¹Android7.0ï¼ŒæŠŠè®¿é—®æ–‡ä»¶çš„Uriæ–¹å¼æ”¹ä¸ºFileProvider </span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Build</span><span class="token punctuation">.</span><span class="token constant">VERSION</span><span class="token punctuation">.</span><span class="token constant">SDK_INT</span> <span class="token operator">&gt;=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>N</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
   <span class="token comment">// é€šè¿‡FileProviderè·å¾—æ–‡ä»¶çš„Uriè®¿é—®æ–¹å¼</span>
   uri <span class="token operator">=</span> <span class="token class-name">FileProvider</span><span class="token punctuation">.</span><span class="token function">getUriForFile</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token string">&quot;com.example.chapter07.fileProvider&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span>     <span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç”±ä»¥ä¸Šä»£ç å¯è§ï¼ŒAndroid 7.0å¼€å§‹è°ƒç”¨FileProviderçš„getUriForFileæ–¹æ³•è·å¾—Uriå¯¹è±¡ï¼Œè¯¥æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºæ–‡ä»¶æä¾›å™¨çš„æˆæƒå­—ç¬¦ä¸²ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºFileç±»å‹çš„æ–‡ä»¶å¯¹è±¡ã€‚è¿è¡Œæµ‹è¯•Appï¼Œé¡µé¢ä¼šè‡ªåŠ¨åŠ è½½åª’ä½“åº“çš„å‰ 6 å¼ å›¾ç‰‡ï¼Œå¦å¤–æ‰‹å·¥è¾“å…¥å¯¹æ–¹å·ç ã€å½©ä¿¡æ ‡é¢˜ã€å½©ä¿¡å†…å®¹ç­‰ä¿¡æ¯ï¼Œå¡«å¥½çš„å‘é€ç•Œé¢å¦‚å›¾7-13æ‰€ç¤ºã€‚</p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111459173.png" alt="image-20220711145902036" style="zoom:50%;"><p>ç‚¹å‡»é¡µé¢ä¸‹æ–¹çš„æŸå¼ å›¾ç‰‡ï¼Œè¡¨ç¤ºé€‰ä¸­è¯¥å›¾ç‰‡ä½œä¸ºå½©ä¿¡é™„ä»¶ï¼Œæ­¤æ—¶ç•Œé¢ä¸‹æ–¹å¼¹å‡ºå¦‚å›¾7-14æ‰€ç¤ºçš„åº”ç”¨é€‰æ‹©çª—å£ã€‚é€‰ä¸­ä¿¡æ¯å›¾æ ‡å†ç‚¹å‡»â€œä»…æ­¤ä¸€æ¬¡â€æŒ‰é’®ï¼Œå³å¯è·³åˆ°å¦‚å›¾7-15æ‰€ç¤ºçš„ç³»ç»Ÿä¿¡æ¯å‘é€é¡µé¢äº†ã€‚</p><h3 id="_7-3-3-å€ŸåŠ©fileproviderå®‰è£…åº”ç”¨" tabindex="-1"><a class="header-anchor" href="#_7-3-3-å€ŸåŠ©fileproviderå®‰è£…åº”ç”¨" aria-hidden="true">#</a> 7.3.3ã€€å€ŸåŠ©FileProviderå®‰è£…åº”ç”¨</h3><p>é™¤äº†å‘é€å½©ä¿¡éœ€è¦æ–‡ä»¶æä¾›å™¨ï¼Œå®‰è£…åº”ç”¨ä¹Ÿéœ€è¦FileProviderã€‚ä¸å•å•å½©ä¿¡çš„é™„ä»¶å›¾ç‰‡èƒ½åˆ°åª’ä½“åº“ä¸­æŸ¥è¯¢ï¼Œåº”ç”¨çš„APKå®‰è£…åŒ…ä¹Ÿå¯åœ¨åª’ä½“åº“æ‰¾åˆ°ã€‚æŸ¥æ‰¾å®‰è£…åŒ…ä¾ç„¶å€ŸåŠ©äºå†…å®¹è§£æå™¨ï¼Œå…·ä½“çš„å®ç°è¿‡ç¨‹å’ŒæŸ¥è¯¢å›¾ç‰‡ç±»ä¼¼ï¼Œæ¯”å¦‚äº‹å…ˆå£°æ˜å¦‚ä¸‹çš„å¯¹è±¡å˜é‡ï¼š</p><p>ï¼ˆå®Œæ•´çš„ApkInfoä»£ç è§chapter07\src\main\java\com\example\chapter07\bean\ApkInfo.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ApkInfo</span><span class="token punctuation">&gt;</span></span> mApkList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ApkInfo</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å®‰è£…åŒ…åˆ—è¡¨</span>
<span class="token keyword">private</span> <span class="token class-name">Uri</span> mFilesUri <span class="token operator">=</span> <span class="token class-name">MediaStore<span class="token punctuation">.</span>Files</span><span class="token punctuation">.</span><span class="token function">getContentUri</span><span class="token punctuation">(</span><span class="token string">&quot;external&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å­˜å‚¨å¡çš„Uri</span>
<span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> mFilesColumn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span> <span class="token comment">// åª’ä½“åº“çš„å­—æ®µåç§°æ•°ç»„ </span>
   <span class="token class-name">MediaStore<span class="token punctuation">.</span>Files<span class="token punctuation">.</span>FileColumns</span><span class="token punctuation">.</span>_ID<span class="token punctuation">,</span> <span class="token comment">// ç¼–å·</span>
   <span class="token class-name">MediaStore<span class="token punctuation">.</span>Files<span class="token punctuation">.</span>FileColumns</span><span class="token punctuation">.</span><span class="token constant">TITLE</span><span class="token punctuation">,</span> <span class="token comment">// æ ‡é¢˜</span>
   <span class="token class-name">MediaStore<span class="token punctuation">.</span>Files<span class="token punctuation">.</span>FileColumns</span><span class="token punctuation">.</span><span class="token constant">SIZE</span><span class="token punctuation">,</span> <span class="token comment">// æ–‡ä»¶å¤§å°</span>
   <span class="token class-name">MediaStore<span class="token punctuation">.</span>Files<span class="token punctuation">.</span>FileColumns</span><span class="token punctuation">.</span><span class="token constant">DATA</span><span class="token punctuation">,</span> <span class="token comment">// æ–‡ä»¶è·¯å¾„</span>
   <span class="token class-name">MediaStore<span class="token punctuation">.</span>Files<span class="token punctuation">.</span>FileColumns</span><span class="token punctuation">.</span><span class="token constant">MIME_TYPE</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// åª’ä½“ç±»å‹</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†é€šè¿‡å†…å®¹è§£æå™¨åˆ°åª’ä½“åº“æŸ¥æ‰¾å®‰è£…åŒ…åˆ—è¡¨ï¼Œå…·ä½“çš„åŠ è½½ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><p>ï¼ˆå®Œæ•´ä»£ç è§chapter07\src\main\java\com\example\chapter07\ProviderApkActivity.javaï¼‰</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// åŠ è½½å®‰è£…åŒ…åˆ—è¡¨</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">loadApkList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   mApkList<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¸…ç©ºå®‰è£…åŒ…åˆ—è¡¨</span>
   <span class="token comment">// æŸ¥æ‰¾å­˜å‚¨å¡ä¸Šæ‰€æœ‰çš„apkæ–‡ä»¶ï¼Œå…¶ä¸­mime_typeæŒ‡å®šäº†APKçš„æ–‡ä»¶ç±»å‹ï¼Œæˆ–è€…åˆ¤æ–­æ–‡ä»¶è·¯å¾„æ˜¯å¦ </span>
ä»¥<span class="token punctuation">.</span>apkç»“å°¾
   <span class="token class-name">Cursor</span> cursor <span class="token operator">=</span> <span class="token function">getContentResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>mFilesUri<span class="token punctuation">,</span> mFilesColumn<span class="token punctuation">,</span>
<span class="token string">&quot;mime_type=&#39;application/vnd.android.package-archive&#39; or _data like &#39;%.apk&#39;&quot;</span><span class="token punctuation">,</span> 
<span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>cursor <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">// ä¸‹é¢éå†ç»“æœé›†ï¼Œå¹¶é€ä¸ªæ·»åŠ åˆ°å®‰è£…åŒ…åˆ—è¡¨ã€‚ç®€å•èµ·è§åªæŒ‘é€‰å‰åä¸ªæ–‡ä»¶</span>
       <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span> <span class="token operator">&amp;&amp;</span> cursor<span class="token punctuation">.</span><span class="token function">moveToNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token class-name">ApkInfo</span> apk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApkInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ›å»ºä¸€ä¸ªå®‰è£…åŒ…ä¿¡æ¯å¯¹è±¡</span>
           apk<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®å®‰è£…åŒ…ç¼–å·</span>
           apk<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®å®‰è£…åŒ…åç§°</span>
           apk<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®å®‰è£…åŒ…çš„æ–‡ä»¶å¤§å°</span>
           apk<span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®å®‰è£…åŒ…çš„æ–‡ä»¶è·¯å¾„</span>
           <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> apk<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> apk<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> 
apk<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;, &quot;</span><span class="token operator">+</span>cursor<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">FileUtil</span><span class="token punctuation">.</span><span class="token function">checkFileUri</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> apk<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// æ£€æŸ¥è¯¥è·¯å¾„æ˜¯å¦åˆæ³•</span>
               i<span class="token operator">--</span><span class="token punctuation">;</span>
               <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">// è·¯å¾„éæ³•åˆ™å†æ¥ä¸€æ¬¡</span>
      <span class="token punctuation">}</span>
           mApkList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>apk<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ·»åŠ è‡³å®‰è£…åŒ…åˆ—è¡¨</span>
    <span class="token punctuation">}</span>
       cursor<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å…³é—­æ•°æ®åº“æ¸¸æ ‡</span>
 <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰¾åˆ°å®‰è£…åŒ…ä¹‹åï¼Œé€šå¸¸è¿˜è¦è·å–å®ƒçš„åŒ…åã€ç‰ˆæœ¬åç§°ã€ç‰ˆæœ¬å·ç­‰ä¿¡æ¯ï¼Œæ­¤æ—¶å¯è°ƒç”¨åº”ç”¨åŒ…ç®¡ç†å™¨çš„getPackageArchiveInfoæ–¹æ³•ï¼Œä»å®‰è£…åŒ…æ–‡ä»¶ä¸­æå–PackageInfoåŒ…ä¿¡æ¯ã€‚åŒ…ä¿¡æ¯å¯¹è±¡çš„packageNameå±æ€§å€¼ä¸ºåº”ç”¨åŒ…åï¼ŒversionNameå±æ€§å€¼ä¸ºç‰ˆæœ¬åç§°ï¼ŒversionCodeå±æ€§å€¼ä¸ºç‰ˆæœ¬å·ã€‚ä¸‹é¢æ˜¯åˆ©ç”¨å¼¹çª—å±•ç¤ºåŒ…ä¿¡æ¯çš„ä»£ç ä¾‹å­ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// æ˜¾ç¤ºå®‰è£…apkçš„ç¤ºå¯¹è¯æ¡†</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">showAlert</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">ApkInfo</span> apkInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token class-name">PackageManager</span> pm <span class="token operator">=</span> <span class="token function">getPackageManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–åº”ç”¨åŒ…ç®¡ç†å™¨ </span>
   <span class="token comment">// è·å–apkæ–‡ä»¶çš„åŒ…ä¿¡æ¯</span>
   <span class="token class-name">PackageInfo</span> pi <span class="token operator">=</span> pm<span class="token punctuation">.</span><span class="token function">getPackageArchiveInfo</span><span class="token punctuation">(</span>apkInfo<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
<span class="token class-name">PackageManager</span><span class="token punctuation">.</span><span class="token constant">GET_ACTIVITIES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>pi <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// èƒ½æ‰¾åˆ°åŒ…ä¿¡æ¯</span>
       <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">&quot;packageName=&quot;</span><span class="token operator">+</span>pi<span class="token punctuation">.</span>packageName<span class="token operator">+</span>&quot;<span class="token punctuation">,</span> 
versionName<span class="token operator">=</span><span class="token string">&quot;+pi.versionName+&quot;</span><span class="token punctuation">,</span> versionCode<span class="token operator">=</span>&quot;<span class="token operator">+</span>pi<span class="token punctuation">.</span>versionCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token class-name">String</span> desc <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>&quot;åº”ç”¨åŒ…åï¼š<span class="token operator">%</span>s\nç‰ˆæœ¬åç§°ï¼š<span class="token operator">%</span>s\nç‰ˆæœ¬ç¼–ç ï¼š<span class="token operator">%</span>s\næ–‡ä»¶è·¯ 
å¾„ï¼š<span class="token operator">%</span>s&quot;<span class="token punctuation">,</span>
                                   pi<span class="token punctuation">.</span>packageName<span class="token punctuation">,</span> pi<span class="token punctuation">.</span>versionName<span class="token punctuation">,</span> 
pi<span class="token punctuation">.</span>versionCode<span class="token punctuation">,</span> apkInfo<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token class-name">AlertDialog<span class="token punctuation">.</span>Builder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AlertDialog<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
       builder<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;æ˜¯å¦å®‰è£…è¯¥åº”ç”¨ï¼Ÿ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®é†’å¯¹è¯æ¡†çš„æ ‡é¢˜</span>
       builder<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span>desc<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è®¾ç½®é†’å¯¹è¯æ¡†çš„æ¶ˆæ¯å†…å®¹</span>
       builder<span class="token punctuation">.</span><span class="token function">setPositiveButton</span><span class="token punctuation">(</span><span class="token string">&quot;æ˜¯&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DialogInterface<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
           <span class="token annotation punctuation">@Override</span>
           <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">DialogInterface</span> dialog<span class="token punctuation">,</span> <span class="token keyword">int</span> which<span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token function">installApk</span><span class="token punctuation">(</span>apkInfo<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å®‰è£…æŒ‡å®šè·¯å¾„çš„APK</span>
      <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       builder<span class="token punctuation">.</span><span class="token function">setNegativeButton</span><span class="token punctuation">(</span><span class="token string">&quot;å¦&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       builder<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ˜¾ç¤ºé†’å¯¹è¯æ¡†</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// æœªæ‰¾åˆ°åŒ…ä¿¡æ¯</span>
       <span class="token class-name">ToastUtil</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">&quot;è¯¥å®‰è£…åŒ…å·²ç»æŸåï¼Œè¯·é€‰æ‹©å…¶ä»–å®‰è£…åŒ…&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ‰äº†å®‰è£…åŒ…çš„æ–‡ä»¶è·¯å¾„ä¹‹åï¼Œå°±èƒ½æ‰“å¼€ç³»ç»Ÿè‡ªå¸¦çš„å®‰è£…ç¨‹åºæ‰§è¡Œå®‰è£…æ“ä½œäº†ï¼Œæ­¤æ—¶ä¸€æ ·è¦æŠŠå®‰è£…åŒ…çš„Uriå¯¹è±¡ä¼ è¿‡å»ã€‚åº”ç”¨å®‰è£…çš„è¯¦ç»†è°ƒç”¨ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// å®‰è£…æŒ‡å®šè·¯å¾„çš„APK</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">installApk</span><span class="token punctuation">(</span><span class="token class-name">String</span> path<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
   <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">&quot;path=&quot;</span><span class="token operator">+</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token class-name">Uri</span> uri <span class="token operator">=</span> <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ ¹æ®æŒ‡å®šè·¯å¾„åˆ›å»ºä¸€ä¸ªUriå¯¹è±¡ </span>
   <span class="token comment">// å…¼å®¹Android7.0ï¼ŒæŠŠè®¿é—®æ–‡ä»¶çš„Uriæ–¹å¼æ”¹ä¸ºFileProvider </span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Build</span><span class="token punctuation">.</span><span class="token constant">VERSION</span><span class="token punctuation">.</span><span class="token constant">SDK_INT</span> <span class="token operator">&gt;=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>N</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
       <span class="token comment">// é€šè¿‡FileProviderè·å¾—å®‰è£…åŒ…æ–‡ä»¶çš„Uriè®¿é—®æ–¹å¼</span>
       uri <span class="token operator">=</span> <span class="token class-name">FileProvider</span><span class="token punctuation">.</span><span class="token function">getUriForFile</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>
                                        <span class="token function">getPackageName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;.fileProvider&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> 
<span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
   <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">ACTION_VIEW</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ›å»ºä¸€ä¸ªæµè§ˆåŠ¨ä½œçš„æ„å›¾ </span>
   intent<span class="token punctuation">.</span><span class="token function">setFlags</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">FLAG_ACTIVITY_NEW_TASK</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¦å¤–å¼€å¯æ–°é¡µé¢</span>
   intent<span class="token punctuation">.</span><span class="token function">setFlags</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">FLAG_GRANT_READ_URI_PERMISSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// éœ€è¦è¯»æƒé™ </span>
   <span class="token comment">// è®¾ç½®Uriçš„æ•°æ®ç±»å‹ä¸ºAPKæ–‡ä»¶</span>
   intent<span class="token punctuation">.</span><span class="token function">setDataAndType</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> <span class="token string">&quot;application/vnd.android.package-archive&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token function">startActivity</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯åŠ¨ç³»ç»Ÿè‡ªå¸¦çš„åº”ç”¨å®‰è£…ç¨‹åº</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼Œä»Android 8.0å¼€å§‹ï¼Œå®‰è£…åº”ç”¨éœ€è¦ç”³è¯·æƒé™REQUEST_INSTALL_PACKAGESï¼Œäºæ˜¯æ‰“å¼€AndroidManifest.xmlï¼Œè¡¥å……ä¸‹é¢çš„æƒé™ç”³è¯·é…ç½®ï¼š</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- å®‰è£…åº”ç”¨è¯·æ±‚ï¼ŒAndroid8.0éœ€è¦ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.REQUEST_INSTALL_PACKAGES<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸‹å¤§åŠŸå‘Šæˆï¼Œç¼–è¯‘è¿è¡ŒAppï¼Œæ‰“å¼€æµ‹è¯•é¡µé¢è‡ªåŠ¨åŠ è½½å®‰è£…åŒ…åˆ—è¡¨çš„ç•Œé¢å¦‚å›¾7-16æ‰€ç¤ºã€‚ç‚¹å‡»æŸé¡¹å®‰è£…åŒ…ï¼Œå¼¹å‡ºå¦‚å›¾7-17æ‰€ç¤ºçš„ç¡®è®¤å¯¹è¯æ¡†ã€‚</p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111505491.png" alt="image-20220711150550356" style="zoom:50%;"><p>ç‚¹å‡»ç¡®è®¤å¯¹è¯æ¡†çš„â€œæ˜¯â€æŒ‰é’®ï¼Œä¾¿è·³åˆ°äº†å¦‚å›¾7-18æ‰€ç¤ºçš„åº”ç”¨å®‰è£…ç•Œé¢ï¼Œç‚¹å‡»â€œå…è®¸â€æŒ‰é’®ä¹‹åï¼Œå‰©ä¸‹çš„å®‰è£…æ“ä½œå°±äº¤ç»™ç³»ç»Ÿç¨‹åºäº†ã€‚</p><img src="https://gitee.com/xiaweifeng/picgo/raw/master/images/202207111506771.png" alt="image-20220711150657635" style="zoom:50%;"><h2 id="_7-4-å°ç»“" tabindex="-1"><a class="header-anchor" href="#_7-4-å°ç»“" aria-hidden="true">#</a> 7.4ã€€å°ç»“</h2><p>æœ¬ç« ä¸»è¦ä»‹ç»å†…å®¹ç»„ä»¶â€”ContentProviderçš„å¸¸è§ç”¨æ³•ï¼ŒåŒ…æ‹¬ï¼šåœ¨åº”ç”¨ä¹‹é—´å…±äº«æ•°æ®ï¼ˆé€šè¿‡ContentProviderå°è£…æ•°æ®ã€é€šè¿‡ContentResolverè®¿é—®æ•°æ®ï¼‰ã€ä½¿ç”¨å†…å®¹ç»„ä»¶è·å–é€šè®¯ä¿¡æ¯ï¼ˆè¿è¡Œæ—¶åŠ¨æ€ç”³è¯·æƒé™ã€åˆ©ç”¨ContentResolverè¯»å†™è”ç³»äººã€åˆ©ç”¨ContentObserverç›‘å¬çŸ­ä¿¡ï¼‰ã€åœ¨åº”ç”¨ä¹‹é—´å…±äº«æ–‡ä»¶ï¼ˆä½¿ç”¨ç›¸å†Œç…§ç‰‡å‘é€å½©ä¿¡ã€å€ŸåŠ©FileProviderå‘é€å½©ä¿¡ã€å€ŸåŠ©FileProviderå®‰è£…åº”ç”¨ï¼‰ã€‚</p><p>é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½æŒæ¡ä»¥ä¸‹ 4 ç§å¼€å‘æŠ€èƒ½ï¼š</p><p>ï¼ˆ 1 ï¼‰å­¦ä¼šåˆ©ç”¨ContentProvideråœ¨åº”ç”¨ä¹‹é—´å…±äº«æ•°æ®ã€‚</p><p>ï¼ˆ 2 ï¼‰å­¦ä¼šåœ¨Appè¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€ç”³è¯·æƒé™ã€‚</p><p>ï¼ˆ 3 ï¼‰å­¦ä¼šä½¿ç”¨å†…å®¹ç»„ä»¶è·å–ç³»ç»Ÿçš„é€šè®¯ä¿¡æ¯ã€‚</p><p>ï¼ˆ 4 ï¼‰å­¦ä¼šåˆ©ç”¨FileProvideråœ¨åº”ç”¨ä¹‹é—´å…±äº«æ–‡ä»¶ã€‚</p><h2 id="_7-5-è¯¾åç»ƒä¹ é¢˜" tabindex="-1"><a class="header-anchor" href="#_7-5-è¯¾åç»ƒä¹ é¢˜" aria-hidden="true">#</a> 7.5ã€€è¯¾åç»ƒä¹ é¢˜</h2><p>ä¸€ã€å¡«ç©ºé¢˜</p><p>1 ï¼åœ¨AndroidManifest.xmlé‡Œé¢å£°æ˜å†…å®¹æä¾›å™¨çš„æ ‡ç­¾åç§°æ˜¯ã€‚</p><p>2 ï¼åœ¨æ´»åŠ¨ä»£ç ä¸­è°ƒç”¨getContentResolveræ–¹æ³•ï¼Œå¾—åˆ°çš„æ˜¯ å®ä¾‹ã€‚</p><p>3 ï¼Manifest.permission.READ_CONTACTSè¡¨ç¤ºæƒé™ã€‚</p><p>4 ï¼MediaStore.Images.Media.DATAä¿å­˜äº†åª’ä½“åº“ä¸­å›¾ç‰‡æ–‡ä»¶çš„ã€‚</p><p>äºŒã€åˆ¤æ–­é¢˜ï¼ˆæ­£ç¡®æ‰“âˆšï¼Œé”™è¯¯æ‰“Ã—ï¼‰</p><p>1 ï¼ContentProviderå±äºä¸­é—´æ¥å£ï¼Œæœ¬èº«å¹¶ä¸ç›´æ¥ä¿å­˜æ•°æ®ã€‚ï¼ˆã€€ã€€ï¼‰</p><p>2 ï¼å†…å®¹è§£æå™¨ContentResolveræ˜¯å®¢æˆ·ç«¯Appæ“ä½œæœåŠ¡ç«¯æ•°æ®çš„å·¥å…·ã€‚ï¼ˆã€€ã€€ï¼‰</p><p>3 ï¼åªè¦è°ƒç”¨ContentResolverçš„ä¸€æ¬¡insertæ–¹æ³•ï¼Œå°±èƒ½å‘é€šè®¯å½•å†™å…¥ä¸€æ¡è”ç³»äººæ•°æ®ã€‚ï¼ˆã€€ã€€ï¼‰</p><p>4 ï¼å†…å®¹è§‚å¯Ÿå™¨ContentObserverèƒ½å¤Ÿå®æ—¶è·å–æ–°å¢çš„æ•°æ®ã€‚ï¼ˆã€€ã€€ï¼‰</p><p>5 ï¼çŸ­ä¿¡å’Œå½©ä¿¡éƒ½åªèƒ½å‘é€æ–‡æœ¬å†…å®¹ã€‚ï¼ˆã€€ã€€ï¼‰</p><p>ä¸‰ã€é€‰æ‹©é¢˜</p><p>1 ï¼å†…å®¹ç»„ä»¶ç”±å“ª 3 ä¸ªéƒ¨åˆ†ç»„æˆï¼Ÿï¼ˆã€€ã€€ï¼‰</p><p>Aï¼ContentProvider</p><p>Bï¼ContentObserver</p><p>Cï¼FileProvider</p><p>Dï¼ContentResolver</p><p>2 ï¼Appè¯»å–çŸ­ä¿¡éœ€è¦ç”³è¯·ï¼ˆã€€ã€€ï¼‰æƒé™ã€‚</p><p>Aï¼SEND_SMS</p><p>Bï¼RECEIVE_SMS</p><p>Cï¼READ_SMS</p><p>Dï¼READ_CONTACTS</p><p>3 ï¼content://mmsæ˜¯ï¼ˆã€€ã€€ï¼‰çš„å†…å®¹è·¯å¾„ã€‚</p><p>Aï¼å½©ä¿¡</p><p>Bï¼çŸ­ä¿¡</p><p>Cï¼é£ä¿¡</p><p>Dï¼å¾®ä¿¡</p><p>4 ï¼FileProviderçš„getUriForFileæ–¹æ³•è¿”å›çš„æ•°æ®æ˜¯ï¼ˆã€€ã€€ï¼‰ç±»å‹ã€‚</p><p>Aï¼File</p><p>Bï¼String</p><p>Cï¼Uri</p><p>Dï¼URL</p><p>5 ï¼å®‰å“Appå®‰è£…åŒ…çš„æ–‡ä»¶æ‰©å±•åæ˜¯ï¼ˆã€€ã€€ï¼‰ã€‚</p><p>Aï¼APP</p><p>Bï¼APK</p><p>Cï¼EXE</p><p>Dï¼IPA</p><p>å››ã€ç®€ç­”é¢˜</p><p>è¯·ç®€è¦æè¿°Appè¿è¡Œæ—¶ç”³è¯·åŠ¨æ€æƒé™çš„å‡ ä¸ªæ­¥éª¤ã€‚</p><p>äº”ã€åŠ¨æ‰‹ç»ƒä¹ </p><p>è¯·ä¸Šæœºå®éªŒä¸‹åˆ— 3 é¡¹ç»ƒä¹ ï¼š</p><p>1 ï¼ä½¿ç”¨å†…å®¹è§£æå™¨è¯»å†™ç³»ç»Ÿé€šè®¯å½•é‡Œçš„è”ç³»äººä¿¡æ¯ã€‚</p><p>2 ï¼ä½¿ç”¨å†…å®¹è§‚å¯Ÿå™¨ç›‘å¬è¿è¥å•†å®¢æœå·ç å›å¤çš„æµé‡çŸ­ä¿¡ï¼Œå¹¶ä»ä¸­è·å¾—ç”¨æˆ·çš„æµé‡æ•°æ®ã€‚</p><p>3 ï¼åˆ©ç”¨å†…å®¹è§£æå™¨ä»ç³»ç»Ÿåª’ä½“åº“è·å¾—å›¾ç‰‡åˆ—è¡¨ï¼Œå¹¶å€ŸåŠ©æ–‡ä»¶æä¾›å™¨å‘ç›®æ ‡å·ç å‘é€å½©ä¿¡ã€‚</p></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://gitee.com/xiaweifeng/vuepress-source/edit/master/docs/Android/AndroidBasic/ç¬¬07ç« å†…å®¹å…±äº«.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨Giteeä¸Šç¼–è¾‘æ­¤é¡µ"><!--[--><!--]--> åœ¨Giteeä¸Šç¼–è¾‘æ­¤é¡µ <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">ä¸Šæ¬¡æ›´æ–°: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">è´¡çŒ®è€…: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: xiaweifeng@live.cn">å¤ä¸€æ¬¡</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--[--><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!--]--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.3222cd28.js" defer></script>
  </body>
</html>
